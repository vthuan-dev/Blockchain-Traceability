(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PCrypto = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PCrypto=(()=>{var gf=Object.create;var zr=Object.defineProperty;var xf=Object.getOwnPropertyDescriptor;var vf=Object.getOwnPropertyNames;var mf=Object.getPrototypeOf,bf=Object.prototype.hasOwnProperty;var F=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),ut=(t,e)=>{for(var r in e)zr(t,r,{get:e[r],enumerable:!0})},Ta=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of vf(e))!bf.call(t,i)&&i!==r&&zr(t,i,{get:()=>e[i],enumerable:!(n=xf(e,i))||n.enumerable});return t};var it=(t,e,r)=>(r=t!=null?gf(mf(t)):{},Ta(e||!t||!t.__esModule?zr(r,"default",{value:t,enumerable:!0}):r,t)),wf=t=>Ta(zr({},"__esModule",{value:!0}),t);var X=F((Ap,Ra)=>{Ra.exports={options:{usePureJavaScript:!1}}});var Na=F((Cp,Da)=>{var Mn={};Da.exports=Mn;var ka={};Mn.encode=function(t,e,r){if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(t instanceof Uint8Array))n=Sf(t,e);else{var i=0,a=e.length,s=e.charAt(0),o=[0];for(i=0;i<t.length;++i){for(var f=0,c=t[i];f<o.length;++f)c+=o[f]<<8,o[f]=c%a,c=c/a|0;for(;c>0;)o.push(c%a),c=c/a|0}for(i=0;t[i]===0&&i<t.length-1;++i)n+=s;for(i=o.length-1;i>=0;--i)n+=e[o[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};Mn.decode=function(t,e){if(typeof t!="string")throw new TypeError('"input" must be a string.');if(typeof e!="string")throw new TypeError('"alphabet" must be a string.');var r=ka[e];if(!r){r=ka[e]=[];for(var n=0;n<e.length;++n)r[e.charCodeAt(n)]=n}t=t.replace(/\s/g,"");for(var i=e.length,a=e.charAt(0),s=[0],n=0;n<t.length;n++){var o=r[t.charCodeAt(n)];if(o===void 0)return;for(var f=0,c=o;f<s.length;++f)c+=s[f]*i,s[f]=c&255,c>>=8;for(;c>0;)s.push(c&255),c>>=8}for(var u=0;t[u]===a&&u<t.length-1;++u)s.push(0);return typeof Buffer<"u"?Buffer.from(s.reverse()):new Uint8Array(s.reverse())};function Sf(t,e){var r=0,n=e.length,i=e.charAt(0),a=[0];for(r=0;r<t.length();++r){for(var s=0,o=t.at(r);s<a.length;++s)o+=a[s]<<8,a[s]=o%n,o=o/n|0;for(;o>0;)a.push(o%n),o=o/n|0}var f="";for(r=0;t.at(r)===0&&r<t.length()-1;++r)f+=i;for(r=a.length-1;r>=0;--r)f+=e[a[r]];return f}});var ht=F((Tp,Ua)=>{var La=X(),Pa=Na(),y=Ua.exports=La.util=La.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){y.nextTick=process.nextTick,typeof setImmediate=="function"?y.setImmediate=setImmediate:y.setImmediate=y.nextTick;return}if(typeof setImmediate=="function"){y.setImmediate=function(){return setImmediate.apply(void 0,arguments)},y.nextTick=function(o){return setImmediate(o)};return}if(y.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(f){if(f.source===window&&f.data===t){f.stopPropagation();var c=e.slice();e.length=0,c.forEach(function(u){u()})}};var s=o,t="forge.setImmediate",e=[];y.setImmediate=function(f){e.push(f),e.length===1&&window.postMessage(t,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),e=[];new MutationObserver(function(){var f=e.slice();e.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var a=y.setImmediate;y.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),a(f)):(e.push(f),e.length===1&&i.setAttribute("a",n=!n))}}y.nextTick=y.setImmediate})();y.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;y.globalScope=function(){return y.isNodejs?globalThis:typeof self>"u"?window:self}();y.isArray=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};y.isArrayBuffer=function(t){return typeof ArrayBuffer<"u"&&t instanceof ArrayBuffer};y.isArrayBufferView=function(t){return t&&y.isArrayBuffer(t.buffer)&&t.byteLength!==void 0};function dr(t){if(!(t===8||t===16||t===24||t===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+t)}y.ByteBuffer=Vn;function Vn(t){if(this.data="",this.read=0,typeof t=="string")this.data=t;else if(y.isArrayBuffer(t)||y.isArrayBufferView(t))if(typeof Buffer<"u"&&t instanceof Buffer)this.data=t.toString("binary");else{var e=new Uint8Array(t);try{this.data=String.fromCharCode.apply(null,e)}catch{for(var r=0;r<e.length;++r)this.putByte(e[r])}}else(t instanceof Vn||typeof t=="object"&&typeof t.data=="string"&&typeof t.read=="number")&&(this.data=t.data,this.read=t.read);this._constructedStringLength=0}y.ByteStringBuffer=Vn;var Ef=4096;y.ByteStringBuffer.prototype._optimizeConstructedString=function(t){this._constructedStringLength+=t,this._constructedStringLength>Ef&&(this.data.substr(0,1),this._constructedStringLength=0)};y.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};y.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};y.ByteStringBuffer.prototype.putByte=function(t){return this.putBytes(String.fromCharCode(t))};y.ByteStringBuffer.prototype.fillWithByte=function(t,e){t=String.fromCharCode(t);for(var r=this.data;e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return this.data=r,this._optimizeConstructedString(e),this};y.ByteStringBuffer.prototype.putBytes=function(t){return this.data+=t,this._optimizeConstructedString(t.length),this};y.ByteStringBuffer.prototype.putString=function(t){return this.putBytes(y.encodeUtf8(t))};y.ByteStringBuffer.prototype.putInt16=function(t){return this.putBytes(String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt24=function(t){return this.putBytes(String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt32=function(t){return this.putBytes(String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255))};y.ByteStringBuffer.prototype.putInt16Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255))};y.ByteStringBuffer.prototype.putInt24Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255))};y.ByteStringBuffer.prototype.putInt32Le=function(t){return this.putBytes(String.fromCharCode(t&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>24&255))};y.ByteStringBuffer.prototype.putInt=function(t,e){dr(e);var r="";do e-=8,r+=String.fromCharCode(t>>e&255);while(e>0);return this.putBytes(r)};y.ByteStringBuffer.prototype.putSignedInt=function(t,e){return t<0&&(t+=2<<e-1),this.putInt(t,e)};y.ByteStringBuffer.prototype.putBuffer=function(t){return this.putBytes(t.getBytes())};y.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};y.ByteStringBuffer.prototype.getInt16=function(){var t=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24=function(){var t=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32=function(){var t=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,t};y.ByteStringBuffer.prototype.getInt16Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,t};y.ByteStringBuffer.prototype.getInt24Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,t};y.ByteStringBuffer.prototype.getInt32Le=function(){var t=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,t};y.ByteStringBuffer.prototype.getInt=function(t){dr(t);var e=0;do e=(e<<8)+this.data.charCodeAt(this.read++),t-=8;while(t>0);return e};y.ByteStringBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.ByteStringBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.ByteStringBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.ByteStringBuffer.prototype.at=function(t){return this.data.charCodeAt(this.read+t)};y.ByteStringBuffer.prototype.setAt=function(t,e){return this.data=this.data.substr(0,this.read+t)+String.fromCharCode(e)+this.data.substr(this.read+t+1),this};y.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};y.ByteStringBuffer.prototype.copy=function(){var t=y.createBuffer(this.data);return t.read=this.read,t};y.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};y.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};y.ByteStringBuffer.prototype.truncate=function(t){var e=Math.max(0,this.length()-t);return this.data=this.data.substr(this.read,e),this.read=0,this};y.ByteStringBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.length;++e){var r=this.data.charCodeAt(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.ByteStringBuffer.prototype.toString=function(){return y.decodeUtf8(this.bytes())};function Bf(t,e){e=e||{},this.read=e.readOffset||0,this.growSize=e.growSize||1024;var r=y.isArrayBuffer(t),n=y.isArrayBufferView(t);if(r||n){r?this.data=new DataView(t):this.data=new DataView(t.buffer,t.byteOffset,t.byteLength),this.write="writeOffset"in e?e.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,t!=null&&this.putBytes(t),"writeOffset"in e&&(this.write=e.writeOffset)}y.DataBuffer=Bf;y.DataBuffer.prototype.length=function(){return this.write-this.read};y.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};y.DataBuffer.prototype.accommodate=function(t,e){if(this.length()>=t)return this;e=Math.max(e||this.growSize,t);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+e);return n.set(r),this.data=new DataView(n.buffer),this};y.DataBuffer.prototype.putByte=function(t){return this.accommodate(1),this.data.setUint8(this.write++,t),this};y.DataBuffer.prototype.fillWithByte=function(t,e){this.accommodate(e);for(var r=0;r<e;++r)this.data.setUint8(t);return this};y.DataBuffer.prototype.putBytes=function(t,e){if(y.isArrayBufferView(t)){var r=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(y.isArrayBuffer(t)){var r=new Uint8Array(t);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(t instanceof y.DataBuffer||typeof t=="object"&&typeof t.read=="number"&&typeof t.write=="number"&&y.isArrayBufferView(t.data)){var r=new Uint8Array(t.data.byteLength,t.read,t.length());this.accommodate(r.byteLength);var i=new Uint8Array(t.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(t instanceof y.ByteStringBuffer&&(t=t.data,e="binary"),e=e||"binary",typeof t=="string"){var a;if(e==="hex")return this.accommodate(Math.ceil(t.length/2)),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.hex.decode(t,a,this.write),this;if(e==="base64")return this.accommodate(Math.ceil(t.length/4)*3),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.base64.decode(t,a,this.write),this;if(e==="utf8"&&(t=y.encodeUtf8(t),e="binary"),e==="binary"||e==="raw")return this.accommodate(t.length),a=new Uint8Array(this.data.buffer,this.write),this.write+=y.binary.raw.decode(a),this;if(e==="utf16")return this.accommodate(t.length*2),a=new Uint16Array(this.data.buffer,this.write),this.write+=y.text.utf16.encode(a),this;throw new Error("Invalid encoding: "+e)}throw Error("Invalid parameter: "+t)};y.DataBuffer.prototype.putBuffer=function(t){return this.putBytes(t),t.clear(),this};y.DataBuffer.prototype.putString=function(t){return this.putBytes(t,"utf16")};y.DataBuffer.prototype.putInt16=function(t){return this.accommodate(2),this.data.setInt16(this.write,t),this.write+=2,this};y.DataBuffer.prototype.putInt24=function(t){return this.accommodate(3),this.data.setInt16(this.write,t>>8&65535),this.data.setInt8(this.write,t>>16&255),this.write+=3,this};y.DataBuffer.prototype.putInt32=function(t){return this.accommodate(4),this.data.setInt32(this.write,t),this.write+=4,this};y.DataBuffer.prototype.putInt16Le=function(t){return this.accommodate(2),this.data.setInt16(this.write,t,!0),this.write+=2,this};y.DataBuffer.prototype.putInt24Le=function(t){return this.accommodate(3),this.data.setInt8(this.write,t>>16&255),this.data.setInt16(this.write,t>>8&65535,!0),this.write+=3,this};y.DataBuffer.prototype.putInt32Le=function(t){return this.accommodate(4),this.data.setInt32(this.write,t,!0),this.write+=4,this};y.DataBuffer.prototype.putInt=function(t,e){dr(e),this.accommodate(e/8);do e-=8,this.data.setInt8(this.write++,t>>e&255);while(e>0);return this};y.DataBuffer.prototype.putSignedInt=function(t,e){return dr(e),this.accommodate(e/8),t<0&&(t+=2<<e-1),this.putInt(t,e)};y.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};y.DataBuffer.prototype.getInt16=function(){var t=this.data.getInt16(this.read);return this.read+=2,t};y.DataBuffer.prototype.getInt24=function(){var t=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,t};y.DataBuffer.prototype.getInt32=function(){var t=this.data.getInt32(this.read);return this.read+=4,t};y.DataBuffer.prototype.getInt16Le=function(){var t=this.data.getInt16(this.read,!0);return this.read+=2,t};y.DataBuffer.prototype.getInt24Le=function(){var t=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,t};y.DataBuffer.prototype.getInt32Le=function(){var t=this.data.getInt32(this.read,!0);return this.read+=4,t};y.DataBuffer.prototype.getInt=function(t){dr(t);var e=0;do e=(e<<8)+this.data.getInt8(this.read++),t-=8;while(t>0);return e};y.DataBuffer.prototype.getSignedInt=function(t){var e=this.getInt(t),r=2<<t-2;return e>=r&&(e-=r<<1),e};y.DataBuffer.prototype.getBytes=function(t){var e;return t?(t=Math.min(this.length(),t),e=this.data.slice(this.read,this.read+t),this.read+=t):t===0?e="":(e=this.read===0?this.data:this.data.slice(this.read),this.clear()),e};y.DataBuffer.prototype.bytes=function(t){return typeof t>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+t)};y.DataBuffer.prototype.at=function(t){return this.data.getUint8(this.read+t)};y.DataBuffer.prototype.setAt=function(t,e){return this.data.setUint8(t,e),this};y.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};y.DataBuffer.prototype.copy=function(){return new y.DataBuffer(this)};y.DataBuffer.prototype.compact=function(){if(this.read>0){var t=new Uint8Array(this.data.buffer,this.read),e=new Uint8Array(t.byteLength);e.set(t),this.data=new DataView(e),this.write-=this.read,this.read=0}return this};y.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};y.DataBuffer.prototype.truncate=function(t){return this.write=Math.max(0,this.length()-t),this.read=Math.min(this.read,this.write),this};y.DataBuffer.prototype.toHex=function(){for(var t="",e=this.read;e<this.data.byteLength;++e){var r=this.data.getUint8(e);r<16&&(t+="0"),t+=r.toString(16)}return t};y.DataBuffer.prototype.toString=function(t){var e=new Uint8Array(this.data,this.read,this.length());if(t=t||"utf8",t==="binary"||t==="raw")return y.binary.raw.encode(e);if(t==="hex")return y.binary.hex.encode(e);if(t==="base64")return y.binary.base64.encode(e);if(t==="utf8")return y.text.utf8.decode(e);if(t==="utf16")return y.text.utf16.decode(e);throw new Error("Invalid encoding: "+t)};y.createBuffer=function(t,e){return e=e||"raw",t!==void 0&&e==="utf8"&&(t=y.encodeUtf8(t)),new y.ByteBuffer(t)};y.fillString=function(t,e){for(var r="";e>0;)e&1&&(r+=t),e>>>=1,e>0&&(t+=t);return r};y.xorBytes=function(t,e,r){for(var n="",i="",a="",s=0,o=0;r>0;--r,++s)i=t.charCodeAt(s)^e.charCodeAt(s),o>=10&&(n+=a,a="",o=0),a+=String.fromCharCode(i),++o;return n+=a,n};y.hexToBytes=function(t){var e="",r=0;for(t.length&!0&&(r=1,e+=String.fromCharCode(parseInt(t[0],16)));r<t.length;r+=2)e+=String.fromCharCode(parseInt(t.substr(r,2),16));return e};y.bytesToHex=function(t){return y.createBuffer(t).toHex()};y.int32ToBytes=function(t){return String.fromCharCode(t>>24&255)+String.fromCharCode(t>>16&255)+String.fromCharCode(t>>8&255)+String.fromCharCode(t&255)};var pe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",de=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Ka="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";y.encode64=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.length;)i=t.charCodeAt(o++),a=t.charCodeAt(o++),s=t.charCodeAt(o++),r+=pe.charAt(i>>2),r+=pe.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=pe.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":pe.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.decode64=function(t){t=t.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var e="",r,n,i,a,s=0;s<t.length;)r=de[t.charCodeAt(s++)-43],n=de[t.charCodeAt(s++)-43],i=de[t.charCodeAt(s++)-43],a=de[t.charCodeAt(s++)-43],e+=String.fromCharCode(r<<2|n>>4),i!==64&&(e+=String.fromCharCode((n&15)<<4|i>>2),a!==64&&(e+=String.fromCharCode((i&3)<<6|a)));return e};y.encodeUtf8=function(t){return unescape(encodeURIComponent(t))};y.decodeUtf8=function(t){return decodeURIComponent(escape(t))};y.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Pa.encode,decode:Pa.decode}};y.binary.raw.encode=function(t){return String.fromCharCode.apply(null,t)};y.binary.raw.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};y.binary.hex.encode=y.bytesToHex;y.binary.hex.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/2))),r=r||0;var i=0,a=r;for(t.length&1&&(i=1,n[a++]=parseInt(t[0],16));i<t.length;i+=2)n[a++]=parseInt(t.substr(i,2),16);return e?a-r:n};y.binary.base64.encode=function(t,e){for(var r="",n="",i,a,s,o=0;o<t.byteLength;)i=t[o++],a=t[o++],s=t[o++],r+=pe.charAt(i>>2),r+=pe.charAt((i&3)<<4|a>>4),isNaN(a)?r+="==":(r+=pe.charAt((a&15)<<2|s>>6),r+=isNaN(s)?"=":pe.charAt(s&63)),e&&r.length>e&&(n+=r.substr(0,e)+`\r
`,r=r.substr(e));return n+=r,n};y.binary.base64.decode=function(t,e,r){var n=e;n||(n=new Uint8Array(Math.ceil(t.length/4)*3)),t=t.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,a,s,o,f=0,c=r;f<t.length;)i=de[t.charCodeAt(f++)-43],a=de[t.charCodeAt(f++)-43],s=de[t.charCodeAt(f++)-43],o=de[t.charCodeAt(f++)-43],n[c++]=i<<2|a>>4,s!==64&&(n[c++]=(a&15)<<4|s>>2,o!==64&&(n[c++]=(s&3)<<6|o));return e?c-r:n.subarray(0,c)};y.binary.base58.encode=function(t,e){return y.binary.baseN.encode(t,Ka,e)};y.binary.base58.decode=function(t,e){return y.binary.baseN.decode(t,Ka,e)};y.text={utf8:{},utf16:{}};y.text.utf8.encode=function(t,e,r){t=y.encodeUtf8(t);var n=e;n||(n=new Uint8Array(t.length)),r=r||0;for(var i=r,a=0;a<t.length;++a)n[i++]=t.charCodeAt(a);return e?i-r:n};y.text.utf8.decode=function(t){return y.decodeUtf8(String.fromCharCode.apply(null,t))};y.text.utf16.encode=function(t,e,r){var n=e;n||(n=new Uint8Array(t.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var a=r,s=r,o=0;o<t.length;++o)i[s++]=t.charCodeAt(o),a+=2;return e?a-r:n};y.text.utf16.decode=function(t){return String.fromCharCode.apply(null,new Uint16Array(t.buffer))};y.deflate=function(t,e,r){if(e=y.decode64(t.deflate(y.encode64(e)).rval),r){var n=2,i=e.charCodeAt(1);i&32&&(n=6),e=e.substring(n,e.length-4)}return e};y.inflate=function(t,e,r){var n=t.inflate(y.encode64(e)).rval;return n===null?null:y.decode64(n)};var qn=function(t,e,r){if(!t)throw new Error("WebStorage not available.");var n;if(r===null?n=t.removeItem(e):(r=y.encode64(JSON.stringify(r)),n=t.setItem(e,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},zn=function(t,e){if(!t)throw new Error("WebStorage not available.");var r=t.getItem(e);if(t.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(y.decode64(r))),r},Af=function(t,e,r,n){var i=zn(t,e);i===null&&(i={}),i[r]=n,qn(t,e,i)},Cf=function(t,e,r){var n=zn(t,e);return n!==null&&(n=r in n?n[r]:null),n},Tf=function(t,e,r){var n=zn(t,e);if(n!==null&&r in n){delete n[r];var i=!0;for(var a in n){i=!1;break}i&&(n=null),qn(t,e,n)}},If=function(t,e){qn(t,e,null)},Hr=function(t,e,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,a=!1,s=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(e[0]===null)throw new Error("Flash local storage not available.");n=t.apply(this,e),a=i==="flash"}(i==="web"||i==="both")&&(e[0]=localStorage,n=t.apply(this,e),a=!0)}catch(f){s=f}if(a)break}if(!a)throw s;return n};y.setItem=function(t,e,r,n,i){Hr(Af,arguments,i)};y.getItem=function(t,e,r,n){return Hr(Cf,arguments,n)};y.removeItem=function(t,e,r,n){Hr(Tf,arguments,n)};y.clearItems=function(t,e,r){Hr(If,arguments,r)};y.isEmpty=function(t){for(var e in t)if(t.hasOwnProperty(e))return!1;return!0};y.format=function(t){for(var e=/%./g,r,n,i=0,a=[],s=0;r=e.exec(t);){n=t.substring(s,e.lastIndex-2),n.length>0&&a.push(n),s=e.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?a.push(arguments[i+++1]):a.push("<?>");break;case"%":a.push("%");break;default:a.push("<%"+o+"?>")}}return a.push(t.substring(s)),a.join("")};y.formatNumber=function(t,e,r,n){var i=t,a=isNaN(e=Math.abs(e))?2:e,s=r===void 0?",":r,o=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(a),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+o:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+o)+(a?s+Math.abs(i-c).toFixed(a).slice(2):"")};y.formatSize=function(t){return t>=1073741824?t=y.formatNumber(t/1073741824,2,".","")+" GiB":t>=1048576?t=y.formatNumber(t/1048576,2,".","")+" MiB":t>=1024?t=y.formatNumber(t/1024,0)+" KiB":t=y.formatNumber(t,0)+" bytes",t};y.bytesFromIP=function(t){return t.indexOf(".")!==-1?y.bytesFromIPv4(t):t.indexOf(":")!==-1?y.bytesFromIPv6(t):null};y.bytesFromIPv4=function(t){if(t=t.split("."),t.length!==4)return null;for(var e=y.createBuffer(),r=0;r<t.length;++r){var n=parseInt(t[r],10);if(isNaN(n))return null;e.putByte(n)}return e.getBytes()};y.bytesFromIPv6=function(t){var e=0;t=t.split(":").filter(function(s){return s.length===0&&++e,!0});for(var r=(8-t.length+e)*2,n=y.createBuffer(),i=0;i<8;++i){if(!t[i]||t[i].length===0){n.fillWithByte(0,r),r=0;continue}var a=y.hexToBytes(t[i]);a.length<2&&n.putByte(0),n.putBytes(a)}return n.getBytes()};y.bytesToIP=function(t){return t.length===4?y.bytesToIPv4(t):t.length===16?y.bytesToIPv6(t):null};y.bytesToIPv4=function(t){if(t.length!==4)return null;for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e.join(".")};y.bytesToIPv6=function(t){if(t.length!==16)return null;for(var e=[],r=[],n=0,i=0;i<t.length;i+=2){for(var a=y.bytesToHex(t[i]+t[i+1]);a[0]==="0"&&a!=="0";)a=a.substr(1);if(a==="0"){var s=r[r.length-1],o=e.length;!s||o!==s.end+1?r.push({start:o,end:o}):(s.end=o,s.end-s.start>r[n].end-r[n].start&&(n=r.length-1))}e.push(a)}if(r.length>0){var f=r[n];f.end-f.start>0&&(e.splice(f.start,f.end-f.start+1,""),f.start===0&&e.unshift(""),f.end===7&&e.push(""))}return e.join(":")};y.estimateCores=function(t,e){if(typeof t=="function"&&(e=t,t={}),t=t||{},"cores"in y&&!t.update)return e(null,y.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return y.cores=navigator.hardwareConcurrency,e(null,y.cores);if(typeof Worker>"u")return y.cores=1,e(null,y.cores);if(typeof Blob>"u")return y.cores=2,e(null,y.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(s){for(var o=Date.now(),f=o+4;Date.now()<f;);self.postMessage({st:o,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(s,o,f){if(o===0){var c=Math.floor(s.reduce(function(u,h){return u+h},0)/s.length);return y.cores=Math.max(1,c),URL.revokeObjectURL(r),e(null,y.cores)}i(f,function(u,h){s.push(a(f,h)),n(s,o-1,f)})}function i(s,o){for(var f=[],c=[],u=0;u<s;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(c.push(l.data),c.length===s){for(var d=0;d<s;++d)f[d].terminate();o(null,c)}}),f.push(h)}for(var u=0;u<s;++u)f[u].postMessage(u)}function a(s,o){for(var f=[],c=0;c<s;++c)for(var u=o[c],h=f[c]=[],l=0;l<s;++l)if(c!==l){var d=o[l];(u.st>d.st&&u.st<d.et||d.st>u.st&&d.st<u.et)&&h.push(l)}return f.reduce(function(p,g){return Math.max(p,g.length)},0)}}});var Gn=F((Ip,Fa)=>{var gt=X();ht();Fa.exports=gt.cipher=gt.cipher||{};gt.cipher.algorithms=gt.cipher.algorithms||{};gt.cipher.createCipher=function(t,e){var r=t;if(typeof r=="string"&&(r=gt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new gt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!1})};gt.cipher.createDecipher=function(t,e){var r=t;if(typeof r=="string"&&(r=gt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+t);return new gt.cipher.BlockCipher({algorithm:r,key:e,decrypt:!0})};gt.cipher.registerAlgorithm=function(t,e){t=t.toUpperCase(),gt.cipher.algorithms[t]=e};gt.cipher.getAlgorithm=function(t){return t=t.toUpperCase(),t in gt.cipher.algorithms?gt.cipher.algorithms[t]:null};var Hn=gt.cipher.BlockCipher=function(t){this.algorithm=t.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=t.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=t.decrypt,this.algorithm.initialize(t)};Hn.prototype.start=function(t){t=t||{};var e={};for(var r in t)e[r]=t[r];e.decrypt=this._decrypt,this._finish=!1,this._input=gt.util.createBuffer(),this.output=t.output||gt.util.createBuffer(),this.mode.start(e)};Hn.prototype.update=function(t){for(t&&this._input.putBuffer(t);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};Hn.prototype.finish=function(t){t&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return t(this.blockSize,r,!1)},this.mode.unpad=function(r){return t(this.blockSize,r,!0)});var e={};return e.decrypt=this._decrypt,e.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,e)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,e))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,e))}});var Zn=F((_p,Oa)=>{var xt=X();ht();xt.cipher=xt.cipher||{};var O=Oa.exports=xt.cipher.modes=xt.cipher.modes||{};O.ecb=function(t){t=t||{},this.name="ECB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};O.ecb.prototype.start=function(t){};O.ecb.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};O.ecb.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n])};O.ecb.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};O.ecb.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};O.cbc=function(t){t=t||{},this.name="CBC",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};O.cbc.prototype.start=function(t){if(t.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in t)this._iv=Gr(t.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};O.cbc.prototype.encrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^t.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._outBlock[n]);this._prev=this._outBlock};O.cbc.prototype.decrypt=function(t,e,r){if(t.length()<this.blockSize&&!(r&&t.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=t.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)e.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};O.cbc.prototype.pad=function(t,e){var r=t.length()===this.blockSize?this.blockSize:this.blockSize-t.length();return t.fillWithByte(r,r),!0};O.cbc.prototype.unpad=function(t,e){if(e.overflow>0)return!1;var r=t.length(),n=t.at(r-1);return n>this.blockSize<<2?!1:(t.truncate(n),!0)};O.cfb=function(t){t=t||{},this.name="CFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=xt.util.createBuffer(),this._partialBytes=0};O.cfb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Gr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.cfb.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32()^this._outBlock[i],e.putInt32(this._inBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.cfb.prototype.decrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=t.getInt32(),e.putInt32(this._inBlock[i]^this._outBlock[i]);return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=t.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.ofb=function(t){t=t||{},this.name="OFB",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=xt.util.createBuffer(),this._partialBytes=0};O.ofb.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Gr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.ofb.prototype.encrypt=function(t,e,r){var n=t.length();if(t.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0)t.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};O.ofb.prototype.decrypt=O.ofb.prototype.encrypt;O.ctr=function(t){t=t||{},this.name="CTR",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=xt.util.createBuffer(),this._partialBytes=0};O.ctr.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");this._iv=Gr(t.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};O.ctr.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)e.putInt32(t.getInt32()^this._outBlock[i]);else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a>0&&(t.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Wr(this._inBlock)};O.ctr.prototype.decrypt=O.ctr.prototype.encrypt;O.gcm=function(t){t=t||{},this.name="GCM",this.cipher=t.cipher,this.blockSize=t.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=xt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};O.gcm.prototype.start=function(t){if(!("iv"in t))throw new Error("Invalid IV parameter.");var e=xt.util.createBuffer(t.iv);this._cipherLength=0;var r;if("additionalData"in t?r=xt.util.createBuffer(t.additionalData):r=xt.util.createBuffer(),"tagLength"in t?this._tagLength=t.tagLength:this._tagLength=128,this._tag=null,t.decrypt&&(this._tag=xt.util.createBuffer(t.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=e.length();if(n===12)this._j0=[e.getInt32(),e.getInt32(),e.getInt32(),1];else{for(this._j0=[0,0,0,0];e.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[e.getInt32(),e.getInt32(),e.getInt32(),e.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(Wn(n*8)))}this._inBlock=this._j0.slice(0),Wr(this._inBlock),this._partialBytes=0,r=xt.util.createBuffer(r),this._aDataLength=Wn(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};O.gcm.prototype.encrypt=function(t,e,r){var n=t.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^=t.getInt32());this._cipherLength+=this.blockSize}else{var a=(this.blockSize-n)%this.blockSize;a>0&&(a=this.blockSize-a),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(t.getInt32()^this._outBlock[i]);if(a<=0||r){if(r){var s=n%this.blockSize;this._cipherLength+=s,this._partialOutput.truncate(this.blockSize-s)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),a>0&&!r)return t.read-=this.blockSize,e.putBytes(this._partialOutput.getBytes(a-this._partialBytes)),this._partialBytes=a,!0;e.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Wr(this._inBlock)};O.gcm.prototype.decrypt=function(t,e,r){var n=t.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Wr(this._inBlock),this._hashBlock[0]=t.getInt32(),this._hashBlock[1]=t.getInt32(),this._hashBlock[2]=t.getInt32(),this._hashBlock[3]=t.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)e.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};O.gcm.prototype.afterFinish=function(t,e){var r=!0;e.decrypt&&e.overflow&&t.truncate(this.blockSize-e.overflow),this.tag=xt.util.createBuffer();var n=this._aDataLength.concat(Wn(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var a=0;a<this._ints;++a)this.tag.putInt32(this._s[a]^i[a]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),e.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};O.gcm.prototype.multiply=function(t,e){for(var r=[0,0,0,0],n=e.slice(0),i=0;i<128;++i){var a=t[i/32|0]&1<<31-i%32;a&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};O.gcm.prototype.pow=function(t,e){for(var r=t[3]&1,n=3;n>0;--n)e[n]=t[n]>>>1|(t[n-1]&1)<<31;e[0]=t[0]>>>1,r&&(e[0]^=this._R)};O.gcm.prototype.tableMultiply=function(t){for(var e=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=t[n]>>>(7-r%8)*4&15,a=this._m[r][i];e[0]^=a[0],e[1]^=a[1],e[2]^=a[2],e[3]^=a[3]}return e};O.gcm.prototype.ghash=function(t,e,r){return e[0]^=r[0],e[1]^=r[1],e[2]^=r[2],e[3]^=r[3],this.tableMultiply(e)};O.gcm.prototype.generateHashTable=function(t,e){for(var r=8/e,n=4*r,i=16*r,a=new Array(i),s=0;s<i;++s){var o=[0,0,0,0],f=s/n|0,c=(n-1-s%n)*e;o[f]=1<<e-1<<c,a[s]=this.generateSubHashTable(this.multiply(o,t),e)}return a};O.gcm.prototype.generateSubHashTable=function(t,e){var r=1<<e,n=r>>>1,i=new Array(r);i[n]=t.slice(0);for(var a=n>>>1;a>0;)this.pow(i[2*a],i[a]=[]),a>>=1;for(a=2;a<n;){for(var s=1;s<a;++s){var o=i[a],f=i[s];i[a+s]=[o[0]^f[0],o[1]^f[1],o[2]^f[2],o[3]^f[3]]}a*=2}for(i[0]=[0,0,0,0],a=n+1;a<r;++a){var c=i[a^n];i[a]=[t[0]^c[0],t[1]^c[1],t[2]^c[2],t[3]^c[3]]}return i};function Gr(t,e){if(typeof t=="string"&&(t=xt.util.createBuffer(t)),xt.util.isArray(t)&&t.length>4){var r=t;t=xt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(t.length()<e)throw new Error("Invalid IV length; got "+t.length()+" bytes and expected "+e+" bytes.");if(!xt.util.isArray(t)){for(var i=[],a=e/4,n=0;n<a;++n)i.push(t.getInt32());t=i}return t}function Wr(t){t[t.length-1]=t[t.length-1]+1&4294967295}function Wn(t){return[t/4294967296|0,t&4294967295]}});var Yr=F((Rp,za)=>{var J=X();Gn();Zn();ht();za.exports=J.aes=J.aes||{};J.aes.startEncrypting=function(t,e,r,n){var i=Zr({key:t,output:r,decrypt:!1,mode:n});return i.start(e),i};J.aes.createEncryptionCipher=function(t,e){return Zr({key:t,output:null,decrypt:!1,mode:e})};J.aes.startDecrypting=function(t,e,r,n){var i=Zr({key:t,output:r,decrypt:!0,mode:n});return i.start(e),i};J.aes.createDecryptionCipher=function(t,e){return Zr({key:t,output:null,decrypt:!0,mode:e})};J.aes.Algorithm=function(t,e){Qn||Va();var r=this;r.name=t,r.mode=new e({blockSize:16,cipher:{encrypt:function(n,i){return $n(r._w,n,i,!1)},decrypt:function(n,i){return $n(r._w,n,i,!0)}}}),r._init=!1};J.aes.Algorithm.prototype.initialize=function(t){if(!this._init){var e=t.key,r;if(typeof e=="string"&&(e.length===16||e.length===24||e.length===32))e=J.util.createBuffer(e);else if(J.util.isArray(e)&&(e.length===16||e.length===24||e.length===32)){r=e,e=J.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(!J.util.isArray(e)){r=e,e=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)e.push(r.getInt32())}}if(!J.util.isArray(e)||!(e.length===4||e.length===6||e.length===8))throw new Error("Invalid key parameter.");var a=this.mode.name,s=["CFB","OFB","CTR","GCM"].indexOf(a)!==-1;this._w=qa(e,t.decrypt&&!s),this._init=!0}};J.aes._expandKey=function(t,e){return Qn||Va(),qa(t,e)};J.aes._updateBlock=$n;He("AES-ECB",J.cipher.modes.ecb);He("AES-CBC",J.cipher.modes.cbc);He("AES-CFB",J.cipher.modes.cfb);He("AES-OFB",J.cipher.modes.ofb);He("AES-CTR",J.cipher.modes.ctr);He("AES-GCM",J.cipher.modes.gcm);function He(t,e){var r=function(){return new J.aes.Algorithm(t,e)};J.cipher.registerAlgorithm(t,r)}var Qn=!1,ze=4,Bt,Yn,Ma,Ie,Ot;function Va(){Qn=!0,Ma=[0,1,2,4,8,16,32,64,128,27,54];for(var t=new Array(256),e=0;e<128;++e)t[e]=e<<1,t[e+128]=e+128<<1^283;Bt=new Array(256),Yn=new Array(256),Ie=new Array(4),Ot=new Array(4);for(var e=0;e<4;++e)Ie[e]=new Array(256),Ot[e]=new Array(256);for(var r=0,n=0,i,a,s,o,f,c,u,e=0;e<256;++e){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,Bt[r]=o,Yn[o]=r,f=t[o],i=t[r],a=t[i],s=t[a],c=f<<24^o<<16^o<<8^(o^f),u=(i^a^s)<<24^(r^s)<<16^(r^a^s)<<8^(r^i^s);for(var h=0;h<4;++h)Ie[h][r]=c,Ot[h][o]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^t[t[t[i^s]]],n^=t[t[n]])}}function qa(t,e){for(var r=t.slice(0),n,i=1,a=r.length,s=a+6+1,o=ze*s,f=a;f<o;++f)n=r[f-1],f%a===0?(n=Bt[n>>>16&255]<<24^Bt[n>>>8&255]<<16^Bt[n&255]<<8^Bt[n>>>24]^Ma[i]<<24,i++):a>6&&f%a===4&&(n=Bt[n>>>24]<<24^Bt[n>>>16&255]<<16^Bt[n>>>8&255]<<8^Bt[n&255]),r[f]=r[f-a]^n;if(e){var c,u=Ot[0],h=Ot[1],l=Ot[2],d=Ot[3],p=r.slice(0);o=r.length;for(var f=0,g=o-ze;f<o;f+=ze,g-=ze)if(f===0||f===o-ze)p[f]=r[g],p[f+1]=r[g+3],p[f+2]=r[g+2],p[f+3]=r[g+1];else for(var v=0;v<ze;++v)c=r[g+v],p[f+(3&-v)]=u[Bt[c>>>24]]^h[Bt[c>>>16&255]]^l[Bt[c>>>8&255]]^d[Bt[c&255]];r=p}return r}function $n(t,e,r,n){var i=t.length/4-1,a,s,o,f,c;n?(a=Ot[0],s=Ot[1],o=Ot[2],f=Ot[3],c=Yn):(a=Ie[0],s=Ie[1],o=Ie[2],f=Ie[3],c=Bt);var u,h,l,d,p,g,v;u=e[0]^t[0],h=e[n?3:1]^t[1],l=e[2]^t[2],d=e[n?1:3]^t[3];for(var m=3,w=1;w<i;++w)p=a[u>>>24]^s[h>>>16&255]^o[l>>>8&255]^f[d&255]^t[++m],g=a[h>>>24]^s[l>>>16&255]^o[d>>>8&255]^f[u&255]^t[++m],v=a[l>>>24]^s[d>>>16&255]^o[u>>>8&255]^f[h&255]^t[++m],d=a[d>>>24]^s[u>>>16&255]^o[h>>>8&255]^f[l&255]^t[++m],u=p,h=g,l=v;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[l>>>8&255]<<8^c[d&255]^t[++m],r[n?3:1]=c[h>>>24]<<24^c[l>>>16&255]<<16^c[d>>>8&255]<<8^c[u&255]^t[++m],r[2]=c[l>>>24]<<24^c[d>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^t[++m],r[n?1:3]=c[d>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[l&255]^t[++m]}function Zr(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="AES-"+e,n;t.decrypt?n=J.cipher.createDecipher(r,t.key):n=J.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof J.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var jr=F((kd,ds)=>{var wr=X();wr.pki=wr.pki||{};var Si=ds.exports=wr.pki.oids=wr.oids=wr.oids||{};function B(t,e){Si[t]=e,Si[e]=t}function Q(t,e){Si[t]=e}B("1.2.840.113549.1.1.1","rsaEncryption");B("1.2.840.113549.1.1.4","md5WithRSAEncryption");B("1.2.840.113549.1.1.5","sha1WithRSAEncryption");B("1.2.840.113549.1.1.7","RSAES-OAEP");B("1.2.840.113549.1.1.8","mgf1");B("1.2.840.113549.1.1.9","pSpecified");B("1.2.840.113549.1.1.10","RSASSA-PSS");B("1.2.840.113549.1.1.11","sha256WithRSAEncryption");B("1.2.840.113549.1.1.12","sha384WithRSAEncryption");B("1.2.840.113549.1.1.13","sha512WithRSAEncryption");B("1.3.101.112","EdDSA25519");B("1.2.840.10040.4.3","dsa-with-sha1");B("1.3.14.3.2.7","desCBC");B("1.3.14.3.2.26","sha1");B("1.3.14.3.2.29","sha1WithRSASignature");B("2.16.840.1.101.3.4.2.1","sha256");B("2.16.840.1.101.3.4.2.2","sha384");B("2.16.840.1.101.3.4.2.3","sha512");B("2.16.840.1.101.3.4.2.4","sha224");B("2.16.840.1.101.3.4.2.5","sha512-224");B("2.16.840.1.101.3.4.2.6","sha512-256");B("1.2.840.113549.2.2","md2");B("1.2.840.113549.2.5","md5");B("1.2.840.113549.1.7.1","data");B("1.2.840.113549.1.7.2","signedData");B("1.2.840.113549.1.7.3","envelopedData");B("1.2.840.113549.1.7.4","signedAndEnvelopedData");B("1.2.840.113549.1.7.5","digestedData");B("1.2.840.113549.1.7.6","encryptedData");B("1.2.840.113549.1.9.1","emailAddress");B("1.2.840.113549.1.9.2","unstructuredName");B("1.2.840.113549.1.9.3","contentType");B("1.2.840.113549.1.9.4","messageDigest");B("1.2.840.113549.1.9.5","signingTime");B("1.2.840.113549.1.9.6","counterSignature");B("1.2.840.113549.1.9.7","challengePassword");B("1.2.840.113549.1.9.8","unstructuredAddress");B("1.2.840.113549.1.9.14","extensionRequest");B("1.2.840.113549.1.9.20","friendlyName");B("1.2.840.113549.1.9.21","localKeyId");B("1.2.840.113549.1.9.22.1","x509Certificate");B("1.2.840.113549.1.12.10.1.1","keyBag");B("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");B("1.2.840.113549.1.12.10.1.3","certBag");B("1.2.840.113549.1.12.10.1.4","crlBag");B("1.2.840.113549.1.12.10.1.5","secretBag");B("1.2.840.113549.1.12.10.1.6","safeContentsBag");B("1.2.840.113549.1.5.13","pkcs5PBES2");B("1.2.840.113549.1.5.12","pkcs5PBKDF2");B("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");B("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");B("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");B("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");B("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");B("1.2.840.113549.2.7","hmacWithSHA1");B("1.2.840.113549.2.8","hmacWithSHA224");B("1.2.840.113549.2.9","hmacWithSHA256");B("1.2.840.113549.2.10","hmacWithSHA384");B("1.2.840.113549.2.11","hmacWithSHA512");B("1.2.840.113549.3.7","des-EDE3-CBC");B("2.16.840.1.101.3.4.1.2","aes128-CBC");B("2.16.840.1.101.3.4.1.22","aes192-CBC");B("2.16.840.1.101.3.4.1.42","aes256-CBC");B("2.5.4.3","commonName");B("2.5.4.4","surname");B("2.5.4.5","serialNumber");B("2.5.4.6","countryName");B("2.5.4.7","localityName");B("2.5.4.8","stateOrProvinceName");B("2.5.4.9","streetAddress");B("2.5.4.10","organizationName");B("2.5.4.11","organizationalUnitName");B("2.5.4.12","title");B("2.5.4.13","description");B("2.5.4.15","businessCategory");B("2.5.4.17","postalCode");B("2.5.4.42","givenName");B("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");B("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");B("2.16.840.1.113730.1.1","nsCertType");B("2.16.840.1.113730.1.13","nsComment");Q("2.5.29.1","authorityKeyIdentifier");Q("2.5.29.2","keyAttributes");Q("2.5.29.3","certificatePolicies");Q("2.5.29.4","keyUsageRestriction");Q("2.5.29.5","policyMapping");Q("2.5.29.6","subtreesConstraint");Q("2.5.29.7","subjectAltName");Q("2.5.29.8","issuerAltName");Q("2.5.29.9","subjectDirectoryAttributes");Q("2.5.29.10","basicConstraints");Q("2.5.29.11","nameConstraints");Q("2.5.29.12","policyConstraints");Q("2.5.29.13","basicConstraints");B("2.5.29.14","subjectKeyIdentifier");B("2.5.29.15","keyUsage");Q("2.5.29.16","privateKeyUsagePeriod");B("2.5.29.17","subjectAltName");B("2.5.29.18","issuerAltName");B("2.5.29.19","basicConstraints");Q("2.5.29.20","cRLNumber");Q("2.5.29.21","cRLReason");Q("2.5.29.22","expirationDate");Q("2.5.29.23","instructionCode");Q("2.5.29.24","invalidityDate");Q("2.5.29.25","cRLDistributionPoints");Q("2.5.29.26","issuingDistributionPoint");Q("2.5.29.27","deltaCRLIndicator");Q("2.5.29.28","issuingDistributionPoint");Q("2.5.29.29","certificateIssuer");Q("2.5.29.30","nameConstraints");B("2.5.29.31","cRLDistributionPoints");B("2.5.29.32","certificatePolicies");Q("2.5.29.33","policyMappings");Q("2.5.29.34","policyConstraints");B("2.5.29.35","authorityKeyIdentifier");Q("2.5.29.36","policyConstraints");B("2.5.29.37","extKeyUsage");Q("2.5.29.46","freshestCRL");Q("2.5.29.54","inhibitAnyPolicy");B("1.3.6.1.4.1.11129.2.4.2","timestampList");B("1.3.6.1.5.5.7.1.1","authorityInfoAccess");B("1.3.6.1.5.5.7.3.1","serverAuth");B("1.3.6.1.5.5.7.3.2","clientAuth");B("1.3.6.1.5.5.7.3.3","codeSigning");B("1.3.6.1.5.5.7.3.4","emailProtection");B("1.3.6.1.5.5.7.3.8","timeStamping")});var Er=F((Dd,gs)=>{var j=X();ht();jr();var C=gs.exports=j.asn1=j.asn1||{};C.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};C.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};C.create=function(t,e,r,n,i){if(j.util.isArray(n)){for(var a=[],s=0;s<n.length;++s)n[s]!==void 0&&a.push(n[s]);n=a}var o={tagClass:t,type:e,constructed:r,composed:r||j.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=C.copy(o)),o};C.copy=function(t,e){var r;if(j.util.isArray(t)){r=[];for(var n=0;n<t.length;++n)r.push(C.copy(t[n],e));return r}return typeof t=="string"?t:(r={tagClass:t.tagClass,type:t.type,constructed:t.constructed,composed:t.composed,value:C.copy(t.value,e)},e&&!e.excludeBitStringContents&&(r.bitStringContents=t.bitStringContents),r)};C.equals=function(t,e,r){if(j.util.isArray(t)){if(!j.util.isArray(e)||t.length!==e.length)return!1;for(var n=0;n<t.length;++n)if(!C.equals(t[n],e[n]))return!1;return!0}if(typeof t!=typeof e)return!1;if(typeof t=="string")return t===e;var i=t.tagClass===e.tagClass&&t.type===e.type&&t.constructed===e.constructed&&t.composed===e.composed&&C.equals(t.value,e.value);return r&&r.includeBitStringContents&&(i=i&&t.bitStringContents===e.bitStringContents),i};C.getBerValueLength=function(t){var e=t.getByte();if(e!==128){var r,n=e&128;return n?r=t.getInt((e&127)<<3):r=e,r}};function Sr(t,e,r){if(r>e){var n=new Error("Too few bytes to parse DER.");throw n.available=t.length(),n.remaining=e,n.requested=r,n}}var Fc=function(t,e){var r=t.getByte();if(e--,r!==128){var n,i=r&128;if(!i)n=r;else{var a=r&127;Sr(t,e,a),n=t.getInt(a<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};C.fromDer=function(t,e){e===void 0&&(e={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof e=="boolean"&&(e={strict:e,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in e||(e.strict=!0),"parseAllBytes"in e||(e.parseAllBytes=!0),"decodeBitStrings"in e||(e.decodeBitStrings=!0),typeof t=="string"&&(t=j.util.createBuffer(t));var r=t.length(),n=tn(t,t.length(),0,e);if(e.parseAllBytes&&t.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=t.length(),i}return n};function tn(t,e,r,n){var i;Sr(t,e,2);var a=t.getByte();e--;var s=a&192,o=a&31;i=t.length();var f=Fc(t,e);if(e-=i-t.length(),f!==void 0&&f>e){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=t.length(),c.remaining=e,c.requested=f,c}f=e}var u,h,l=(a&32)===32;if(l)if(u=[],f===void 0)for(;;){if(Sr(t,e,2),t.bytes(2)===String.fromCharCode(0,0)){t.getBytes(2),e-=2;break}i=t.length(),u.push(tn(t,e,r+1,n)),e-=i-t.length()}else for(;f>0;)i=t.length(),u.push(tn(t,f,r+1,n)),e-=i-t.length(),f-=i-t.length();if(u===void 0&&s===C.Class.UNIVERSAL&&o===C.Type.BITSTRING&&(h=t.bytes(f)),u===void 0&&n.decodeBitStrings&&s===C.Class.UNIVERSAL&&o===C.Type.BITSTRING&&f>1){var d=t.read,p=e,g=0;if(o===C.Type.BITSTRING&&(Sr(t,e,1),g=t.getByte(),e--),g===0)try{i=t.length();var v={strict:!0,decodeBitStrings:!0},m=tn(t,e,r+1,v),w=i-t.length();e-=w,o==C.Type.BITSTRING&&w++;var A=m.tagClass;w===f&&(A===C.Class.UNIVERSAL||A===C.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(t.read=d,e=p)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=e}if(o===C.Type.BMPSTRING)for(u="";f>0;f-=2)Sr(t,e,2),u+=String.fromCharCode(t.getInt16()),e-=2;else u=t.getBytes(f),e-=f}var N=h===void 0?null:{bitStringContents:h};return C.create(s,o,l,u,N)}C.toDer=function(t){var e=j.util.createBuffer(),r=t.tagClass|t.type,n=j.util.createBuffer(),i=!1;if("bitStringContents"in t&&(i=!0,t.original&&(i=C.equals(t,t.original))),i)n.putBytes(t.bitStringContents);else if(t.composed){t.constructed?r|=32:n.putByte(0);for(var a=0;a<t.value.length;++a)t.value[a]!==void 0&&n.putBuffer(C.toDer(t.value[a]))}else if(t.type===C.Type.BMPSTRING)for(var a=0;a<t.value.length;++a)n.putInt16(t.value.charCodeAt(a));else t.type===C.Type.INTEGER&&t.value.length>1&&(t.value.charCodeAt(0)===0&&!(t.value.charCodeAt(1)&128)||t.value.charCodeAt(0)===255&&(t.value.charCodeAt(1)&128)===128)?n.putBytes(t.value.substr(1)):n.putBytes(t.value);if(e.putByte(r),n.length()<=127)e.putByte(n.length()&127);else{var s=n.length(),o="";do o+=String.fromCharCode(s&255),s=s>>>8;while(s>0);e.putByte(o.length|128);for(var a=o.length-1;a>=0;--a)e.putByte(o.charCodeAt(a))}return e.putBuffer(n),e};C.oidToDer=function(t){var e=t.split("."),r=j.util.createBuffer();r.putByte(40*parseInt(e[0],10)+parseInt(e[1],10));for(var n,i,a,s,o=2;o<e.length;++o){n=!0,i=[],a=parseInt(e[o],10);do s=a&127,a=a>>>7,n||(s|=128),i.push(s),n=!1;while(a>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};C.derToOid=function(t){var e;typeof t=="string"&&(t=j.util.createBuffer(t));var r=t.getByte();e=Math.floor(r/40)+"."+r%40;for(var n=0;t.length()>0;)r=t.getByte(),n=n<<7,r&128?n+=r&127:(e+="."+(n+r),n=0);return e};C.utcTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(t.substr(2,2),10)-1,i=parseInt(t.substr(4,2),10),a=parseInt(t.substr(6,2),10),s=parseInt(t.substr(8,2),10),o=0;if(t.length>11){var f=t.charAt(10),c=10;f!=="+"&&f!=="-"&&(o=parseInt(t.substr(10,2),10),c+=2)}if(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,0),c&&(f=t.charAt(c),f==="+"||f==="-")){var u=parseInt(t.substr(c+1,2),10),h=parseInt(t.substr(c+4,2),10),l=u*60+h;l*=6e4,f==="+"?e.setTime(+e-l):e.setTime(+e+l)}return e};C.generalizedTimeToDate=function(t){var e=new Date,r=parseInt(t.substr(0,4),10),n=parseInt(t.substr(4,2),10)-1,i=parseInt(t.substr(6,2),10),a=parseInt(t.substr(8,2),10),s=parseInt(t.substr(10,2),10),o=parseInt(t.substr(12,2),10),f=0,c=0,u=!1;t.charAt(t.length-1)==="Z"&&(u=!0);var h=t.length-5,l=t.charAt(h);if(l==="+"||l==="-"){var d=parseInt(t.substr(h+1,2),10),p=parseInt(t.substr(h+4,2),10);c=d*60+p,c*=6e4,l==="+"&&(c*=-1),u=!0}return t.charAt(14)==="."&&(f=parseFloat(t.substr(14),10)*1e3),u?(e.setUTCFullYear(r,n,i),e.setUTCHours(a,s,o,f),e.setTime(+e+c)):(e.setFullYear(r,n,i),e.setHours(a,s,o,f)),e};C.dateToUtcTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push((""+t.getUTCFullYear()).substr(2)),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};C.dateToGeneralizedTime=function(t){if(typeof t=="string")return t;var e="",r=[];r.push(""+t.getUTCFullYear()),r.push(""+(t.getUTCMonth()+1)),r.push(""+t.getUTCDate()),r.push(""+t.getUTCHours()),r.push(""+t.getUTCMinutes()),r.push(""+t.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(e+="0"),e+=r[n];return e+="Z",e};C.integerToDer=function(t){var e=j.util.createBuffer();if(t>=-128&&t<128)return e.putSignedInt(t,8);if(t>=-32768&&t<32768)return e.putSignedInt(t,16);if(t>=-8388608&&t<8388608)return e.putSignedInt(t,24);if(t>=-2147483648&&t<2147483648)return e.putSignedInt(t,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=t,r};C.derToInteger=function(t){typeof t=="string"&&(t=j.util.createBuffer(t));var e=t.length()*8;if(e>32)throw new Error("Integer too large; max is 32-bits.");return t.getSignedInt(e)};C.validate=function(t,e,r,n){var i=!1;if((t.tagClass===e.tagClass||typeof e.tagClass>"u")&&(t.type===e.type||typeof e.type>"u"))if(t.constructed===e.constructed||typeof e.constructed>"u"){if(i=!0,e.value&&j.util.isArray(e.value))for(var a=0,s=0;i&&s<e.value.length;++s)i=e.value[s].optional||!1,t.value[a]&&(i=C.validate(t.value[a],e.value[s],r,n),i?++a:e.value[s].optional&&(i=!0)),!i&&n&&n.push("["+e.name+'] Tag class "'+e.tagClass+'", type "'+e.type+'" expected value length "'+e.value.length+'", got "'+t.value.length+'"');if(i&&r&&(e.capture&&(r[e.capture]=t.value),e.captureAsn1&&(r[e.captureAsn1]=t),e.captureBitStringContents&&"bitStringContents"in t&&(r[e.captureBitStringContents]=t.bitStringContents),e.captureBitStringValue&&"bitStringContents"in t)){var o;if(t.bitStringContents.length<2)r[e.captureBitStringValue]="";else{var f=t.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[e.captureBitStringValue]=t.bitStringContents.slice(1)}}}else n&&n.push("["+e.name+'] Expected constructed "'+e.constructed+'", got "'+t.constructed+'"');else n&&(t.tagClass!==e.tagClass&&n.push("["+e.name+'] Expected tag class "'+e.tagClass+'", got "'+t.tagClass+'"'),t.type!==e.type&&n.push("["+e.name+'] Expected type "'+e.type+'", got "'+t.type+'"'));return i};var ys=/[^\\u0000-\\u00ff]/;C.prettyPrint=function(t,e,r){var n="";e=e||0,r=r||2,e>0&&(n+=`
`);for(var i="",a=0;a<e*r;++a)i+=" ";switch(n+=i+"Tag: ",t.tagClass){case C.Class.UNIVERSAL:n+="Universal:";break;case C.Class.APPLICATION:n+="Application:";break;case C.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case C.Class.PRIVATE:n+="Private:";break}if(t.tagClass===C.Class.UNIVERSAL)switch(n+=t.type,t.type){case C.Type.NONE:n+=" (None)";break;case C.Type.BOOLEAN:n+=" (Boolean)";break;case C.Type.INTEGER:n+=" (Integer)";break;case C.Type.BITSTRING:n+=" (Bit string)";break;case C.Type.OCTETSTRING:n+=" (Octet string)";break;case C.Type.NULL:n+=" (Null)";break;case C.Type.OID:n+=" (Object Identifier)";break;case C.Type.ODESC:n+=" (Object Descriptor)";break;case C.Type.EXTERNAL:n+=" (External or Instance of)";break;case C.Type.REAL:n+=" (Real)";break;case C.Type.ENUMERATED:n+=" (Enumerated)";break;case C.Type.EMBEDDED:n+=" (Embedded PDV)";break;case C.Type.UTF8:n+=" (UTF8)";break;case C.Type.ROID:n+=" (Relative Object Identifier)";break;case C.Type.SEQUENCE:n+=" (Sequence)";break;case C.Type.SET:n+=" (Set)";break;case C.Type.PRINTABLESTRING:n+=" (Printable String)";break;case C.Type.IA5String:n+=" (IA5String (ASCII))";break;case C.Type.UTCTIME:n+=" (UTC time)";break;case C.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case C.Type.BMPSTRING:n+=" (BMP String)";break}else n+=t.type;if(n+=`
`,n+=i+"Constructed: "+t.constructed+`
`,t.composed){for(var s=0,o="",a=0;a<t.value.length;++a)t.value[a]!==void 0&&(s+=1,o+=C.prettyPrint(t.value[a],e+1,r),a+1<t.value.length&&(o+=","));n+=i+"Sub values: "+s+o}else{if(n+=i+"Value: ",t.type===C.Type.OID){var f=C.derToOid(t.value);n+=f,j.pki&&j.pki.oids&&f in j.pki.oids&&(n+=" ("+j.pki.oids[f]+") ")}if(t.type===C.Type.INTEGER)try{n+=C.derToInteger(t.value)}catch{n+="0x"+j.util.bytesToHex(t.value)}else if(t.type===C.Type.BITSTRING){if(t.value.length>1?n+="0x"+j.util.bytesToHex(t.value.slice(1)):n+="(none)",t.value.length>0){var c=t.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(t.type===C.Type.OCTETSTRING)ys.test(t.value)||(n+="("+t.value+") "),n+="0x"+j.util.bytesToHex(t.value);else if(t.type===C.Type.UTF8)try{n+=j.util.decodeUtf8(t.value)}catch(u){if(u.message==="URI malformed")n+="0x"+j.util.bytesToHex(t.value)+" (malformed UTF8)";else throw u}else t.type===C.Type.PRINTABLESTRING||t.type===C.Type.IA5String?n+=t.value:ys.test(t.value)?n+="0x"+j.util.bytesToHex(t.value):t.value.length===0?n+="[null]":n+=t.value}return n}});var ms=F((Nd,vs)=>{var at=X();Gn();Zn();ht();vs.exports=at.des=at.des||{};at.des.startEncrypting=function(t,e,r,n){var i=en({key:t,output:r,decrypt:!1,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};at.des.createEncryptionCipher=function(t,e){return en({key:t,output:null,decrypt:!1,mode:e})};at.des.startDecrypting=function(t,e,r,n){var i=en({key:t,output:r,decrypt:!0,mode:n||(e===null?"ECB":"CBC")});return i.start(e),i};at.des.createDecryptionCipher=function(t,e){return en({key:t,output:null,decrypt:!0,mode:e})};at.des.Algorithm=function(t,e){var r=this;r.name=t,r.mode=new e({blockSize:8,cipher:{encrypt:function(n,i){return xs(r._keys,n,i,!1)},decrypt:function(n,i){return xs(r._keys,n,i,!0)}}}),r._init=!1};at.des.Algorithm.prototype.initialize=function(t){if(!this._init){var e=at.util.createBuffer(t.key);if(this.name.indexOf("3DES")===0&&e.length()!==24)throw new Error("Invalid Triple-DES key size: "+e.length()*8);this._keys=Zc(e),this._init=!0}};$t("DES-ECB",at.cipher.modes.ecb);$t("DES-CBC",at.cipher.modes.cbc);$t("DES-CFB",at.cipher.modes.cfb);$t("DES-OFB",at.cipher.modes.ofb);$t("DES-CTR",at.cipher.modes.ctr);$t("3DES-ECB",at.cipher.modes.ecb);$t("3DES-CBC",at.cipher.modes.cbc);$t("3DES-CFB",at.cipher.modes.cfb);$t("3DES-OFB",at.cipher.modes.ofb);$t("3DES-CTR",at.cipher.modes.ctr);function $t(t,e){var r=function(){return new at.des.Algorithm(t,e)};at.cipher.registerAlgorithm(t,r)}var Oc=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],Mc=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],Vc=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],qc=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],zc=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Hc=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Gc=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Wc=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Zc(t){for(var e=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],a=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],s=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],g=t.length()>8?3:1,v=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],w=0,A,N=0;N<g;N++){var T=t.getInt32(),_=t.getInt32();A=(T>>>4^_)&252645135,_^=A,T^=A<<4,A=(_>>>-16^T)&65535,T^=A,_^=A<<-16,A=(T>>>2^_)&858993459,_^=A,T^=A<<2,A=(_>>>-16^T)&65535,T^=A,_^=A<<-16,A=(T>>>1^_)&1431655765,_^=A,T^=A<<1,A=(_>>>8^T)&16711935,T^=A,_^=A<<8,A=(T>>>1^_)&1431655765,_^=A,T^=A<<1,A=T<<8|_>>>20&240,T=_<<24|_<<8&16711680|_>>>8&65280|_>>>24&240,_=A;for(var V=0;V<m.length;++V){m[V]?(T=T<<2|T>>>26,_=_<<2|_>>>26):(T=T<<1|T>>>27,_=_<<1|_>>>27),T&=-15,_&=-15;var Y=e[T>>>28]|r[T>>>24&15]|n[T>>>20&15]|i[T>>>16&15]|a[T>>>12&15]|s[T>>>8&15]|o[T>>>4&15],wt=f[_>>>28]|c[_>>>24&15]|u[_>>>20&15]|h[_>>>16&15]|l[_>>>12&15]|d[_>>>8&15]|p[_>>>4&15];A=(wt>>>16^Y)&65535,v[w++]=Y^A,v[w++]=wt^A<<16}}return v}function xs(t,e,r,n){var i=t.length===32?3:9,a;i===3?a=n?[30,-2,-2]:[0,32,2]:a=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var s,o=e[0],f=e[1];s=(o>>>4^f)&252645135,f^=s,o^=s<<4,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,o=o<<1|o>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=a[c+1],h=a[c+2],l=a[c];l!=u;l+=h){var d=f^t[l],p=(f>>>4|f<<28)^t[l+1];s=o,o=f,f=s^(Mc[d>>>24&63]|qc[d>>>16&63]|Hc[d>>>8&63]|Wc[d&63]|Oc[p>>>24&63]|Vc[p>>>16&63]|zc[p>>>8&63]|Gc[p&63])}s=o,o=f,f=s}o=o>>>1|o<<31,f=f>>>1|f<<31,s=(o>>>1^f)&1431655765,f^=s,o^=s<<1,s=(f>>>8^o)&16711935,o^=s,f^=s<<8,s=(f>>>2^o)&858993459,o^=s,f^=s<<2,s=(o>>>16^f)&65535,f^=s,o^=s<<16,s=(o>>>4^f)&252645135,f^=s,o^=s<<4,r[0]=o,r[1]=f}function en(t){t=t||{};var e=(t.mode||"CBC").toUpperCase(),r="DES-"+e,n;t.decrypt?n=at.cipher.createDecipher(r,t.key):n=at.cipher.createCipher(r,t.key);var i=n.start;return n.start=function(a,s){var o=null;s instanceof at.util.ByteBuffer&&(o=s,s={}),s=s||{},s.output=o,s.iv=a,i.call(n,s)},n}});var Re=F((Ld,bs)=>{var rn=X();bs.exports=rn.md=rn.md||{};rn.md.algorithms=rn.md.algorithms||{}});var Ss=F((Pd,ws)=>{var fe=X();Re();ht();var Yc=ws.exports=fe.hmac=fe.hmac||{};Yc.create=function(){var t=null,e=null,r=null,n=null,i={};return i.start=function(a,s){if(a!==null)if(typeof a=="string")if(a=a.toLowerCase(),a in fe.md.algorithms)e=fe.md.algorithms[a].create();else throw new Error('Unknown hash algorithm "'+a+'"');else e=a;if(s===null)s=t;else{if(typeof s=="string")s=fe.util.createBuffer(s);else if(fe.util.isArray(s)){var o=s;s=fe.util.createBuffer();for(var f=0;f<o.length;++f)s.putByte(o[f])}var c=s.length();c>e.blockLength&&(e.start(),e.update(s.bytes()),s=e.digest()),r=fe.util.createBuffer(),n=fe.util.createBuffer(),c=s.length();for(var f=0;f<c;++f){var o=s.at(f);r.putByte(54^o),n.putByte(92^o)}if(c<e.blockLength)for(var o=e.blockLength-c,f=0;f<o;++f)r.putByte(54),n.putByte(92);t=s,r=r.bytes(),n=n.bytes()}e.start(),e.update(r)},i.update=function(a){e.update(a)},i.getMac=function(){var a=e.digest().bytes();return e.start(),e.update(n),e.update(a),e.digest()},i.digest=i.getMac,i}});var Xe=F(()=>{});var Ei=F((Fd,Es)=>{var At=X();Ss();Re();ht();var $c=At.pkcs5=At.pkcs5||{},ce;At.util.isNodejs&&!At.options.usePureJavaScript&&(ce=Xe());Es.exports=At.pbkdf2=$c.pbkdf2=function(t,e,r,n,i,a){if(typeof i=="function"&&(a=i,i=null),At.util.isNodejs&&!At.options.usePureJavaScript&&ce.pbkdf2&&(i===null||typeof i!="object")&&(ce.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),t=Buffer.from(t,"binary"),e=Buffer.from(e,"binary"),a?ce.pbkdf2Sync.length===4?ce.pbkdf2(t,e,r,n,function(A,N){if(A)return a(A);a(null,N.toString("binary"))}):ce.pbkdf2(t,e,r,n,i,function(A,N){if(A)return a(A);a(null,N.toString("binary"))}):ce.pbkdf2Sync.length===4?ce.pbkdf2Sync(t,e,r,n).toString("binary"):ce.pbkdf2Sync(t,e,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in At.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=At.md[i].create()}var s=i.digestLength;if(n>4294967295*s){var o=new Error("Derived key is too long.");if(a)return a(o);throw o}var f=Math.ceil(n/s),c=n-(f-1)*s,u=At.hmac.create();u.start(i,t);var h="",l,d,p;if(!a){for(var g=1;g<=f;++g){u.start(null,null),u.update(e),u.update(At.util.int32ToBytes(g)),l=p=u.digest().getBytes();for(var v=2;v<=r;++v)u.start(null,null),u.update(p),d=u.digest().getBytes(),l=At.util.xorBytes(l,d,s),p=d;h+=g<f?l:l.substr(0,c)}return h}var g=1,v;function m(){if(g>f)return a(null,h);u.start(null,null),u.update(e),u.update(At.util.int32ToBytes(g)),l=p=u.digest().getBytes(),v=2,w()}function w(){if(v<=r)return u.start(null,null),u.update(p),d=u.digest().getBytes(),l=At.util.xorBytes(l,d,s),p=d,++v,At.util.setImmediate(w);h+=g<f?l:l.substr(0,c),++g,m()}m()}});var Cs=F((Od,As)=>{var an=X();ht();var Bs=As.exports=an.pem=an.pem||{};Bs.encode=function(t,e){e=e||{};var r="-----BEGIN "+t.type+`-----\r
`,n;if(t.procType&&(n={name:"Proc-Type",values:[String(t.procType.version),t.procType.type]},r+=nn(n)),t.contentDomain&&(n={name:"Content-Domain",values:[t.contentDomain]},r+=nn(n)),t.dekInfo&&(n={name:"DEK-Info",values:[t.dekInfo.algorithm]},t.dekInfo.parameters&&n.values.push(t.dekInfo.parameters),r+=nn(n)),t.headers)for(var i=0;i<t.headers.length;++i)r+=nn(t.headers[i]);return t.procType&&(r+=`\r
`),r+=an.util.encode64(t.body,e.maxline||64)+`\r
`,r+="-----END "+t.type+`-----\r
`,r};Bs.decode=function(t){for(var e=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,a;a=r.exec(t),!!a;){var s=a[1];s==="NEW CERTIFICATE REQUEST"&&(s="CERTIFICATE REQUEST");var o={type:s,procType:null,contentDomain:null,dekInfo:null,headers:[],body:an.util.decode64(a[3])};if(e.push(o),!!a[2]){for(var f=a[2].split(i),c=0;a&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;u+=l,c=h}if(a=u.match(n),a){for(var d={name:a[1],values:[]},p=a[2].split(","),g=0;g<p.length;++g)d.values.push(Qc(p[g]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(e.length===0)throw new Error("Invalid PEM formatted message.");return e};function nn(t){for(var e=t.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<t.values.length;++i)r.push(t.values[i].replace(/^(\S+\r\n)/,n));e+=r.join(",")+`\r
`;for(var a=0,s=-1,i=0;i<e.length;++i,++a)if(a>65&&s!==-1){var o=e[s];o===","?(++s,e=e.substr(0,s)+`\r
 `+e.substr(s)):e=e.substr(0,s)+`\r
`+o+e.substr(s+1),a=i-s-1,s=-1,++i}else(e[i]===" "||e[i]==="	"||e[i]===",")&&(s=i);return e}function Qc(t){return t.replace(/^\s+/,"")}});var Ds=F((Md,ks)=>{var Qt=X();Re();ht();var Is=ks.exports=Qt.sha256=Qt.sha256||{};Qt.md.sha256=Qt.md.algorithms.sha256=Is;Is.create=function(){_s||Xc();var t=null,e=Qt.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=Qt.util.createBuffer(),t={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=Qt.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),Ts(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Qt.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(Bi.substr(0,n.blockLength-s));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4,h5:t.h5,h6:t.h6,h7:t.h7};Ts(h,r,i);var l=Qt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var Bi=null,_s=!1,Rs=null;function Xc(){Bi=String.fromCharCode(128),Bi+=Qt.util.fillString(String.fromCharCode(0),64),Rs=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],_s=!0}function Ts(t,e,r){for(var n,i,a,s,o,f,c,u,h,l,d,p,g,v,m,w=r.length();w>=64;){for(c=0;c<16;++c)e[c]=r.getInt32();for(;c<64;++c)n=e[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=e[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,e[c]=n+e[c-7]+i+e[c-16]|0;for(u=t.h0,h=t.h1,l=t.h2,d=t.h3,p=t.h4,g=t.h5,v=t.h6,m=t.h7,c=0;c<64;++c)s=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=v^p&(g^v),a=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|l&(u^h),n=m+s+o+Rs[c]+e[c],i=a+f,m=v,v=g,g=p,p=d+n>>>0,d=l,l=h,h=u,u=n+i>>>0;t.h0=t.h0+u|0,t.h1=t.h1+h|0,t.h2=t.h2+l|0,t.h3=t.h3+d|0,t.h4=t.h4+p|0,t.h5=t.h5+g|0,t.h6=t.h6+v|0,t.h7=t.h7+m|0,w-=64}}});var Ls=F((Vd,Ns)=>{var Xt=X();ht();var sn=null;Xt.util.isNodejs&&!Xt.options.usePureJavaScript&&!process.versions["node-webkit"]&&(sn=Xe());var Jc=Ns.exports=Xt.prng=Xt.prng||{};Jc.create=function(t){for(var e={plugin:t,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=t.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();e.pools=n,e.pool=0,e.generate=function(c,u){if(!u)return e.generateSync(c);var h=e.plugin.cipher,l=e.plugin.increment,d=e.plugin.formatKey,p=e.plugin.formatSeed,g=Xt.util.createBuffer();e.key=null,v();function v(m){if(m)return u(m);if(g.length()>=c)return u(null,g.getBytes(c));if(e.generated>1048575&&(e.key=null),e.key===null)return Xt.util.nextTick(function(){a(v)});var w=h(e.key,e.seed);e.generated+=w.length,g.putBytes(w),e.key=d(h(e.key,l(e.seed))),e.seed=p(h(e.key,e.seed)),Xt.util.setImmediate(v)}},e.generateSync=function(c){var u=e.plugin.cipher,h=e.plugin.increment,l=e.plugin.formatKey,d=e.plugin.formatSeed;e.key=null;for(var p=Xt.util.createBuffer();p.length()<c;){e.generated>1048575&&(e.key=null),e.key===null&&s();var g=u(e.key,e.seed);e.generated+=g.length,p.putBytes(g),e.key=l(u(e.key,h(e.seed))),e.seed=d(u(e.key,e.seed))}return p.getBytes(c)};function a(c){if(e.pools[0].messageLength>=32)return o(),c();var u=32-e.pools[0].messageLength<<5;e.seedFile(u,function(h,l){if(h)return c(h);e.collect(l),o(),c()})}function s(){if(e.pools[0].messageLength>=32)return o();var c=32-e.pools[0].messageLength<<5;e.collect(e.seedFileSync(c)),o()}function o(){e.reseeds=e.reseeds===4294967295?0:e.reseeds+1;var c=e.plugin.md.create();c.update(e.keyBytes);for(var u=1,h=0;h<32;++h)e.reseeds%u===0&&(c.update(e.pools[h].digest().getBytes()),e.pools[h].start()),u=u<<1;e.keyBytes=c.digest().getBytes(),c.start(),c.update(e.keyBytes);var l=c.digest().getBytes();e.key=e.plugin.formatKey(e.keyBytes),e.seed=e.plugin.formatSeed(l),e.generated=0}function f(c){var u=null,h=Xt.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(T){return l.getRandomValues(T)});var d=Xt.util.createBuffer();if(u)for(;d.length()<c;){var p=Math.max(1,Math.min(c-d.length(),65536)/4),g=new Uint32Array(Math.floor(p));try{u(g);for(var v=0;v<g.length;++v)d.putInt32(g[v])}catch(T){if(!(typeof QuotaExceededError<"u"&&T instanceof QuotaExceededError))throw T}}if(d.length()<c)for(var m,w,A,N=Math.floor(Math.random()*65536);d.length()<c;){w=16807*(N&65535),m=16807*(N>>16),w+=(m&32767)<<16,w+=m>>15,w=(w&2147483647)+(w>>31),N=w&4294967295;for(var v=0;v<3;++v)A=N>>>(v<<3),A^=Math.floor(Math.random()*256),d.putByte(A&255)}return d.getBytes(c)}return sn?(e.seedFile=function(c,u){sn.randomBytes(c,function(h,l){if(h)return u(h);u(null,l.toString())})},e.seedFileSync=function(c){return sn.randomBytes(c).toString()}):(e.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},e.seedFileSync=f),e.collect=function(c){for(var u=c.length,h=0;h<u;++h)e.pools[e.pool].update(c.substr(h,1)),e.pool=e.pool===31?0:e.pool+1},e.collectInt=function(c,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(c>>l&255);e.collect(h)},e.registerWorker=function(c){if(c===self)e.seedFile=function(h,l){function d(p){var g=p.data;g.forge&&g.forge.prng&&(self.removeEventListener("message",d),l(g.forge.prng.err,g.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&e.seedFile(l.forge.prng.needed,function(d,p){c.postMessage({forge:{prng:{err:d,bytes:p}}})})};c.addEventListener("message",u)}},e}});var Br=F((qd,Ai)=>{var vt=X();Yr();Ds();Ls();ht();(function(){if(vt.random&&vt.random.getBytes){Ai.exports=vt.random;return}(function(t){var e={},r=new Array(4),n=vt.util.createBuffer();e.formatKey=function(h){var l=vt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),vt.aes._expandKey(h,!1)},e.formatSeed=function(h){var l=vt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},e.cipher=function(h,l){return vt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},e.increment=function(h){return++h[3],h},e.md=vt.md.sha256;function i(){var h=vt.prng.create(e);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var a=i(),s=null,o=vt.util.globalScope,f=o.crypto||o.msCrypto;if(f&&f.getRandomValues&&(s=function(h){return f.getRandomValues(h)}),vt.options.usePureJavaScript||!vt.util.isNodejs&&!s){if(typeof window>"u"||window.document,a.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}a.collect(c),c=null}t&&(t().mousemove(function(h){a.collectInt(h.clientX,16),a.collectInt(h.clientY,16)}),t().keypress(function(h){a.collectInt(h.charCode,8)}))}if(!vt.random)vt.random=a;else for(var u in a)vt.random[u]=a[u];vt.random.createInstance=i,Ai.exports=vt.random})(typeof jQuery<"u"?jQuery:null)})()});var Fs=F((zd,Us)=>{var Tt=X();ht();var Ci=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],Ps=[1,2,3,5],jc=function(t,e){return t<<e&65535|(t&65535)>>16-e},tu=function(t,e){return(t&65535)>>e|t<<16-e&65535};Us.exports=Tt.rc2=Tt.rc2||{};Tt.rc2.expandKey=function(t,e){typeof t=="string"&&(t=Tt.util.createBuffer(t)),e=e||128;var r=t,n=t.length(),i=e,a=Math.ceil(i/8),s=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(Ci[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-a,Ci[r.at(128-a)&s]),o=127-a;o>=0;o--)r.setAt(o,Ci[r.at(o+1)^r.at(o+a)]);return r};var Ks=function(t,e,r){var n=!1,i=null,a=null,s=null,o,f,c,u,h=[];for(t=Tt.rc2.expandKey(t,e),c=0;c<64;c++)h.push(t.getInt16Le());r?(o=function(p){for(c=0;c<4;c++)p[c]+=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),p[c]=jc(p[c],Ps[c]),u++},f=function(p){for(c=0;c<4;c++)p[c]+=h[p[(c+3)%4]&63]}):(o=function(p){for(c=3;c>=0;c--)p[c]=tu(p[c],Ps[c]),p[c]-=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),u--},f=function(p){for(c=3;c>=0;c--)p[c]-=h[p[(c+3)%4]&63]});var l=function(p){var g=[];for(c=0;c<4;c++){var v=i.getInt16Le();s!==null&&(r?v^=s.getInt16Le():s.putInt16Le(v)),g.push(v&65535)}u=r?0:63;for(var m=0;m<p.length;m++)for(var w=0;w<p[m][0];w++)p[m][1](g);for(c=0;c<4;c++)s!==null&&(r?s.putInt16Le(g[c]):g[c]^=s.getInt16Le()),a.putInt16Le(g[c])},d=null;return d={start:function(p,g){p&&typeof p=="string"&&(p=Tt.util.createBuffer(p)),n=!1,i=Tt.util.createBuffer(),a=g||new Tt.util.createBuffer,s=p,d.output=a},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,o],[1,f],[6,o],[1,f],[5,o]])},finish:function(p){var g=!0;if(r)if(p)g=p(8,i,!r);else{var v=i.length()===8?8:8-i.length();i.fillWithByte(v,v)}if(g&&(n=!0,d.update()),!r&&(g=i.length()===0,g))if(p)g=p(8,a,!r);else{var m=a.length(),w=a.at(m-1);w>m?g=!1:a.truncate(w)}return g}},d};Tt.rc2.startEncrypting=function(t,e,r){var n=Tt.rc2.createEncryptionCipher(t,128);return n.start(e,r),n};Tt.rc2.createEncryptionCipher=function(t,e){return Ks(t,e,!0)};Tt.rc2.startDecrypting=function(t,e,r){var n=Tt.rc2.createDecryptionCipher(t,128);return n.start(e,r),n};Tt.rc2.createDecryptionCipher=function(t,e){return Ks(t,e,!1)}});var cn=F((Hd,Ws)=>{var Ti=X();Ws.exports=Ti.jsbn=Ti.jsbn||{};var ue,eu=0xdeadbeefcafe,Os=(eu&16777215)==15715070;function S(t,e,r){this.data=[],t!=null&&(typeof t=="number"?this.fromNumber(t,e,r):e==null&&typeof t!="string"?this.fromString(t,256):this.fromString(t,e))}Ti.jsbn.BigInteger=S;function G(){return new S(null)}function ru(t,e,r,n,i,a){for(;--a>=0;){var s=e*this.data[t++]+r.data[n]+i;i=Math.floor(s/67108864),r.data[n++]=s&67108863}return i}function nu(t,e,r,n,i,a){for(var s=e&32767,o=e>>15;--a>=0;){var f=this.data[t]&32767,c=this.data[t++]>>15,u=o*f+c*s;f=s*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+o*c+(i>>>30),r.data[n++]=f&1073741823}return i}function Ms(t,e,r,n,i,a){for(var s=e&16383,o=e>>14;--a>=0;){var f=this.data[t]&16383,c=this.data[t++]>>14,u=o*f+c*s;f=s*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+o*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(S.prototype.am=Ms,ue=28):Os&&navigator.appName=="Microsoft Internet Explorer"?(S.prototype.am=nu,ue=30):Os&&navigator.appName!="Netscape"?(S.prototype.am=ru,ue=26):(S.prototype.am=Ms,ue=28);S.prototype.DB=ue;S.prototype.DM=(1<<ue)-1;S.prototype.DV=1<<ue;var Ii=52;S.prototype.FV=Math.pow(2,Ii);S.prototype.F1=Ii-ue;S.prototype.F2=2*ue-Ii;var iu="0123456789abcdefghijklmnopqrstuvwxyz",on=new Array,Je,Lt;Je="0".charCodeAt(0);for(Lt=0;Lt<=9;++Lt)on[Je++]=Lt;Je="a".charCodeAt(0);for(Lt=10;Lt<36;++Lt)on[Je++]=Lt;Je="A".charCodeAt(0);for(Lt=10;Lt<36;++Lt)on[Je++]=Lt;function Vs(t){return iu.charAt(t)}function qs(t,e){var r=on[t.charCodeAt(e)];return r??-1}function au(t){for(var e=this.t-1;e>=0;--e)t.data[e]=this.data[e];t.t=this.t,t.s=this.s}function su(t){this.t=1,this.s=t<0?-1:0,t>0?this.data[0]=t:t<-1?this.data[0]=t+this.DV:this.t=0}function ge(t){var e=G();return e.fromInt(t),e}function ou(t,e){var r;if(e==16)r=4;else if(e==8)r=3;else if(e==256)r=8;else if(e==2)r=1;else if(e==32)r=5;else if(e==4)r=2;else{this.fromRadix(t,e);return}this.t=0,this.s=0;for(var n=t.length,i=!1,a=0;--n>=0;){var s=r==8?t[n]&255:qs(t,n);if(s<0){t.charAt(n)=="-"&&(i=!0);continue}i=!1,a==0?this.data[this.t++]=s:a+r>this.DB?(this.data[this.t-1]|=(s&(1<<this.DB-a)-1)<<a,this.data[this.t++]=s>>this.DB-a):this.data[this.t-1]|=s<<a,a+=r,a>=this.DB&&(a-=this.DB)}r==8&&t[0]&128&&(this.s=-1,a>0&&(this.data[this.t-1]|=(1<<this.DB-a)-1<<a)),this.clamp(),i&&S.ZERO.subTo(this,this)}function fu(){for(var t=this.s&this.DM;this.t>0&&this.data[this.t-1]==t;)--this.t}function cu(t){if(this.s<0)return"-"+this.negate().toString(t);var e;if(t==16)e=4;else if(t==8)e=3;else if(t==2)e=1;else if(t==32)e=5;else if(t==4)e=2;else return this.toRadix(t);var r=(1<<e)-1,n,i=!1,a="",s=this.t,o=this.DB-s*this.DB%e;if(s-- >0)for(o<this.DB&&(n=this.data[s]>>o)>0&&(i=!0,a=Vs(n));s>=0;)o<e?(n=(this.data[s]&(1<<o)-1)<<e-o,n|=this.data[--s]>>(o+=this.DB-e)):(n=this.data[s]>>(o-=e)&r,o<=0&&(o+=this.DB,--s)),n>0&&(i=!0),i&&(a+=Vs(n));return i?a:"0"}function uu(){var t=G();return S.ZERO.subTo(this,t),t}function hu(){return this.s<0?this.negate():this}function lu(t){var e=this.s-t.s;if(e!=0)return e;var r=this.t;if(e=r-t.t,e!=0)return this.s<0?-e:e;for(;--r>=0;)if((e=this.data[r]-t.data[r])!=0)return e;return 0}function fn(t){var e=1,r;return(r=t>>>16)!=0&&(t=r,e+=16),(r=t>>8)!=0&&(t=r,e+=8),(r=t>>4)!=0&&(t=r,e+=4),(r=t>>2)!=0&&(t=r,e+=2),(r=t>>1)!=0&&(t=r,e+=1),e}function pu(){return this.t<=0?0:this.DB*(this.t-1)+fn(this.data[this.t-1]^this.s&this.DM)}function du(t,e){var r;for(r=this.t-1;r>=0;--r)e.data[r+t]=this.data[r];for(r=t-1;r>=0;--r)e.data[r]=0;e.t=this.t+t,e.s=this.s}function yu(t,e){for(var r=t;r<this.t;++r)e.data[r-t]=this.data[r];e.t=Math.max(this.t-t,0),e.s=this.s}function gu(t,e){var r=t%this.DB,n=this.DB-r,i=(1<<n)-1,a=Math.floor(t/this.DB),s=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)e.data[o+a+1]=this.data[o]>>n|s,s=(this.data[o]&i)<<r;for(o=a-1;o>=0;--o)e.data[o]=0;e.data[a]=s,e.t=this.t+a+1,e.s=this.s,e.clamp()}function xu(t,e){e.s=this.s;var r=Math.floor(t/this.DB);if(r>=this.t){e.t=0;return}var n=t%this.DB,i=this.DB-n,a=(1<<n)-1;e.data[0]=this.data[r]>>n;for(var s=r+1;s<this.t;++s)e.data[s-r-1]|=(this.data[s]&a)<<i,e.data[s-r]=this.data[s]>>n;n>0&&(e.data[this.t-r-1]|=(this.s&a)<<i),e.t=this.t-r,e.clamp()}function vu(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]-t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n-=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n-=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n-=t.s}e.s=n<0?-1:0,n<-1?e.data[r++]=this.DV+n:n>0&&(e.data[r++]=n),e.t=r,e.clamp()}function mu(t,e){var r=this.abs(),n=t.abs(),i=r.t;for(e.t=i+n.t;--i>=0;)e.data[i]=0;for(i=0;i<n.t;++i)e.data[i+r.t]=r.am(0,n.data[i],e,i,0,r.t);e.s=0,e.clamp(),this.s!=t.s&&S.ZERO.subTo(e,e)}function bu(t){for(var e=this.abs(),r=t.t=2*e.t;--r>=0;)t.data[r]=0;for(r=0;r<e.t-1;++r){var n=e.am(r,e.data[r],t,2*r,0,1);(t.data[r+e.t]+=e.am(r+1,2*e.data[r],t,2*r+1,n,e.t-r-1))>=e.DV&&(t.data[r+e.t]-=e.DV,t.data[r+e.t+1]=1)}t.t>0&&(t.data[t.t-1]+=e.am(r,e.data[r],t,2*r,0,1)),t.s=0,t.clamp()}function wu(t,e,r){var n=t.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){e?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=G());var a=G(),s=this.s,o=t.s,f=this.DB-fn(n.data[n.t-1]);f>0?(n.lShiftTo(f,a),i.lShiftTo(f,r)):(n.copyTo(a),i.copyTo(r));var c=a.t,u=a.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?a.data[c-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,g=r.t,v=g-c,m=e??G();for(a.dlShiftTo(v,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),S.ONE.dlShiftTo(c,m),m.subTo(a,a);a.t<c;)a.data[a.t++]=0;for(;--v>=0;){var w=r.data[--g]==u?this.DM:Math.floor(r.data[g]*l+(r.data[g-1]+p)*d);if((r.data[g]+=a.am(0,w,r,v,0,c))<w)for(a.dlShiftTo(v,m),r.subTo(m,r);r.data[g]<--w;)r.subTo(m,r)}e!=null&&(r.drShiftTo(c,e),s!=o&&S.ZERO.subTo(e,e)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),s<0&&S.ZERO.subTo(r,r)}}}function Su(t){var e=G();return this.abs().divRemTo(t,null,e),this.s<0&&e.compareTo(S.ZERO)>0&&t.subTo(e,e),e}function ke(t){this.m=t}function Eu(t){return t.s<0||t.compareTo(this.m)>=0?t.mod(this.m):t}function Bu(t){return t}function Au(t){t.divRemTo(this.m,null,t)}function Cu(t,e,r){t.multiplyTo(e,r),this.reduce(r)}function Tu(t,e){t.squareTo(e),this.reduce(e)}ke.prototype.convert=Eu;ke.prototype.revert=Bu;ke.prototype.reduce=Au;ke.prototype.mulTo=Cu;ke.prototype.sqrTo=Tu;function Iu(){if(this.t<1)return 0;var t=this.data[0];if(!(t&1))return 0;var e=t&3;return e=e*(2-(t&15)*e)&15,e=e*(2-(t&255)*e)&255,e=e*(2-((t&65535)*e&65535))&65535,e=e*(2-t*e%this.DV)%this.DV,e>0?this.DV-e:-e}function De(t){this.m=t,this.mp=t.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<t.DB-15)-1,this.mt2=2*t.t}function _u(t){var e=G();return t.abs().dlShiftTo(this.m.t,e),e.divRemTo(this.m,null,e),t.s<0&&e.compareTo(S.ZERO)>0&&this.m.subTo(e,e),e}function Ru(t){var e=G();return t.copyTo(e),this.reduce(e),e}function ku(t){for(;t.t<=this.mt2;)t.data[t.t++]=0;for(var e=0;e<this.m.t;++e){var r=t.data[e]&32767,n=r*this.mpl+((r*this.mph+(t.data[e]>>15)*this.mpl&this.um)<<15)&t.DM;for(r=e+this.m.t,t.data[r]+=this.m.am(0,n,t,e,0,this.m.t);t.data[r]>=t.DV;)t.data[r]-=t.DV,t.data[++r]++}t.clamp(),t.drShiftTo(this.m.t,t),t.compareTo(this.m)>=0&&t.subTo(this.m,t)}function Du(t,e){t.squareTo(e),this.reduce(e)}function Nu(t,e,r){t.multiplyTo(e,r),this.reduce(r)}De.prototype.convert=_u;De.prototype.revert=Ru;De.prototype.reduce=ku;De.prototype.mulTo=Nu;De.prototype.sqrTo=Du;function Lu(){return(this.t>0?this.data[0]&1:this.s)==0}function Pu(t,e){if(t>4294967295||t<1)return S.ONE;var r=G(),n=G(),i=e.convert(this),a=fn(t)-1;for(i.copyTo(r);--a>=0;)if(e.sqrTo(r,n),(t&1<<a)>0)e.mulTo(n,i,r);else{var s=r;r=n,n=s}return e.revert(r)}function Ku(t,e){var r;return t<256||e.isEven()?r=new ke(e):r=new De(e),this.exp(t,r)}S.prototype.copyTo=au;S.prototype.fromInt=su;S.prototype.fromString=ou;S.prototype.clamp=fu;S.prototype.dlShiftTo=du;S.prototype.drShiftTo=yu;S.prototype.lShiftTo=gu;S.prototype.rShiftTo=xu;S.prototype.subTo=vu;S.prototype.multiplyTo=mu;S.prototype.squareTo=bu;S.prototype.divRemTo=wu;S.prototype.invDigit=Iu;S.prototype.isEven=Lu;S.prototype.exp=Pu;S.prototype.toString=cu;S.prototype.negate=uu;S.prototype.abs=hu;S.prototype.compareTo=lu;S.prototype.bitLength=pu;S.prototype.mod=Su;S.prototype.modPowInt=Ku;S.ZERO=ge(0);S.ONE=ge(1);function Uu(){var t=G();return this.copyTo(t),t}function Fu(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function Ou(){return this.t==0?this.s:this.data[0]<<24>>24}function Mu(){return this.t==0?this.s:this.data[0]<<16>>16}function Vu(t){return Math.floor(Math.LN2*this.DB/Math.log(t))}function qu(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function zu(t){if(t==null&&(t=10),this.signum()==0||t<2||t>36)return"0";var e=this.chunkSize(t),r=Math.pow(t,e),n=ge(r),i=G(),a=G(),s="";for(this.divRemTo(n,i,a);i.signum()>0;)s=(r+a.intValue()).toString(t).substr(1)+s,i.divRemTo(n,i,a);return a.intValue().toString(t)+s}function Hu(t,e){this.fromInt(0),e==null&&(e=10);for(var r=this.chunkSize(e),n=Math.pow(e,r),i=!1,a=0,s=0,o=0;o<t.length;++o){var f=qs(t,o);if(f<0){t.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}s=e*s+f,++a>=r&&(this.dMultiply(n),this.dAddOffset(s,0),a=0,s=0)}a>0&&(this.dMultiply(Math.pow(e,a)),this.dAddOffset(s,0)),i&&S.ZERO.subTo(this,this)}function Gu(t,e,r){if(typeof e=="number")if(t<2)this.fromInt(1);else for(this.fromNumber(t,r),this.testBit(t-1)||this.bitwiseTo(S.ONE.shiftLeft(t-1),_i,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(e);)this.dAddOffset(2,0),this.bitLength()>t&&this.subTo(S.ONE.shiftLeft(t-1),this);else{var n=new Array,i=t&7;n.length=(t>>3)+1,e.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Wu(){var t=this.t,e=new Array;e[0]=this.s;var r=this.DB-t*this.DB%8,n,i=0;if(t-- >0)for(r<this.DB&&(n=this.data[t]>>r)!=(this.s&this.DM)>>r&&(e[i++]=n|this.s<<this.DB-r);t>=0;)r<8?(n=(this.data[t]&(1<<r)-1)<<8-r,n|=this.data[--t]>>(r+=this.DB-8)):(n=this.data[t]>>(r-=8)&255,r<=0&&(r+=this.DB,--t)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(e[i++]=n);return e}function Zu(t){return this.compareTo(t)==0}function Yu(t){return this.compareTo(t)<0?this:t}function $u(t){return this.compareTo(t)>0?this:t}function Qu(t,e,r){var n,i,a=Math.min(t.t,this.t);for(n=0;n<a;++n)r.data[n]=e(this.data[n],t.data[n]);if(t.t<this.t){for(i=t.s&this.DM,n=a;n<this.t;++n)r.data[n]=e(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=a;n<t.t;++n)r.data[n]=e(i,t.data[n]);r.t=t.t}r.s=e(this.s,t.s),r.clamp()}function Xu(t,e){return t&e}function Ju(t){var e=G();return this.bitwiseTo(t,Xu,e),e}function _i(t,e){return t|e}function ju(t){var e=G();return this.bitwiseTo(t,_i,e),e}function zs(t,e){return t^e}function th(t){var e=G();return this.bitwiseTo(t,zs,e),e}function Hs(t,e){return t&~e}function eh(t){var e=G();return this.bitwiseTo(t,Hs,e),e}function rh(){for(var t=G(),e=0;e<this.t;++e)t.data[e]=this.DM&~this.data[e];return t.t=this.t,t.s=~this.s,t}function nh(t){var e=G();return t<0?this.rShiftTo(-t,e):this.lShiftTo(t,e),e}function ih(t){var e=G();return t<0?this.lShiftTo(-t,e):this.rShiftTo(t,e),e}function ah(t){if(t==0)return-1;var e=0;return t&65535||(t>>=16,e+=16),t&255||(t>>=8,e+=8),t&15||(t>>=4,e+=4),t&3||(t>>=2,e+=2),t&1||++e,e}function sh(){for(var t=0;t<this.t;++t)if(this.data[t]!=0)return t*this.DB+ah(this.data[t]);return this.s<0?this.t*this.DB:-1}function oh(t){for(var e=0;t!=0;)t&=t-1,++e;return e}function fh(){for(var t=0,e=this.s&this.DM,r=0;r<this.t;++r)t+=oh(this.data[r]^e);return t}function ch(t){var e=Math.floor(t/this.DB);return e>=this.t?this.s!=0:(this.data[e]&1<<t%this.DB)!=0}function uh(t,e){var r=S.ONE.shiftLeft(t);return this.bitwiseTo(r,e,r),r}function hh(t){return this.changeBit(t,_i)}function lh(t){return this.changeBit(t,Hs)}function ph(t){return this.changeBit(t,zs)}function dh(t,e){for(var r=0,n=0,i=Math.min(t.t,this.t);r<i;)n+=this.data[r]+t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;if(t.t<this.t){for(n+=t.s;r<this.t;)n+=this.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<t.t;)n+=t.data[r],e.data[r++]=n&this.DM,n>>=this.DB;n+=t.s}e.s=n<0?-1:0,n>0?e.data[r++]=n:n<-1&&(e.data[r++]=this.DV+n),e.t=r,e.clamp()}function yh(t){var e=G();return this.addTo(t,e),e}function gh(t){var e=G();return this.subTo(t,e),e}function xh(t){var e=G();return this.multiplyTo(t,e),e}function vh(t){var e=G();return this.divRemTo(t,e,null),e}function mh(t){var e=G();return this.divRemTo(t,null,e),e}function bh(t){var e=G(),r=G();return this.divRemTo(t,e,r),new Array(e,r)}function wh(t){this.data[this.t]=this.am(0,t-1,this,0,0,this.t),++this.t,this.clamp()}function Sh(t,e){if(t!=0){for(;this.t<=e;)this.data[this.t++]=0;for(this.data[e]+=t;this.data[e]>=this.DV;)this.data[e]-=this.DV,++e>=this.t&&(this.data[this.t++]=0),++this.data[e]}}function Ar(){}function Gs(t){return t}function Eh(t,e,r){t.multiplyTo(e,r)}function Bh(t,e){t.squareTo(e)}Ar.prototype.convert=Gs;Ar.prototype.revert=Gs;Ar.prototype.mulTo=Eh;Ar.prototype.sqrTo=Bh;function Ah(t){return this.exp(t,new Ar)}function Ch(t,e,r){var n=Math.min(this.t+t.t,e);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,t.data[n],r,n,0,this.t);for(i=Math.min(t.t,e);n<i;++n)this.am(0,t.data[n],r,n,0,e-n);r.clamp()}function Th(t,e,r){--e;var n=r.t=this.t+t.t-e;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(e-this.t,0);n<t.t;++n)r.data[this.t+n-e]=this.am(e-n,t.data[n],r,0,0,this.t+n-e);r.clamp(),r.drShiftTo(1,r)}function je(t){this.r2=G(),this.q3=G(),S.ONE.dlShiftTo(2*t.t,this.r2),this.mu=this.r2.divide(t),this.m=t}function Ih(t){if(t.s<0||t.t>2*this.m.t)return t.mod(this.m);if(t.compareTo(this.m)<0)return t;var e=G();return t.copyTo(e),this.reduce(e),e}function _h(t){return t}function Rh(t){for(t.drShiftTo(this.m.t-1,this.r2),t.t>this.m.t+1&&(t.t=this.m.t+1,t.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);t.compareTo(this.r2)<0;)t.dAddOffset(1,this.m.t+1);for(t.subTo(this.r2,t);t.compareTo(this.m)>=0;)t.subTo(this.m,t)}function kh(t,e){t.squareTo(e),this.reduce(e)}function Dh(t,e,r){t.multiplyTo(e,r),this.reduce(r)}je.prototype.convert=Ih;je.prototype.revert=_h;je.prototype.reduce=Rh;je.prototype.mulTo=Dh;je.prototype.sqrTo=kh;function Nh(t,e){var r=t.bitLength(),n,i=ge(1),a;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?a=new ke(e):e.isEven()?a=new je(e):a=new De(e);var s=new Array,o=3,f=n-1,c=(1<<n)-1;if(s[1]=a.convert(this),n>1){var u=G();for(a.sqrTo(s[1],u);o<=c;)s[o]=G(),a.mulTo(u,s[o-2],s[o]),o+=2}var h=t.t-1,l,d=!0,p=G(),g;for(r=fn(t.data[h])-1;h>=0;){for(r>=f?l=t.data[h]>>r-f&c:(l=(t.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=t.data[h-1]>>this.DB+r-f)),o=n;!(l&1);)l>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),d)s[l].copyTo(i),d=!1;else{for(;o>1;)a.sqrTo(i,p),a.sqrTo(p,i),o-=2;o>0?a.sqrTo(i,p):(g=i,i=p,p=g),a.mulTo(p,s[l],i)}for(;h>=0&&!(t.data[h]&1<<r);)a.sqrTo(i,p),g=i,i=p,p=g,--r<0&&(r=this.DB-1,--h)}return a.revert(i)}function Lh(t){var e=this.s<0?this.negate():this.clone(),r=t.s<0?t.negate():t.clone();if(e.compareTo(r)<0){var n=e;e=r,r=n}var i=e.getLowestSetBit(),a=r.getLowestSetBit();if(a<0)return e;for(i<a&&(a=i),a>0&&(e.rShiftTo(a,e),r.rShiftTo(a,r));e.signum()>0;)(i=e.getLowestSetBit())>0&&e.rShiftTo(i,e),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),e.compareTo(r)>=0?(e.subTo(r,e),e.rShiftTo(1,e)):(r.subTo(e,r),r.rShiftTo(1,r));return a>0&&r.lShiftTo(a,r),r}function Ph(t){if(t<=0)return 0;var e=this.DV%t,r=this.s<0?t-1:0;if(this.t>0)if(e==0)r=this.data[0]%t;else for(var n=this.t-1;n>=0;--n)r=(e*r+this.data[n])%t;return r}function Kh(t){var e=t.isEven();if(this.isEven()&&e||t.signum()==0)return S.ZERO;for(var r=t.clone(),n=this.clone(),i=ge(1),a=ge(0),s=ge(0),o=ge(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),e?((!i.isEven()||!a.isEven())&&(i.addTo(this,i),a.subTo(t,a)),i.rShiftTo(1,i)):a.isEven()||a.subTo(t,a),a.rShiftTo(1,a);for(;n.isEven();)n.rShiftTo(1,n),e?((!s.isEven()||!o.isEven())&&(s.addTo(this,s),o.subTo(t,o)),s.rShiftTo(1,s)):o.isEven()||o.subTo(t,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),e&&i.subTo(s,i),a.subTo(o,a)):(n.subTo(r,n),e&&s.subTo(i,s),o.subTo(a,o))}if(n.compareTo(S.ONE)!=0)return S.ZERO;if(o.compareTo(t)>=0)return o.subtract(t);if(o.signum()<0)o.addTo(t,o);else return o;return o.signum()<0?o.add(t):o}var Mt=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],Uh=(1<<26)/Mt[Mt.length-1];function Fh(t){var e,r=this.abs();if(r.t==1&&r.data[0]<=Mt[Mt.length-1]){for(e=0;e<Mt.length;++e)if(r.data[0]==Mt[e])return!0;return!1}if(r.isEven())return!1;for(e=1;e<Mt.length;){for(var n=Mt[e],i=e+1;i<Mt.length&&n<Uh;)n*=Mt[i++];for(n=r.modInt(n);e<i;)if(n%Mt[e++]==0)return!1}return r.millerRabin(t)}function Oh(t){var e=this.subtract(S.ONE),r=e.getLowestSetBit();if(r<=0)return!1;for(var n=e.shiftRight(r),i=Mh(),a,s=0;s<t;++s){do a=new S(this.bitLength(),i);while(a.compareTo(S.ONE)<=0||a.compareTo(e)>=0);var o=a.modPow(n,this);if(o.compareTo(S.ONE)!=0&&o.compareTo(e)!=0){for(var f=1;f++<r&&o.compareTo(e)!=0;)if(o=o.modPowInt(2,this),o.compareTo(S.ONE)==0)return!1;if(o.compareTo(e)!=0)return!1}}return!0}function Mh(){return{nextBytes:function(t){for(var e=0;e<t.length;++e)t[e]=Math.floor(Math.random()*256)}}}S.prototype.chunkSize=Vu;S.prototype.toRadix=zu;S.prototype.fromRadix=Hu;S.prototype.fromNumber=Gu;S.prototype.bitwiseTo=Qu;S.prototype.changeBit=uh;S.prototype.addTo=dh;S.prototype.dMultiply=wh;S.prototype.dAddOffset=Sh;S.prototype.multiplyLowerTo=Ch;S.prototype.multiplyUpperTo=Th;S.prototype.modInt=Ph;S.prototype.millerRabin=Oh;S.prototype.clone=Uu;S.prototype.intValue=Fu;S.prototype.byteValue=Ou;S.prototype.shortValue=Mu;S.prototype.signum=qu;S.prototype.toByteArray=Wu;S.prototype.equals=Zu;S.prototype.min=Yu;S.prototype.max=$u;S.prototype.and=Ju;S.prototype.or=ju;S.prototype.xor=th;S.prototype.andNot=eh;S.prototype.not=rh;S.prototype.shiftLeft=nh;S.prototype.shiftRight=ih;S.prototype.getLowestSetBit=sh;S.prototype.bitCount=fh;S.prototype.testBit=ch;S.prototype.setBit=hh;S.prototype.clearBit=lh;S.prototype.flipBit=ph;S.prototype.add=yh;S.prototype.subtract=gh;S.prototype.multiply=xh;S.prototype.divide=vh;S.prototype.remainder=mh;S.prototype.divideAndRemainder=bh;S.prototype.modPow=Nh;S.prototype.modInverse=Kh;S.prototype.pow=Ah;S.prototype.gcd=Lh;S.prototype.isProbablePrime=Fh});var Xs=F((Gd,Qs)=>{var Jt=X();Re();ht();var Ys=Qs.exports=Jt.sha1=Jt.sha1||{};Jt.md.sha1=Jt.md.algorithms.sha1=Ys;Ys.create=function(){$s||Vh();var t=null,e=Jt.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,a=0;a<i;++a)n.fullMessageLength.push(0);return e=Jt.util.createBuffer(),t={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,a){a==="utf8"&&(i=Jt.util.encodeUtf8(i));var s=i.length;n.messageLength+=s,s=[s/4294967296>>>0,s>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=s[1],s[1]=s[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,s[0]=s[1]/4294967296>>>0;return e.putBytes(i),Zs(t,r,e),(e.read>2048||e.length()===0)&&e.compact(),n},n.digest=function(){var i=Jt.util.createBuffer();i.putBytes(e.bytes());var a=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,s=a&n.blockLength-1;i.putBytes(Ri.substr(0,n.blockLength-s));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:t.h0,h1:t.h1,h2:t.h2,h3:t.h3,h4:t.h4};Zs(h,r,i);var l=Jt.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Ri=null,$s=!1;function Vh(){Ri=String.fromCharCode(128),Ri+=Jt.util.fillString(String.fromCharCode(0),64),$s=!0}function Zs(t,e,r){for(var n,i,a,s,o,f,c,u,h=r.length();h>=64;){for(i=t.h0,a=t.h1,s=t.h2,o=t.h3,f=t.h4,u=0;u<16;++u)n=r.getInt32(),e[u]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<20;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=o^a&(s^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<32;++u)n=e[u-3]^e[u-8]^e[u-14]^e[u-16],n=n<<1|n>>>31,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<40;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<60;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a&s|o&(a^s),n=(i<<5|i>>>27)+c+f+2400959708+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;for(;u<80;++u)n=e[u-6]^e[u-16]^e[u-28]^e[u-32],n=n<<2|n>>>30,e[u]=n,c=a^s^o,n=(i<<5|i>>>27)+c+f+3395469782+n,f=o,o=s,s=(a<<30|a>>>2)>>>0,a=i,i=n;t.h0=t.h0+i|0,t.h1=t.h1+a|0,t.h2=t.h2+s|0,t.h3=t.h3+o|0,t.h4=t.h4+f|0,h-=64}}});var t0=F((Wd,js)=>{var jt=X();ht();Br();Xs();var Js=js.exports=jt.pkcs1=jt.pkcs1||{};Js.encode_rsa_oaep=function(t,e,r){var n,i,a,s;typeof r=="string"?(n=r,i=arguments[3]||void 0,a=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,a=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md)),a?a.start():a=jt.md.sha1.create(),s||(s=a);var o=Math.ceil(t.n.bitLength()/8),f=o-2*a.digestLength-2;if(e.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=e.length,c.maxLength=f,c}n||(n=""),a.update(n,"raw");for(var u=a.digest(),h="",l=f-e.length,d=0;d<l;d++)h+="\0";var p=u.getBytes()+h+""+e;if(!i)i=jt.random.getBytes(a.digestLength);else if(i.length!==a.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=a.digestLength,c}var g=un(i,o-a.digestLength-1,s),v=jt.util.xorBytes(p,g,p.length),m=un(v,a.digestLength,s),w=jt.util.xorBytes(i,m,i.length);return"\0"+w+v};Js.decode_rsa_oaep=function(t,e,r){var n,i,a;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md));var s=Math.ceil(t.n.bitLength()/8);if(e.length!==s){var v=new Error("RSAES-OAEP encoded message length is invalid.");throw v.length=e.length,v.expectedLength=s,v}if(i===void 0?i=jt.md.sha1.create():i.start(),a||(a=i),s<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),f=e.charAt(0),c=e.substring(1,i.digestLength+1),u=e.substring(1+i.digestLength),h=un(u,i.digestLength,a),l=jt.util.xorBytes(c,h,c.length),d=un(l,s-i.digestLength-1,a),p=jt.util.xorBytes(u,d,u.length),g=p.substring(0,i.digestLength),v=f!=="\0",m=0;m<i.digestLength;++m)v|=o.charAt(m)!==g.charAt(m);for(var w=1,A=i.digestLength,N=i.digestLength;N<p.length;N++){var T=p.charCodeAt(N),_=T&1^1,V=w?65534:0;v|=T&V,w=w&_,A+=w}if(v||p.charCodeAt(A)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(A+1)};function un(t,e,r){r||(r=jt.md.sha1.create());for(var n="",i=Math.ceil(e/r.digestLength),a=0;a<i;++a){var s=String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255);r.start(),r.update(t+s),n+=r.digest().getBytes()}return n.substring(0,e)}});var e0=F((Zd,ki)=>{var xe=X();ht();cn();Br();(function(){if(xe.prime){ki.exports=xe.prime;return}var t=ki.exports=xe.prime=xe.prime||{},e=xe.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new e(null);n.fromInt(30);var i=function(h,l){return h|l};t.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var g=l.prng||xe.random,v={nextBytes:function(m){for(var w=g.getBytesSync(m.length),A=0;A<m.length;++A)m[A]=w.charCodeAt(A)}};if(p.name==="PRIMEINC")return a(h,v,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function a(h,l,d,p){return"workers"in d?f(h,l,d,p):s(h,l,d,p)}function s(h,l,d,p){var g=c(h,l),v=0,m=u(g.bitLength());"millerRabinTests"in d&&(m=d.millerRabinTests);var w=10;"maxBlockTime"in d&&(w=d.maxBlockTime),o(g,h,l,v,m,w,p)}function o(h,l,d,p,g,v,m){var w=+new Date;do{if(h.bitLength()>l&&(h=c(l,d)),h.isProbablePrime(g))return m(null,h);h.dAddOffset(r[p++%8],0)}while(v<0||+new Date-w<v);xe.util.setImmediate(function(){o(h,l,d,p,g,v,m)})}function f(h,l,d,p){if(typeof Worker>"u")return s(h,l,d,p);var g=c(h,l),v=d.workers,m=d.workLoad||100,w=m*30/8,A=d.workerScript||"forge/prime.worker.js";if(v===-1)return xe.util.estimateCores(function(T,_){T&&(_=2),v=_-1,N()});N();function N(){v=Math.max(1,v);for(var T=[],_=0;_<v;++_)T[_]=new Worker(A);for(var V=v,_=0;_<v;++_)T[_].addEventListener("message",wt);var Y=!1;function wt(Ft){if(!Y){--V;var _t=Ft.data;if(_t.found){for(var Et=0;Et<T.length;++Et)T[Et].terminate();return Y=!0,p(null,new e(_t.prime,16))}g.bitLength()>h&&(g=c(h,l));var qe=g.toString(16);Ft.target.postMessage({hex:qe,workLoad:m}),g.dAddOffset(w,0)}}}}function c(h,l){var d=new e(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(e.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var ln=F((Yd,f0)=>{var D=X();Er();cn();jr();t0();e0();Br();ht();typeof q>"u"&&(q=D.jsbn.BigInteger);var q,Di=D.util.isNodejs?Xe():null,x=D.asn1,Pt=D.util;D.pki=D.pki||{};f0.exports=D.pki.rsa=D.rsa=D.rsa||{};var P=D.pki,qh=[6,4,2,4,2,4,6,2],zh={name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Hh={name:"RSAPrivateKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Gh={name:"RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:x.Class.UNIVERSAL,type:x.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},Wh=D.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Zh={name:"DigestInfo",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:x.Class.UNIVERSAL,type:x.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:x.Class.UNIVERSAL,type:x.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:x.Class.UNIVERSAL,type:x.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:x.Class.UNIVERSAL,type:x.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},Yh=function(t){var e;if(t.algorithm in P.oids)e=P.oids[t.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=t.algorithm,r}var n=x.oidToDer(e).getBytes(),i=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]),a=x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[]);a.value.push(x.create(x.Class.UNIVERSAL,x.Type.OID,!1,n)),a.value.push(x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,""));var s=x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,t.digest().getBytes());return i.value.push(a),i.value.push(s),x.toDer(i).getBytes()},s0=function(t,e,r){if(r)return t.modPow(e.e,e.n);if(!e.p||!e.q)return t.modPow(e.d,e.n);e.dP||(e.dP=e.d.mod(e.p.subtract(q.ONE))),e.dQ||(e.dQ=e.d.mod(e.q.subtract(q.ONE))),e.qInv||(e.qInv=e.q.modInverse(e.p));var n;do n=new q(D.util.bytesToHex(D.random.getBytes(e.n.bitLength()/8)),16);while(n.compareTo(e.n)>=0||!n.gcd(e.n).equals(q.ONE));t=t.multiply(n.modPow(e.e,e.n)).mod(e.n);for(var i=t.mod(e.p).modPow(e.dP,e.p),a=t.mod(e.q).modPow(e.dQ,e.q);i.compareTo(a)<0;)i=i.add(e.p);var s=i.subtract(a).multiply(e.qInv).mod(e.p).multiply(e.q).add(a);return s=s.multiply(n.modInverse(e.n)).mod(e.n),s};P.rsa.encrypt=function(t,e,r){var n=r,i,a=Math.ceil(e.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=o0(t,e,r)):(i=D.util.createBuffer(),i.putBytes(t));for(var s=new q(i.toHex(),16),o=s0(s,e,n),f=o.toString(16),c=D.util.createBuffer(),u=a-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(D.util.hexToBytes(f)),c.getBytes()};P.rsa.decrypt=function(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8);if(t.length!==i){var a=new Error("Encrypted message length is invalid.");throw a.length=t.length,a.expected=i,a}var s=new q(D.util.createBuffer(t).toHex(),16);if(s.compareTo(e.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=s0(s,e,r),f=o.toString(16),c=D.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(D.util.hexToBytes(f)),n!==!1?hn(c.getBytes(),e,r):c.getBytes()};P.rsa.createKeyPairGenerationState=function(t,e,r){typeof t=="string"&&(t=parseInt(t,10)),t=t||2048,r=r||{};var n=r.prng||D.random,i={nextBytes:function(o){for(var f=n.getBytesSync(o.length),c=0;c<o.length;++c)o[c]=f.charCodeAt(c)}},a=r.algorithm||"PRIMEINC",s;if(a==="PRIMEINC")s={algorithm:a,state:0,bits:t,rng:i,eInt:e||65537,e:new q(null),p:null,q:null,qBits:t>>1,pBits:t-(t>>1),pqState:0,num:null,keys:null},s.e.fromInt(s.eInt);else throw new Error("Invalid key generation algorithm: "+a);return s};P.rsa.stepKeyPairGenerationState=function(t,e){"algorithm"in t||(t.algorithm="PRIMEINC");var r=new q(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},a=+new Date,s,o=0;t.keys===null&&(e<=0||o<e);){if(t.state===0){var f=t.p===null?t.pBits:t.qBits,c=f-1;t.pqState===0?(t.num=new q(f,t.rng),t.num.testBit(c)||t.num.bitwiseTo(q.ONE.shiftLeft(c),i,t.num),t.num.dAddOffset(31-t.num.mod(r).byteValue(),0),n=0,++t.pqState):t.pqState===1?t.num.bitLength()>f?t.pqState=0:t.num.isProbablePrime(Qh(t.num.bitLength()))?++t.pqState:t.num.dAddOffset(qh[n++%8],0):t.pqState===2?t.pqState=t.num.subtract(q.ONE).gcd(t.e).compareTo(q.ONE)===0?3:0:t.pqState===3&&(t.pqState=0,t.p===null?t.p=t.num:t.q=t.num,t.p!==null&&t.q!==null&&++t.state,t.num=null)}else if(t.state===1)t.p.compareTo(t.q)<0&&(t.num=t.p,t.p=t.q,t.q=t.num),++t.state;else if(t.state===2)t.p1=t.p.subtract(q.ONE),t.q1=t.q.subtract(q.ONE),t.phi=t.p1.multiply(t.q1),++t.state;else if(t.state===3)t.phi.gcd(t.e).compareTo(q.ONE)===0?++t.state:(t.p=null,t.q=null,t.state=0);else if(t.state===4)t.n=t.p.multiply(t.q),t.n.bitLength()===t.bits?++t.state:(t.q=null,t.state=0);else if(t.state===5){var u=t.e.modInverse(t.phi);t.keys={privateKey:P.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:P.rsa.setPublicKey(t.n,t.e)}}s=+new Date,o+=s-a,a=s}return t.keys!==null};P.rsa.generateKeyPair=function(t,e,r,n){if(arguments.length===1?typeof t=="object"?(r=t,t=void 0):typeof t=="function"&&(n=t,t=void 0):arguments.length===2?typeof t=="number"?typeof e=="function"?(n=e,e=void 0):typeof e!="number"&&(r=e,e=void 0):(r=t,n=e,t=void 0,e=void 0):arguments.length===3&&(typeof e=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=e,e=void 0)),r=r||{},t===void 0&&(t=r.bits||2048),e===void 0&&(e=r.e||65537),!D.options.usePureJavaScript&&!r.prng&&t>=256&&t<=16384&&(e===65537||e===3)){if(n){if(r0("generateKeyPair"))return Di.generateKeyPair("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,f,c){if(o)return n(o);n(null,{privateKey:P.privateKeyFromPem(c),publicKey:P.publicKeyFromPem(f)})});if(n0("generateKey")&&n0("exportKey"))return Pt.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:a0(e),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return Pt.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var f=P.privateKeyFromAsn1(x.fromDer(D.util.createBuffer(o)));n(null,{privateKey:f,publicKey:P.setRsaPublicKey(f.n,f.e)})}});if(i0("generateKey")&&i0("exportKey")){var i=Pt.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:a0(e),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var f=o.target.result,c=Pt.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,l=P.privateKeyFromAsn1(x.fromDer(D.util.createBuffer(h)));n(null,{privateKey:l,publicKey:P.setRsaPublicKey(l.n,l.e)})},c.onerror=function(u){n(u)}},i.onerror=function(o){n(o)};return}}else if(r0("generateKeyPairSync")){var a=Di.generateKeyPairSync("rsa",{modulusLength:t,publicExponent:e,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:P.privateKeyFromPem(a.privateKey),publicKey:P.publicKeyFromPem(a.publicKey)}}}var s=P.rsa.createKeyPairGenerationState(t,e,r);if(!n)return P.rsa.stepKeyPairGenerationState(s,0),s.keys;$h(s,r,n)};P.setRsaPublicKey=P.rsa.setPublicKey=function(t,e){var r={n:t,e};return r.encrypt=function(n,i,a){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,f,c){return o0(o,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,f){return D.pkcs1.encode_rsa_oaep(f,o,a)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var s=i.encode(n,r,!0);return P.rsa.encrypt(s,r,!0)},r.verify=function(n,i,a,s){typeof a=="string"?a=a.toUpperCase():a===void 0&&(a="RSASSA-PKCS1-V1_5"),s===void 0&&(s={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in s||(s._parseAllDigestBytes=!0),a==="RSASSA-PKCS1-V1_5"?a={verify:function(f,c){c=hn(c,r,!0);var u=x.fromDer(c,{parseAllBytes:s._parseAllDigestBytes}),h={},l=[];if(!x.validate(u,Zh,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=x.derToOid(h.algorithmIdentifier);if(!(p===D.oids.md2||p===D.oids.md5||p===D.oids.sha1||p===D.oids.sha224||p===D.oids.sha256||p===D.oids.sha384||p===D.oids.sha512||p===D.oids["sha512-224"]||p===D.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===D.oids.md2||p===D.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(a==="NONE"||a==="NULL"||a===null)&&(a={verify:function(f,c){return c=hn(c,r,!0),f===c}});var o=P.rsa.decrypt(i,r,!0,!1);return a.verify(n,o,r.n.bitLength())},r};P.setRsaPrivateKey=P.rsa.setPrivateKey=function(t,e,r,n,i,a,s,o){var f={n:t,e,d:r,p:n,q:i,dP:a,dQ:s,qInv:o};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=P.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:hn};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(d,p){return D.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:Yh},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var l=u.encode(c,f.n.bitLength());return P.rsa.encrypt(l,f,h)},f};P.wrapRsaPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(P.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.OCTETSTRING,!1,x.toDer(t).getBytes())])};P.privateKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,zh,e,r)&&(t=x.fromDer(D.util.createBuffer(e.privateKey))),e={},r=[],!x.validate(t,Hh,e,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,a,s,o,f,c,u,h;return i=D.util.createBuffer(e.privateKeyModulus).toHex(),a=D.util.createBuffer(e.privateKeyPublicExponent).toHex(),s=D.util.createBuffer(e.privateKeyPrivateExponent).toHex(),o=D.util.createBuffer(e.privateKeyPrime1).toHex(),f=D.util.createBuffer(e.privateKeyPrime2).toHex(),c=D.util.createBuffer(e.privateKeyExponent1).toHex(),u=D.util.createBuffer(e.privateKeyExponent2).toHex(),h=D.util.createBuffer(e.privateKeyCoefficient).toHex(),P.setRsaPrivateKey(new q(i,16),new q(a,16),new q(s,16),new q(o,16),new q(f,16),new q(c,16),new q(u,16),new q(h,16))};P.privateKeyToAsn1=P.privateKeyToRSAPrivateKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,x.integerToDer(0).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,te(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,te(t.e)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,te(t.d)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,te(t.p)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,te(t.q)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,te(t.dP)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,te(t.dQ)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,te(t.qInv))])};P.publicKeyFromAsn1=function(t){var e={},r=[];if(x.validate(t,Wh,e,r)){var n=x.derToOid(e.publicKeyOid);if(n!==P.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}t=e.rsaPublicKey}if(r=[],!x.validate(t,Gh,e,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var a=D.util.createBuffer(e.publicKeyModulus).toHex(),s=D.util.createBuffer(e.publicKeyExponent).toHex();return P.setRsaPublicKey(new q(a,16),new q(s,16))};P.publicKeyToAsn1=P.publicKeyToSubjectPublicKeyInfo=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.OID,!1,x.oidToDer(P.oids.rsaEncryption).getBytes()),x.create(x.Class.UNIVERSAL,x.Type.NULL,!1,"")]),x.create(x.Class.UNIVERSAL,x.Type.BITSTRING,!1,[P.publicKeyToRSAPublicKey(t)])])};P.publicKeyToRSAPublicKey=function(t){return x.create(x.Class.UNIVERSAL,x.Type.SEQUENCE,!0,[x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,te(t.n)),x.create(x.Class.UNIVERSAL,x.Type.INTEGER,!1,te(t.e))])};function o0(t,e,r){var n=D.util.createBuffer(),i=Math.ceil(e.n.bitLength()/8);if(t.length>i-11){var a=new Error("Message is too long for PKCS#1 v1.5 padding.");throw a.length=t.length,a.max=i-11,a}n.putByte(0),n.putByte(r);var s=i-3-t.length,o;if(r===0||r===1){o=r===0?0:255;for(var f=0;f<s;++f)n.putByte(o)}else for(;s>0;){for(var c=0,u=D.random.getBytes(s),f=0;f<s;++f)o=u.charCodeAt(f),o===0?++c:n.putByte(o);s=c}return n.putByte(0),n.putBytes(t),n}function hn(t,e,r,n){var i=Math.ceil(e.n.bitLength()/8),a=D.util.createBuffer(t),s=a.getByte(),o=a.getByte();if(s!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(o===0){f=i-3-n;for(var c=0;c<f;++c)if(a.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(f=0;a.length()>1;){if(a.getByte()!==255){--a.read;break}++f}else if(o===2)for(f=0;a.length()>1;){if(a.getByte()===0){--a.read;break}++f}var u=a.getByte();if(u!==0||f!==i-3-a.length())throw new Error("Encryption block is invalid.");return a.getBytes()}function $h(t,e,r){typeof e=="function"&&(r=e,e={}),e=e||{};var n={algorithm:{name:e.algorithm||"PRIMEINC",options:{workers:e.workers||2,workLoad:e.workLoad||100,workerScript:e.workerScript}}};"prng"in e&&(n.prng=e.prng),i();function i(){a(t.pBits,function(o,f){if(o)return r(o);if(t.p=f,t.q!==null)return s(o,t.q);a(t.qBits,s)})}function a(o,f){D.prime.generateProbablePrime(o,n,f)}function s(o,f){if(o)return r(o);if(t.q=f,t.p.compareTo(t.q)<0){var c=t.p;t.p=t.q,t.q=c}if(t.p.subtract(q.ONE).gcd(t.e).compareTo(q.ONE)!==0){t.p=null,i();return}if(t.q.subtract(q.ONE).gcd(t.e).compareTo(q.ONE)!==0){t.q=null,a(t.qBits,s);return}if(t.p1=t.p.subtract(q.ONE),t.q1=t.q.subtract(q.ONE),t.phi=t.p1.multiply(t.q1),t.phi.gcd(t.e).compareTo(q.ONE)!==0){t.p=t.q=null,i();return}if(t.n=t.p.multiply(t.q),t.n.bitLength()!==t.bits){t.q=null,a(t.qBits,s);return}var u=t.e.modInverse(t.phi);t.keys={privateKey:P.rsa.setPrivateKey(t.n,t.e,u,t.p,t.q,u.mod(t.p1),u.mod(t.q1),t.q.modInverse(t.p)),publicKey:P.rsa.setPublicKey(t.n,t.e)},r(null,t.keys)}}function te(t){var e=t.toString(16);e[0]>="8"&&(e="00"+e);var r=D.util.hexToBytes(e);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Qh(t){return t<=100?27:t<=150?18:t<=200?15:t<=250?12:t<=300?9:t<=350?8:t<=400?7:t<=500?6:t<=600?5:t<=800?4:t<=1250?3:2}function r0(t){return D.util.isNodejs&&typeof Di[t]=="function"}function n0(t){return typeof Pt.globalScope<"u"&&typeof Pt.globalScope.crypto=="object"&&typeof Pt.globalScope.crypto.subtle=="object"&&typeof Pt.globalScope.crypto.subtle[t]=="function"}function i0(t){return typeof Pt.globalScope<"u"&&typeof Pt.globalScope.msCrypto=="object"&&typeof Pt.globalScope.msCrypto.subtle=="object"&&typeof Pt.globalScope.msCrypto.subtle[t]=="function"}function a0(t){for(var e=D.util.hexToBytes(t.toString(16)),r=new Uint8Array(e.length),n=0;n<e.length;++n)r[n]=e.charCodeAt(n);return r}});var d0=F(($d,p0)=>{var I=X();Yr();Er();ms();Re();jr();Ei();Cs();Br();Fs();ln();ht();typeof c0>"u"&&(c0=I.jsbn.BigInteger);var c0,b=I.asn1,K=I.pki=I.pki||{};p0.exports=K.pbe=I.pbe=I.pbe||{};var Ne=K.oids,Xh={name:"EncryptedPrivateKeyInfo",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Jh={name:"PBES2Algorithms",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:b.Class.UNIVERSAL,type:b.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},jh={name:"pkcs-12PbeParams",tagClass:b.Class.UNIVERSAL,type:b.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:b.Class.UNIVERSAL,type:b.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:b.Class.UNIVERSAL,type:b.Type.INTEGER,constructed:!1,capture:"iterations"}]};K.encryptPrivateKeyInfo=function(t,e,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=I.random.getBytesSync(r.saltSize),i=r.count,a=b.integerToDer(i),s,o,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":s=16,c=16,u=Ne["aes128-CBC"],h=I.aes.createEncryptionCipher;break;case"aes192":s=24,c=16,u=Ne["aes192-CBC"],h=I.aes.createEncryptionCipher;break;case"aes256":s=32,c=16,u=Ne["aes256-CBC"],h=I.aes.createEncryptionCipher;break;case"des":s=8,c=8,u=Ne.desCBC,h=I.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=l0(d),g=I.pkcs5.pbkdf2(e,n,i,s,p),v=I.random.getBytesSync(c),m=h(g);m.start(v),m.update(b.toDer(t)),m.finish(),f=m.output.getBytes();var w=tl(n,a,s,d);o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Ne.pkcs5PBES2).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Ne.pkcs5PBKDF2).getBytes()),w]),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(u).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,v)])])])}else if(r.algorithm==="3des"){s=24;var A=new I.util.ByteBuffer(n),g=K.pbe.generatePkcs12Key(e,A,1,i,s),v=K.pbe.generatePkcs12Key(e,A,2,i,s),m=I.des.createEncryptionCipher(g);m.start(v),m.update(b.toDer(t)),m.finish(),f=m.output.getBytes(),o=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(Ne["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,n),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,a.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var N=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[o,b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,f)]);return N};K.decryptPrivateKeyInfo=function(t,e){var r=null,n={},i=[];if(!b.validate(t,Xh,n,i)){var a=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=b.derToOid(n.encryptionOid),o=K.pbe.getCipher(s,n.encryptionParams,e),f=I.util.createBuffer(n.encryptedData);return o.update(f),o.finish()&&(r=b.fromDer(o.output)),r};K.encryptedPrivateKeyToPem=function(t,e){var r={type:"ENCRYPTED PRIVATE KEY",body:b.toDer(t).getBytes()};return I.pem.encode(r,{maxline:e})};K.encryptedPrivateKeyFromPem=function(t){var e=I.pem.decode(t)[0];if(e.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=e.type,r}if(e.procType&&e.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return b.fromDer(e.body)};K.encryptRsaPrivateKey=function(t,e,r){if(r=r||{},!r.legacy){var n=K.wrapRsaPrivateKey(K.privateKeyToAsn1(t));return n=K.encryptPrivateKeyInfo(n,e,r),K.encryptedPrivateKeyToPem(n)}var i,a,s,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",s=16,a=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",s=24,a=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",s=32,a=I.random.getBytesSync(16),o=I.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",s=24,a=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;case"des":i="DES-CBC",s=8,a=I.random.getBytesSync(8),o=I.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=I.pbe.opensslDeriveBytes(e,a.substr(0,8),s),u=o(c);u.start(a),u.update(b.toDer(K.privateKeyToAsn1(t))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:I.util.bytesToHex(a).toUpperCase()},body:u.output.getBytes()};return I.pem.encode(h)};K.decryptRsaPrivateKey=function(t,e){var r=null,n=I.pem.decode(t)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var a,s;switch(n.dekInfo.algorithm){case"DES-CBC":a=8,s=I.des.createDecryptionCipher;break;case"DES-EDE3-CBC":a=24,s=I.des.createDecryptionCipher;break;case"AES-128-CBC":a=16,s=I.aes.createDecryptionCipher;break;case"AES-192-CBC":a=24,s=I.aes.createDecryptionCipher;break;case"AES-256-CBC":a=32,s=I.aes.createDecryptionCipher;break;case"RC2-40-CBC":a=5,s=function(h){return I.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":a=8,s=function(h){return I.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":a=16,s=function(h){return I.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=I.util.hexToBytes(n.dekInfo.parameters),f=I.pbe.opensslDeriveBytes(e,o.substr(0,8),a),c=s(f);if(c.start(o),c.update(I.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=K.decryptPrivateKeyInfo(b.fromDer(r),e):r=b.fromDer(r),r!==null&&(r=K.privateKeyFromAsn1(r)),r};K.pbe.generatePkcs12Key=function(t,e,r,n,i,a){var s,o;if(typeof a>"u"||a===null){if(!("sha1"in I.md))throw new Error('"sha1" hash algorithm unavailable.');a=I.md.sha1.create()}var f=a.digestLength,c=a.blockLength,u=new I.util.ByteBuffer,h=new I.util.ByteBuffer;if(t!=null){for(o=0;o<t.length;o++)h.putInt16(t.charCodeAt(o));h.putInt16(0)}var l=h.length(),d=e.length(),p=new I.util.ByteBuffer;p.fillWithByte(r,c);var g=c*Math.ceil(d/c),v=new I.util.ByteBuffer;for(o=0;o<g;o++)v.putByte(e.at(o%d));var m=c*Math.ceil(l/c),w=new I.util.ByteBuffer;for(o=0;o<m;o++)w.putByte(h.at(o%l));var A=v;A.putBuffer(w);for(var N=Math.ceil(i/f),T=1;T<=N;T++){var _=new I.util.ByteBuffer;_.putBytes(p.bytes()),_.putBytes(A.bytes());for(var V=0;V<n;V++)a.start(),a.update(_.getBytes()),_=a.digest();var Y=new I.util.ByteBuffer;for(o=0;o<c;o++)Y.putByte(_.at(o%f));var wt=Math.ceil(d/c)+Math.ceil(l/c),Ft=new I.util.ByteBuffer;for(s=0;s<wt;s++){var _t=new I.util.ByteBuffer(A.getBytes(c)),Et=511;for(o=Y.length()-1;o>=0;o--)Et=Et>>8,Et+=Y.at(o)+_t.at(o),_t.setAt(o,Et&255);Ft.putBuffer(_t)}A=Ft,u.putBuffer(_)}return u.truncate(u.length()-i),u};K.pbe.getCipher=function(t,e,r){switch(t){case K.oids.pkcs5PBES2:return K.pbe.getCipherForPBES2(t,e,r);case K.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case K.oids["pbewithSHAAnd40BitRC2-CBC"]:return K.pbe.getCipherForPKCS12PBE(t,e,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=t,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};K.pbe.getCipherForPBES2=function(t,e,r){var n={},i=[];if(!b.validate(e,Jh,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}if(t=b.derToOid(n.kdfOid),t!==K.oids.pkcs5PBKDF2){var a=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw a.oid=t,a.supportedOids=["pkcs5PBKDF2"],a}if(t=b.derToOid(n.encOid),t!==K.oids["aes128-CBC"]&&t!==K.oids["aes192-CBC"]&&t!==K.oids["aes256-CBC"]&&t!==K.oids["des-EDE3-CBC"]&&t!==K.oids.desCBC){var a=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw a.oid=t,a.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],a}var s=n.kdfSalt,o=I.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var f,c;switch(K.oids[t]){case"aes128-CBC":f=16,c=I.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=I.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=I.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=I.des.createDecryptionCipher;break;case"desCBC":f=8,c=I.des.createDecryptionCipher;break}var u=h0(n.prfOid),h=I.pkcs5.pbkdf2(r,s,o,f,u),l=n.encIv,d=c(h);return d.start(l),d};K.pbe.getCipherForPKCS12PBE=function(t,e,r){var n={},i=[];if(!b.validate(e,jh,n,i)){var a=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw a.errors=i,a}var s=I.util.createBuffer(n.salt),o=I.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var f,c,u;switch(t){case K.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=I.des.startDecrypting;break;case K.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(g,v){var m=I.rc2.createDecryptionCipher(g,40);return m.start(v,null),m};break;default:var a=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw a.oid=t,a}var h=h0(n.prfOid),l=K.pbe.generatePkcs12Key(r,s,1,o,f,h);h.start();var d=K.pbe.generatePkcs12Key(r,s,2,o,c,h);return u(l,d)};K.pbe.opensslDeriveBytes=function(t,e,r,n){if(typeof n>"u"||n===null){if(!("md5"in I.md))throw new Error('"md5" hash algorithm unavailable.');n=I.md.md5.create()}e===null&&(e="");for(var i=[u0(n,t+e)],a=16,s=1;a<r;++s,a+=16)i.push(u0(n,i[s-1]+t+e));return i.join("").substr(0,r)};function u0(t,e){return t.start().update(e).digest().getBytes()}function h0(t){var e;if(!t)e="hmacWithSHA1";else if(e=K.oids[b.derToOid(t)],!e){var r=new Error("Unsupported PRF OID.");throw r.oid=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return l0(e)}function l0(t){var e=I.md;switch(t){case"hmacWithSHA224":e=I.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":t=t.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=t,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!e||!(t in e))throw new Error("Unknown hash algorithm: "+t);return e[t].create()}function tl(t,e,r,n){var i=b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OCTETSTRING,!1,t),b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,e.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(b.create(b.Class.UNIVERSAL,b.Type.INTEGER,!1,I.util.hexToBytes(r.toString(16))),b.create(b.Class.UNIVERSAL,b.Type.SEQUENCE,!0,[b.create(b.Class.UNIVERSAL,b.Type.OID,!1,b.oidToDer(K.oids[n]).getBytes()),b.create(b.Class.UNIVERSAL,b.Type.NULL,!1,"")])),i}});var k0=F((sy,R0)=>{"use strict";R0.exports=ml;function ml(t,e){for(var r=new Array(arguments.length-1),n=0,i=2,a=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(o,f){r[n]=function(u){if(a)if(a=!1,u)f(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];o.apply(null,h)}};try{t.apply(e||null,r)}catch(c){a&&(a=!1,f(c))}})}});var P0=F(L0=>{"use strict";var mn=L0;mn.length=function(e){var r=e.length;if(!r)return 0;for(var n=0;--r%4>1&&e.charAt(r)==="=";)++n;return Math.ceil(e.length*3)/4-n};var rr=new Array(64),N0=new Array(123);for(qt=0;qt<64;)N0[rr[qt]=qt<26?qt+65:qt<52?qt+71:qt<62?qt-4:qt-59|43]=qt++;var qt;mn.encode=function(e,r,n){for(var i=null,a=[],s=0,o=0,f;r<n;){var c=e[r++];switch(o){case 0:a[s++]=rr[c>>2],f=(c&3)<<4,o=1;break;case 1:a[s++]=rr[f|c>>4],f=(c&15)<<2,o=2;break;case 2:a[s++]=rr[f|c>>6],a[s++]=rr[c&63],o=0;break}s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,a)),s=0)}return o&&(a[s++]=rr[f],a[s++]=61,o===1&&(a[s++]=61)),i?(s&&i.push(String.fromCharCode.apply(String,a.slice(0,s))),i.join("")):String.fromCharCode.apply(String,a.slice(0,s))};var D0="invalid encoding";mn.decode=function(e,r,n){for(var i=n,a=0,s,o=0;o<e.length;){var f=e.charCodeAt(o++);if(f===61&&a>1)break;if((f=N0[f])===void 0)throw Error(D0);switch(a){case 0:s=f,a=1;break;case 1:r[n++]=s<<2|(f&48)>>4,s=f,a=2;break;case 2:r[n++]=(s&15)<<4|(f&60)>>2,s=f,a=3;break;case 3:r[n++]=(s&3)<<6|f,a=0;break}}if(a===1)throw Error(D0);return n-i};mn.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}});var U0=F((fy,K0)=>{"use strict";K0.exports=bn;function bn(){this._listeners={}}bn.prototype.on=function(e,r,n){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:r,ctx:n||this}),this};bn.prototype.off=function(e,r){if(e===void 0)this._listeners={};else if(r===void 0)this._listeners[e]=[];else for(var n=this._listeners[e],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};bn.prototype.emit=function(e){var r=this._listeners[e];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var H0=F((cy,z0)=>{"use strict";z0.exports=F0(F0);function F0(t){return typeof Float32Array<"u"?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=r[3]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function a(f,c,u){e[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}t.writeFloatLE=n?i:a,t.writeFloatBE=n?a:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],e[0]}function o(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],e[0]}t.readFloatLE=n?s:o,t.readFloatBE=n?o:s}():function(){function e(n,i,a,s){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,a,s);else if(isNaN(i))n(2143289344,a,s);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,a,s);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,a,s);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((o<<31|f+127<<23|c)>>>0,a,s)}}t.writeFloatLE=e.bind(null,O0),t.writeFloatBE=e.bind(null,M0);function r(n,i,a){var s=n(i,a),o=(s>>31)*2+1,f=s>>>23&255,c=s&8388607;return f===255?c?NaN:o*(1/0):f===0?o*1401298464324817e-60*c:o*Math.pow(2,f-150)*(c+8388608)}t.readFloatLE=r.bind(null,V0),t.readFloatBE=r.bind(null,q0)}(),typeof Float64Array<"u"?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=r[7]===128;function i(f,c,u){e[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function a(f,c,u){e[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}t.writeDoubleLE=n?i:a,t.writeDoubleBE=n?a:i;function s(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],e[0]}function o(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],e[0]}t.readDoubleLE=n?s:o,t.readDoubleBE=n?o:s}():function(){function e(n,i,a,s,o,f){var c=s<0?1:0;if(c&&(s=-s),s===0)n(0,o,f+i),n(1/s>0?0:2147483648,o,f+a);else if(isNaN(s))n(0,o,f+i),n(2146959360,o,f+a);else if(s>17976931348623157e292)n(0,o,f+i),n((c<<31|2146435072)>>>0,o,f+a);else{var u;if(s<22250738585072014e-324)u=s/5e-324,n(u>>>0,o,f+i),n((c<<31|u/4294967296)>>>0,o,f+a);else{var h=Math.floor(Math.log(s)/Math.LN2);h===1024&&(h=1023),u=s*Math.pow(2,-h),n(u*4503599627370496>>>0,o,f+i),n((c<<31|h+1023<<20|u*1048576&1048575)>>>0,o,f+a)}}}t.writeDoubleLE=e.bind(null,O0,0,4),t.writeDoubleBE=e.bind(null,M0,4,0);function r(n,i,a,s,o){var f=n(s,o+i),c=n(s,o+a),u=(c>>31)*2+1,h=c>>>20&2047,l=4294967296*(c&1048575)+f;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}t.readDoubleLE=r.bind(null,V0,0,4),t.readDoubleBE=r.bind(null,q0,4,0)}(),t}function O0(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function M0(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=t&255}function V0(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function q0(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}});var G0=F((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}});var Z0=F(W0=>{"use strict";var qi=W0;qi.length=function(e){for(var r=0,n=0,i=0;i<e.length;++i)n=e.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(e.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};qi.read=function(e,r,n){var i=n-r;if(i<1)return"";for(var a=null,s=[],o=0,f;r<n;)f=e[r++],f<128?s[o++]=f:f>191&&f<224?s[o++]=(f&31)<<6|e[r++]&63:f>239&&f<365?(f=((f&7)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,s[o++]=55296+(f>>10),s[o++]=56320+(f&1023)):s[o++]=(f&15)<<12|(e[r++]&63)<<6|e[r++]&63,o>8191&&((a||(a=[])).push(String.fromCharCode.apply(String,s)),o=0);return a?(o&&a.push(String.fromCharCode.apply(String,s.slice(0,o))),a.join("")):String.fromCharCode.apply(String,s.slice(0,o))};qi.write=function(e,r,n){for(var i=n,a,s,o=0;o<e.length;++o)a=e.charCodeAt(o),a<128?r[n++]=a:a<2048?(r[n++]=a>>6|192,r[n++]=a&63|128):(a&64512)===55296&&((s=e.charCodeAt(o+1))&64512)===56320?(a=65536+((a&1023)<<10)+(s&1023),++o,r[n++]=a>>18|240,r[n++]=a>>12&63|128,r[n++]=a>>6&63|128,r[n++]=a&63|128):(r[n++]=a>>12|224,r[n++]=a>>6&63|128,r[n++]=a&63|128);return n-i}});var $0=F((hy,Y0)=>{"use strict";Y0.exports=bl;function bl(t,e,r){var n=r||8192,i=n>>>1,a=null,s=n;return function(f){if(f<1||f>i)return t(f);s+f>n&&(a=t(n),s=0);var c=e.call(a,s,s+=f);return s&7&&(s=(s|7)+1),c}}});var X0=F((ly,Q0)=>{"use strict";Q0.exports=bt;var Rr=Ke();function bt(t,e){this.lo=t>>>0,this.hi=e>>>0}var Pe=bt.zero=new bt(0,0);Pe.toNumber=function(){return 0};Pe.zzEncode=Pe.zzDecode=function(){return this};Pe.length=function(){return 1};var wl=bt.zeroHash="\0\0\0\0\0\0\0\0";bt.fromNumber=function(e){if(e===0)return Pe;var r=e<0;r&&(e=-e);var n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new bt(n,i)};bt.from=function(e){if(typeof e=="number")return bt.fromNumber(e);if(Rr.isString(e))if(Rr.Long)e=Rr.Long.fromString(e);else return bt.fromNumber(parseInt(e,10));return e.low||e.high?new bt(e.low>>>0,e.high>>>0):Pe};bt.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};bt.prototype.toLong=function(e){return Rr.Long?new Rr.Long(this.lo|0,this.hi|0,!!e):{low:this.lo|0,high:this.hi|0,unsigned:!!e}};var Ee=String.prototype.charCodeAt;bt.fromHash=function(e){return e===wl?Pe:new bt((Ee.call(e,0)|Ee.call(e,1)<<8|Ee.call(e,2)<<16|Ee.call(e,3)<<24)>>>0,(Ee.call(e,4)|Ee.call(e,5)<<8|Ee.call(e,6)<<16|Ee.call(e,7)<<24)>>>0)};bt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};bt.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this};bt.prototype.zzDecode=function(){var e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this};bt.prototype.length=function(){var e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Ke=F(zi=>{"use strict";var k=zi;k.asPromise=k0();k.base64=P0();k.EventEmitter=U0();k.float=H0();k.inquire=G0();k.utf8=Z0();k.pool=$0();k.LongBits=X0();k.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);k.global=k.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||zi;k.emptyArray=Object.freeze?Object.freeze([]):[];k.emptyObject=Object.freeze?Object.freeze({}):{};k.isInteger=Number.isInteger||function(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e};k.isString=function(e){return typeof e=="string"||e instanceof String};k.isObject=function(e){return e&&typeof e=="object"};k.isset=k.isSet=function(e,r){var n=e[r];return n!=null&&e.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};k.Buffer=function(){try{var t=k.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch{return null}}();k._Buffer_from=null;k._Buffer_allocUnsafe=null;k.newBuffer=function(e){return typeof e=="number"?k.Buffer?k._Buffer_allocUnsafe(e):new k.Array(e):k.Buffer?k._Buffer_from(e):typeof Uint8Array>"u"?e:new Uint8Array(e)};k.Array=typeof Uint8Array<"u"?Uint8Array:Array;k.Long=k.global.dcodeIO&&k.global.dcodeIO.Long||k.global.Long||k.inquire("long");k.key2Re=/^true|false|0|1$/;k.key32Re=/^-?(?:0|[1-9][0-9]*)$/;k.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;k.longToHash=function(e){return e?k.LongBits.from(e).toHash():k.LongBits.zeroHash};k.longFromHash=function(e,r){var n=k.LongBits.fromHash(e);return k.Long?k.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function J0(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)(t[n[i]]===void 0||!r)&&(t[n[i]]=e[n[i]]);return t}k.merge=J0;k.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)};function j0(t){function e(r,n){if(!(this instanceof e))return new e(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&J0(this,n)}return e.prototype=Object.create(Error.prototype,{constructor:{value:e,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return t},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),e}k.newError=j0;k.ProtocolError=j0("ProtocolError");k.oneOfGetter=function(e){for(var r={},n=0;n<e.length;++n)r[e[n]]=1;return function(){for(var i=Object.keys(this),a=i.length-1;a>-1;--a)if(r[i[a]]===1&&this[i[a]]!==void 0&&this[i[a]]!==null)return i[a]}};k.oneOfSetter=function(e){return function(r){for(var n=0;n<e.length;++n)e[n]!==r&&delete this[e[n]]}};k.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};k._configure=function(){var t=k.Buffer;if(!t){k._Buffer_from=k._Buffer_allocUnsafe=null;return}k._Buffer_from=t.from!==Uint8Array.from&&t.from||function(r,n){return new t(r,n)},k._Buffer_allocUnsafe=t.allocUnsafe||function(r){return new t(r)}}});var Wi=F((dy,io)=>{"use strict";io.exports=pt;var ne=Ke(),Gi,ro=ne.LongBits,Sl=ne.utf8;function zt(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function pt(t){this.buf=t,this.pos=0,this.len=t.length}var to=typeof Uint8Array<"u"?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new pt(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new pt(e);throw Error("illegal buffer")},no=function(){return ne.Buffer?function(r){return(pt.create=function(i){return ne.Buffer.isBuffer(i)?new Gi(i):to(i)})(r)}:to};pt.create=no();pt.prototype._slice=ne.Array.prototype.subarray||ne.Array.prototype.slice;pt.prototype.uint32=function(){var e=4294967295;return function(){if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,zt(this,10);return e}}();pt.prototype.int32=function(){return this.uint32()|0};pt.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(e&1)|0};function Hi(){var t=new ro(0,0),e=0;if(this.len-this.pos>4){for(;e<4;++e)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;e=0}else{for(;e<3;++e){if(this.pos>=this.len)throw zt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<e*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<e*7)>>>0,t}if(this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw zt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<e*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}pt.prototype.bool=function(){return this.uint32()!==0};function wn(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}pt.prototype.fixed32=function(){if(this.pos+4>this.len)throw zt(this,4);return wn(this.buf,this.pos+=4)};pt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw zt(this,4);return wn(this.buf,this.pos+=4)|0};function eo(){if(this.pos+8>this.len)throw zt(this,8);return new ro(wn(this.buf,this.pos+=4),wn(this.buf,this.pos+=4))}pt.prototype.float=function(){if(this.pos+4>this.len)throw zt(this,4);var e=ne.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e};pt.prototype.double=function(){if(this.pos+8>this.len)throw zt(this,4);var e=ne.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e};pt.prototype.bytes=function(){var e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw zt(this,e);return this.pos+=e,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};pt.prototype.string=function(){var e=this.bytes();return Sl.read(e,0,e.length)};pt.prototype.skip=function(e){if(typeof e=="number"){if(this.pos+e>this.len)throw zt(this,e);this.pos+=e}else do if(this.pos>=this.len)throw zt(this);while(this.buf[this.pos++]&128);return this};pt.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this};pt._configure=function(t){Gi=t,pt.create=no(),Gi._configure();var e=ne.Long?"toLong":"toNumber";ne.merge(pt.prototype,{int64:function(){return Hi.call(this)[e](!1)},uint64:function(){return Hi.call(this)[e](!0)},sint64:function(){return Hi.call(this).zzDecode()[e](!1)},fixed64:function(){return eo.call(this)[e](!0)},sfixed64:function(){return eo.call(this)[e](!1)}})}});var fo=F((yy,oo)=>{"use strict";oo.exports=Ue;var so=Wi();(Ue.prototype=Object.create(so.prototype)).constructor=Ue;var ao=Ke();function Ue(t){so.call(this,t)}Ue._configure=function(){ao.Buffer&&(Ue.prototype._slice=ao.Buffer.prototype.slice)};Ue.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))};Ue._configure()});var ji=F((gy,lo)=>{"use strict";lo.exports=W;var Kt=Ke(),Zi,Sn=Kt.LongBits,co=Kt.base64,uo=Kt.utf8;function kr(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function $i(){}function El(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function W(){this.len=0,this.head=new kr($i,0,0),this.tail=this.head,this.states=null}var ho=function(){return Kt.Buffer?function(){return(W.create=function(){return new Zi})()}:function(){return new W}};W.create=ho();W.alloc=function(e){return new Kt.Array(e)};Kt.Array!==Array&&(W.alloc=Kt.pool(W.alloc,Kt.Array.prototype.subarray));W.prototype._push=function(e,r,n){return this.tail=this.tail.next=new kr(e,r,n),this.len+=r,this};function Qi(t,e,r){e[r]=t&255}function Bl(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}function Xi(t,e){this.len=t,this.next=void 0,this.val=e}Xi.prototype=Object.create(kr.prototype);Xi.prototype.fn=Bl;W.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new Xi((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this};W.prototype.int32=function(e){return e<0?this._push(Ji,10,Sn.fromNumber(e)):this.uint32(e)};W.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)};function Ji(t,e,r){for(;t.hi;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}W.prototype.uint64=function(e){var r=Sn.from(e);return this._push(Ji,r.length(),r)};W.prototype.int64=W.prototype.uint64;W.prototype.sint64=function(e){var r=Sn.from(e).zzEncode();return this._push(Ji,r.length(),r)};W.prototype.bool=function(e){return this._push(Qi,1,e?1:0)};function Yi(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}W.prototype.fixed32=function(e){return this._push(Yi,4,e>>>0)};W.prototype.sfixed32=W.prototype.fixed32;W.prototype.fixed64=function(e){var r=Sn.from(e);return this._push(Yi,4,r.lo)._push(Yi,4,r.hi)};W.prototype.sfixed64=W.prototype.fixed64;W.prototype.float=function(e){return this._push(Kt.float.writeFloatLE,4,e)};W.prototype.double=function(e){return this._push(Kt.float.writeDoubleLE,8,e)};var Al=Kt.Array.prototype.set?function(e,r,n){r.set(e,n)}:function(e,r,n){for(var i=0;i<e.length;++i)r[n+i]=e[i]};W.prototype.bytes=function(e){var r=e.length>>>0;if(!r)return this._push(Qi,1,0);if(Kt.isString(e)){var n=W.alloc(r=co.length(e));co.decode(e,n,0),e=n}return this.uint32(r)._push(Al,r,e)};W.prototype.string=function(e){var r=uo.length(e);return r?this.uint32(r)._push(uo.write,r,e):this._push(Qi,1,0)};W.prototype.fork=function(){return this.states=new El(this),this.head=this.tail=new kr($i,0,0),this.len=0,this};W.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new kr($i,0,0),this.len=0),this};W.prototype.ldelim=function(){var e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=e.next,this.tail=r,this.len+=n),this};W.prototype.finish=function(){for(var e=this.head.next,r=this.constructor.alloc(this.len),n=0;e;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r};W._configure=function(t){Zi=t,W.create=ho(),Zi._configure()}});var go=F((xy,yo)=>{"use strict";yo.exports=ie;var po=ji();(ie.prototype=Object.create(po.prototype)).constructor=ie;var Be=Ke();function ie(){po.call(this)}ie._configure=function(){ie.alloc=Be._Buffer_allocUnsafe,ie.writeBytesBuffer=Be.Buffer&&Be.Buffer.prototype instanceof Uint8Array&&Be.Buffer.prototype.set.name==="set"?function(e,r,n){r.set(e,n)}:function(e,r,n){if(e.copy)e.copy(r,n,0,e.length);else for(var i=0;i<e.length;)r[n++]=e[i++]}};ie.prototype.bytes=function(e){Be.isString(e)&&(e=Be._Buffer_from(e,"base64"));var r=e.length>>>0;return this.uint32(r),r&&this._push(ie.writeBytesBuffer,r,e),this};function Cl(t,e,r){t.length<40?Be.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}ie.prototype.string=function(e){var r=Be.Buffer.byteLength(e);return this.uint32(r),r&&this._push(Cl,r,e),this};ie._configure()});var Lo=F((f1,No)=>{var rt=X();Re();ht();var Nr=No.exports=rt.sha512=rt.sha512||{};rt.md.sha512=rt.md.algorithms.sha512=Nr;var ko=rt.sha384=rt.sha512.sha384=rt.sha512.sha384||{};ko.create=function(){return Nr.create("SHA-384")};rt.md.sha384=rt.md.algorithms.sha384=ko;rt.sha512.sha256=rt.sha512.sha256||{create:function(){return Nr.create("SHA-512/256")}};rt.md["sha512/256"]=rt.md.algorithms["sha512/256"]=rt.sha512.sha256;rt.sha512.sha224=rt.sha512.sha224||{create:function(){return Nr.create("SHA-512/224")}};rt.md["sha512/224"]=rt.md.algorithms["sha512/224"]=rt.sha512.sha224;Nr.create=function(t){if(Do||Kl(),typeof t>"u"&&(t="SHA-512"),!(t in Oe))throw new Error("Invalid SHA-512 algorithm: "+t);for(var e=Oe[t],r=null,n=rt.util.createBuffer(),i=new Array(80),a=0;a<80;++a)i[a]=new Array(2);var s=64;switch(t){case"SHA-384":s=48;break;case"SHA-512/256":s=32;break;case"SHA-512/224":s=28;break}var o={algorithm:t.replace("-","").toLowerCase(),blockLength:128,digestLength:s,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var f=o.messageLengthSize/4,c=0;c<f;++c)o.fullMessageLength.push(0);n=rt.util.createBuffer(),r=new Array(e.length);for(var c=0;c<e.length;++c)r[c]=e[c].slice(0);return o},o.start(),o.update=function(f,c){c==="utf8"&&(f=rt.util.encodeUtf8(f));var u=f.length;o.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=u[1],u[1]=u[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),Ro(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var f=rt.util.createBuffer();f.putBytes(n.bytes());var c=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,u=c&o.blockLength-1;f.putBytes(ca.substr(0,o.blockLength-u));for(var h,l,d=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)h=o.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,f.putInt32(d>>>0),d=h>>>0;f.putInt32(d);for(var g=new Array(r.length),p=0;p<r.length;++p)g[p]=r[p].slice(0);Ro(g,i,f);var v=rt.util.createBuffer(),m;t==="SHA-512"?m=g.length:t==="SHA-384"?m=g.length-2:m=g.length-4;for(var p=0;p<m;++p)v.putInt32(g[p][0]),(p!==m-1||t!=="SHA-512/224")&&v.putInt32(g[p][1]);return v},o};var ca=null,Do=!1,ua=null,Oe=null;function Kl(){ca=String.fromCharCode(128),ca+=rt.util.fillString(String.fromCharCode(0),128),ua=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Oe={},Oe["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Oe["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Oe["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Oe["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],Do=!0}function Ro(t,e,r){for(var n,i,a,s,o,f,c,u,h,l,d,p,g,v,m,w,A,N,T,_,V,Y,wt,Ft,_t,Et,qe,qr,dt,Ct,L,Kn,Un,Fn,On,Ca=r.length();Ca>=128;){for(dt=0;dt<16;++dt)e[dt][0]=r.getInt32()>>>0,e[dt][1]=r.getInt32()>>>0;for(;dt<80;++dt)Kn=e[dt-2],Ct=Kn[0],L=Kn[1],n=((Ct>>>19|L<<13)^(L>>>29|Ct<<3)^Ct>>>6)>>>0,i=((Ct<<13|L>>>19)^(L<<3|Ct>>>29)^(Ct<<26|L>>>6))>>>0,Fn=e[dt-15],Ct=Fn[0],L=Fn[1],a=((Ct>>>1|L<<31)^(Ct>>>8|L<<24)^Ct>>>7)>>>0,s=((Ct<<31|L>>>1)^(Ct<<24|L>>>8)^(Ct<<25|L>>>7))>>>0,Un=e[dt-7],On=e[dt-16],L=i+Un[1]+s+On[1],e[dt][0]=n+Un[0]+a+On[0]+(L/4294967296>>>0)>>>0,e[dt][1]=L>>>0;for(g=t[0][0],v=t[0][1],m=t[1][0],w=t[1][1],A=t[2][0],N=t[2][1],T=t[3][0],_=t[3][1],V=t[4][0],Y=t[4][1],wt=t[5][0],Ft=t[5][1],_t=t[6][0],Et=t[6][1],qe=t[7][0],qr=t[7][1],dt=0;dt<80;++dt)c=((V>>>14|Y<<18)^(V>>>18|Y<<14)^(Y>>>9|V<<23))>>>0,u=((V<<18|Y>>>14)^(V<<14|Y>>>18)^(Y<<23|V>>>9))>>>0,h=(_t^V&(wt^_t))>>>0,l=(Et^Y&(Ft^Et))>>>0,o=((g>>>28|v<<4)^(v>>>2|g<<30)^(v>>>7|g<<25))>>>0,f=((g<<4|v>>>28)^(v<<30|g>>>2)^(v<<25|g>>>7))>>>0,d=(g&m|A&(g^m))>>>0,p=(v&w|N&(v^w))>>>0,L=qr+u+l+ua[dt][1]+e[dt][1],n=qe+c+h+ua[dt][0]+e[dt][0]+(L/4294967296>>>0)>>>0,i=L>>>0,L=f+p,a=o+d+(L/4294967296>>>0)>>>0,s=L>>>0,qe=_t,qr=Et,_t=wt,Et=Ft,wt=V,Ft=Y,L=_+i,V=T+n+(L/4294967296>>>0)>>>0,Y=L>>>0,T=A,_=N,A=m,N=w,m=g,w=v,L=i+s,g=n+a+(L/4294967296>>>0)>>>0,v=L>>>0;L=t[0][1]+v,t[0][0]=t[0][0]+g+(L/4294967296>>>0)>>>0,t[0][1]=L>>>0,L=t[1][1]+w,t[1][0]=t[1][0]+m+(L/4294967296>>>0)>>>0,t[1][1]=L>>>0,L=t[2][1]+N,t[2][0]=t[2][0]+A+(L/4294967296>>>0)>>>0,t[2][1]=L>>>0,L=t[3][1]+_,t[3][0]=t[3][0]+T+(L/4294967296>>>0)>>>0,t[3][1]=L>>>0,L=t[4][1]+Y,t[4][0]=t[4][0]+V+(L/4294967296>>>0)>>>0,t[4][1]=L>>>0,L=t[5][1]+Ft,t[5][0]=t[5][0]+wt+(L/4294967296>>>0)>>>0,t[5][1]=L>>>0,L=t[6][1]+Et,t[6][0]=t[6][0]+_t+(L/4294967296>>>0)>>>0,t[6][1]=L>>>0,L=t[7][1]+qr,t[7][0]=t[7][0]+qe+(L/4294967296>>>0)>>>0,t[7][1]=L>>>0,Ca-=128}}});var vp={};ut(vp,{aes:()=>bi,hmac:()=>Jr,keys:()=>Ba,pbkdf2:()=>Aa,randomBytes:()=>lr});var bi={};ut(bi,{create:()=>Pc});var U=class extends Error{code;props;constructor(e,r,n){super(e),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var Ia={16:"aes-128-ctr",32:"aes-256-ctr"};function _a(t){if(t.length===16||t.length===32)return Ia[t.length];let e=Object.entries(Ia).map(([r,n])=>`${r} (${n})`).join(" / ");throw new U(`Invalid key length ${t.length} bytes. Must be ${e}`,"ERR_INVALID_KEY_LENGTH")}var Ed=it(Yr(),1),br=it(X(),1);var ei={};ut(ei,{identity:()=>Lf});function _f(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var a=t.charAt(i),s=a.charCodeAt(0);if(r[s]!==255)throw new TypeError(a+" is ambiguous");r[s]=i}var o=t.length,f=t.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var g=0,v=0,m=0,w=p.length;m!==w&&p[m]===0;)m++,g++;for(var A=(w-m)*u+1>>>0,N=new Uint8Array(A);m!==w;){for(var T=p[m],_=0,V=A-1;(T!==0||_<v)&&V!==-1;V--,_++)T+=256*N[V]>>>0,N[V]=T%o>>>0,T=T/o>>>0;if(T!==0)throw new Error("Non-zero carry");v=_,m++}for(var Y=A-v;Y!==A&&N[Y]===0;)Y++;for(var wt=f.repeat(g);Y<A;++Y)wt+=t.charAt(N[Y]);return wt}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var g=0;if(p[g]!==" "){for(var v=0,m=0;p[g]===f;)v++,g++;for(var w=(p.length-g)*c+1>>>0,A=new Uint8Array(w);p[g];){var N=r[p.charCodeAt(g)];if(N===255)return;for(var T=0,_=w-1;(N!==0||T<m)&&_!==-1;_--,T++)N+=o*A[_]>>>0,A[_]=N%256>>>0,N=N/256>>>0;if(N!==0)throw new Error("Non-zero carry");m=T,g++}if(p[g]!==" "){for(var V=w-m;V!==w&&A[V]===0;)V++;for(var Y=new Uint8Array(v+(w-V)),wt=v;V!==w;)Y[wt++]=A[V++];return Y}}}function d(p){var g=l(p);if(g)return g;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var Rf=_f,kf=Rf,Ha=kf;var Dp=new Uint8Array(0);var Ga=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},oe=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var Wa=t=>new TextEncoder().encode(t),Za=t=>new TextDecoder().decode(t);var Xn=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Jn=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return $a(this,e)}},jn=class{constructor(e){this.decoders=e}or(e){return $a(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},$a=(t,e)=>new jn({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),ti=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Xn(e,r,n),this.decoder=new Jn(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Ge=({name:t,prefix:e,encode:r,decode:n})=>new ti(t,e,r,n),ye=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=Ha(r,e);return Ge({prefix:t,name:e,encode:n,decode:a=>oe(i(a))})},Df=(t,e,r,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let a=t.length;for(;t[a-1]==="=";)--a;let s=new Uint8Array(a*r/8|0),o=0,f=0,c=0;for(let u=0;u<a;++u){let h=i[t[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,o+=r,o>=8&&(o-=8,s[c++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return s},Nf=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,a="",s=0,o=0;for(let f=0;f<t.length;++f)for(o=o<<8|t[f],s+=8;s>r;)s-=r,a+=e[i&o>>s];if(s&&(a+=e[i&o<<r-s]),n)for(;a.length*r&7;)a+="=";return a},ft=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Ge({prefix:e,name:t,encode(i){return Nf(i,n,r)},decode(i){return Df(i,n,r,t)}});var Lf=Ge({prefix:"\0",name:"identity",encode:t=>Za(t),decode:t=>Wa(t)});var ri={};ut(ri,{base2:()=>Pf});var Pf=ft({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var ni={};ut(ni,{base8:()=>Kf});var Kf=ft({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ii={};ut(ii,{base10:()=>Uf});var Uf=ye({prefix:"9",name:"base10",alphabet:"0123456789"});var ai={};ut(ai,{base16:()=>Ff,base16upper:()=>Of});var Ff=ft({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Of=ft({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var si={};ut(si,{base32:()=>We,base32hex:()=>zf,base32hexpad:()=>Gf,base32hexpadupper:()=>Wf,base32hexupper:()=>Hf,base32pad:()=>Vf,base32padupper:()=>qf,base32upper:()=>Mf,base32z:()=>Zf});var We=ft({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Mf=ft({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Vf=ft({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),qf=ft({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),zf=ft({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Hf=ft({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Gf=ft({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Wf=ft({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Zf=ft({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var oi={};ut(oi,{base36:()=>Yf,base36upper:()=>$f});var Yf=ye({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),$f=ye({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var fi={};ut(fi,{base58btc:()=>Nt,base58flickr:()=>Qf});var Nt=ye({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Qf=ye({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var ci={};ut(ci,{base64:()=>yr,base64pad:()=>Xf,base64url:()=>Jf,base64urlpad:()=>jf});var yr=ft({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Xf=ft({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Jf=ft({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),jf=ft({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var ui={};ut(ui,{base256emoji:()=>ic});var Qa=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),tc=Qa.reduce((t,e,r)=>(t[r]=e,t),[]),ec=Qa.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function rc(t){return t.reduce((e,r)=>(e+=tc[r],e),"")}function nc(t){let e=[];for(let r of t){let n=ec[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var ic=Ge({prefix:"\u{1F680}",name:"base256emoji",encode:rc,decode:nc});var di={};ut(di,{sha256:()=>Rt,sha512:()=>Ec});var ac=ja,Xa=128,sc=127,oc=~sc,fc=Math.pow(2,31);function ja(t,e,r){e=e||[],r=r||0;for(var n=r;t>=fc;)e[r++]=t&255|Xa,t/=128;for(;t&oc;)e[r++]=t&255|Xa,t>>>=7;return e[r]=t|0,ja.bytes=r-n+1,e}var cc=hi,uc=128,Ja=127;function hi(t,n){var r=0,n=n||0,i=0,a=n,s,o=t.length;do{if(a>=o)throw hi.bytes=0,new RangeError("Could not decode varint");s=t[a++],r+=i<28?(s&Ja)<<i:(s&Ja)*Math.pow(2,i),i+=7}while(s>=uc);return hi.bytes=a-n,r}var hc=Math.pow(2,7),lc=Math.pow(2,14),pc=Math.pow(2,21),dc=Math.pow(2,28),yc=Math.pow(2,35),gc=Math.pow(2,42),xc=Math.pow(2,49),vc=Math.pow(2,56),mc=Math.pow(2,63),bc=function(t){return t<hc?1:t<lc?2:t<pc?3:t<dc?4:t<yc?5:t<gc?6:t<xc?7:t<vc?8:t<mc?9:10},wc={encode:ac,decode:cc,encodingLength:bc},Sc=wc,gr=Sc;var xr=(t,e=0)=>[gr.decode(t,e),gr.decode.bytes],Ze=(t,e,r=0)=>(gr.encode(t,e,r),e),Ye=t=>gr.encodingLength(t);var _e=(t,e)=>{let r=e.byteLength,n=Ye(t),i=n+Ye(r),a=new Uint8Array(i+r);return Ze(t,a,0),Ze(r,a,n),a.set(e,i),new $e(t,r,e,a)},ts=t=>{let e=oe(t),[r,n]=xr(e),[i,a]=xr(e.subarray(n)),s=e.subarray(n+a);if(s.byteLength!==i)throw new Error("Incorrect length");return new $e(r,i,s,e)},es=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&Ga(t.bytes,r.bytes)}},$e=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var pi=({name:t,code:e,encode:r})=>new li(t,e,r),li=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?_e(this.code,r):r.then(n=>_e(this.code,n))}else throw Error("Unknown type, must be binary type")}};var ns=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Rt=pi({name:"sha2-256",code:18,encode:ns("SHA-256")}),Ec=pi({name:"sha2-512",code:19,encode:ns("SHA-512")});var gi={};ut(gi,{identity:()=>yi});var is=0,Bc="identity",as=oe,Ac=t=>_e(is,as(t)),yi={code:is,name:Bc,encode:as,digest:Ac};var jp=new TextEncoder,td=new TextDecoder;var ss=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return _c(r,xi(t),e||Nt.encoder);default:return Rc(r,xi(t),e||We.encoder)}};var os=new WeakMap,xi=t=>{let e=os.get(t);if(e==null){let r=new Map;return os.set(t,r),r}return e},yt=class{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==mr)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==kc)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return yt.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=_e(e,r);return yt.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return yt.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&es(e.multihash,n.multihash)}toString(e){return ss(this,e)}toJSON(){return{"/":ss(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof yt)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:a,bytes:s}=r;return new yt(n,i,a,s||fs(n,i,a.bytes))}else if(r[Dc]===!0){let{version:n,multihash:i,code:a}=r,s=ts(i);return yt.create(n,a,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==mr)throw new Error(`Version 0 CID must use dag-pb (code: ${mr}) block encoding`);return new yt(e,r,n,n.bytes)}case 1:{let i=fs(e,r,n.bytes);return new yt(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return yt.create(0,mr,e)}static createV1(e,r){return yt.create(1,e,r)}static decode(e){let[r,n]=yt.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=yt.inspectBytes(e),n=r.size-r.multihashSize,i=oe(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let a=i.subarray(r.multihashSize-r.digestSize),s=new $e(r.multihashCode,r.digestSize,a,i);return[r.version===0?yt.createV0(s):yt.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[h,l]=xr(e.subarray(r));return r+=l,h},i=n(),a=mr;if(i===18?(i=0,r=0):a=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,o=n(),f=n(),c=r+f,u=c-s;return{version:i,codec:a,multihashCode:o,digestSize:f,multihashSize:u,size:c}}static parse(e,r){let[n,i]=Ic(e,r),a=yt.decode(i);if(a.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return xi(a).set(n,e),a}},Ic=(t,e)=>{switch(t[0]){case"Q":{let r=e||Nt;return[Nt.prefix,r.decode(`${Nt.prefix}${t}`)]}case Nt.prefix:{let r=e||Nt;return[Nt.prefix,r.decode(t)]}case We.prefix:{let r=e||We;return[We.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},_c=(t,e,r)=>{let{prefix:n}=r;if(n!==Nt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let a=r.encode(t).slice(1);return e.set(n,a),a}else return i},Rc=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let a=r.encode(t);return e.set(n,a),a}else return i},mr=112,kc=18,fs=(t,e,r)=>{let n=Ye(t),i=n+Ye(e),a=new Uint8Array(i+r.byteLength);return Ze(t,a,0),Ze(e,a,n),a.set(r,i),a},Dc=Symbol.for("@ipld/js-cid/CID");var vi={...ei,...ri,...ni,...ii,...ai,...si,...oi,...fi,...ci,...ui},ud={...di,...gi};function Qe(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Qr(t=0){return globalThis.Buffer?.allocUnsafe!=null?Qe(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function us(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var cs=us("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),mi=us("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=Qr(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),Nc={utf8:cs,"utf-8":cs,hex:vi.base16,latin1:mi,ascii:mi,binary:mi,...vi},Xr=Nc;function St(t,e="utf8"){let r=Xr[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Qe(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function ot(t,e="utf8"){let r=Xr[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function hs(t,e,r){let n=br.default.cipher.createCipher("AES-CTR",ot(e,"ascii"));return n.start({iv:ot(r,"ascii")}),{update:i=>(n.update(br.default.util.createBuffer(ot(i,"ascii"))),St(n.output.getBytes(),"ascii"))}}function ls(t,e,r){let n=br.default.cipher.createDecipher("AES-CTR",ot(e,"ascii"));return n.start({iv:ot(r,"ascii")}),{update:i=>(n.update(br.default.util.createBuffer(ot(i,"ascii"))),St(n.output.getBytes(),"ascii"))}}async function Pc(t,e){let r=_a(t),n=hs(r,t,e),i=ls(r,t,e);return{async encrypt(s){return n.update(s)},async decrypt(s){return i.update(s)}}}var Jr={};ut(Jr,{create:()=>wi});var lt={get(t=globalThis){let e=t.crypto;if(e==null||e.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return e}};var ps={SHA1:20,SHA256:32,SHA512:64};var Kc={SHA1:"SHA-1",SHA256:"SHA-256",SHA512:"SHA-512"},Uc=async(t,e)=>{let r=await lt.get().subtle.sign({name:"HMAC"},t,e);return new Uint8Array(r,0,r.byteLength)};async function wi(t,e){let r=Kc[t],n=await lt.get().subtle.importKey("raw",e,{name:"HMAC",hash:{name:r}},!1,["sign"]);return{async digest(i){return Uc(n,i)},length:ps[t]}}var Ba={};ut(Ba,{generateEphemeralKeyPair:()=>Co,generateKeyPair:()=>lp,generateKeyPairFromSeed:()=>pp,importKey:()=>xp,keyStretcher:()=>_o,keysPBM:()=>ir,marshalPrivateKey:()=>gp,marshalPublicKey:()=>yp,supportedKeys:()=>se,unmarshalPrivateKey:()=>lf,unmarshalPublicKey:()=>dp});var M1=it(Er(),1),V1=it(d0(),1);var Pn=it(X(),1);var oa={};ut(oa,{Ed25519PrivateKey:()=>Fe,Ed25519PublicKey:()=>Dr,generateKeyPair:()=>Dl,generateKeyPairFromSeed:()=>sa,unmarshalEd25519PrivateKey:()=>Rl,unmarshalEd25519PublicKey:()=>kl});function Vt(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}var el=it(Xe(),1);var mt=BigInt(0),z=BigInt(1),be=BigInt(2),rl=BigInt(8),y0=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),tt=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:y0,n:y0,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var b0=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Cr=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Xd=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),nl=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),il=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),al=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),sl=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),M=class{constructor(e,r,n,i){this.x=e,this.y=r,this.z=n,this.t=i}static fromAffine(e){if(!(e instanceof st))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return e.equals(st.ZERO)?M.ZERO:new M(e.x,e.y,z,E(e.x*e.y))}static toAffineBatch(e){let r=cl(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return this.toAffineBatch(e).map(this.fromAffine)}equals(e){x0(e);let{x:r,y:n,z:i}=this,{x:a,y:s,z:o}=e,f=E(r*o),c=E(a*i),u=E(n*o),h=E(s*i);return f===c&&u===h}negate(){return new M(E(-this.x),this.y,this.z,E(-this.t))}double(){let{x:e,y:r,z:n}=this,{a:i}=tt,a=E(e*e),s=E(r*r),o=E(be*E(n*n)),f=E(i*a),c=e+r,u=E(E(c*c)-a-s),h=f+s,l=h-o,d=f-s,p=E(u*l),g=E(h*d),v=E(u*d),m=E(l*h);return new M(p,g,m,v)}add(e){x0(e);let{x:r,y:n,z:i,t:a}=this,{x:s,y:o,z:f,t:c}=e,u=E((n-r)*(o+s)),h=E((n+r)*(o-s)),l=E(h-u);if(l===mt)return this.double();let d=E(i*be*c),p=E(a*be*f),g=p+d,v=h+u,m=p-d,w=E(g*l),A=E(v*m),N=E(g*m),T=E(l*v);return new M(w,A,T,N)}subtract(e){return this.add(e.negate())}precomputeWindow(e){let r=1+256/e,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(e-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(e,r){!r&&this.equals(M.BASE)&&(r=st.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&Ui.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=M.normalizeZ(i),Ui.set(r,i)));let a=M.ZERO,s=M.BASE,o=1+256/n,f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(e&c);e>>=h,p>f&&(p-=u,e+=z);let g=d,v=d+Math.abs(p)-1,m=l%2!==0,w=p<0;p===0?s=s.add(g0(m,i[g])):a=a.add(g0(w,i[v]))}return M.normalizeZ([a,s])[0]}multiply(e,r){return this.wNAF(dn(e,tt.l),r)}multiplyUnsafe(e){let r=dn(e,tt.l,!1),n=M.BASE,i=M.ZERO;if(r===mt)return i;if(this.equals(i)||r===z)return this;if(this.equals(n))return this.wNAF(r);let a=i,s=this;for(;r>mt;)r&z&&(a=a.add(s)),s=s.double(),r>>=z;return a}isSmallOrder(){return this.multiplyUnsafe(tt.h).equals(M.ZERO)}isTorsionFree(){let e=this.multiplyUnsafe(tt.l/be).double();return tt.l%be&&(e=e.add(this)),e.equals(M.ZERO)}toAffine(e){let{x:r,y:n,z:i}=this,a=this.equals(M.ZERO);e==null&&(e=a?rl:yn(i));let s=E(r*e),o=E(n*e),f=E(i*e);if(a)return st.ZERO;if(f!==z)throw new Error("invZ was invalid");return new st(s,o)}fromRistrettoBytes(){Li()}toRistrettoBytes(){Li()}fromRistrettoHash(){Li()}};M.BASE=new M(tt.Gx,tt.Gy,z,E(tt.Gx*tt.Gy));M.ZERO=new M(mt,z,z,mt);function g0(t,e){let r=e.negate();return t?r:e}function x0(t){if(!(t instanceof M))throw new TypeError("ExtendedPoint expected")}function Ni(t){if(!(t instanceof It))throw new TypeError("RistrettoPoint expected")}function Li(){throw new Error("Legacy method: switch to RistrettoPoint")}var It=class{constructor(e){this.ep=e}static calcElligatorRistrettoMap(e){let{d:r}=tt,n=E(Cr*e*e),i=E((n+z)*al),a=BigInt(-1),s=E((a-r*n)*E(n+r)),{isValid:o,value:f}=Oi(i,s),c=E(f*e);me(c)||(c=E(-c)),o||(f=c),o||(a=n);let u=E(a*(n-z)*sl-s),h=f*f,l=E((f+f)*s),d=E(u*nl),p=E(z-h),g=E(z+h);return new M(E(l*g),E(p*d),E(d*g),E(l*p))}static hashToCurve(e){e=we(e,64);let r=Pi(e.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=Pi(e.slice(32,64)),a=this.calcElligatorRistrettoMap(i);return new It(n.add(a))}static fromHex(e){e=we(e,32);let{a:r,d:n}=tt,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",a=Pi(e);if(!hl(Tr(a),e)||me(a))throw new Error(i);let s=E(a*a),o=E(z+r*s),f=E(z-r*s),c=E(o*o),u=E(f*f),h=E(r*n*c-u),{isValid:l,value:d}=m0(E(h*u)),p=E(d*f),g=E(d*p*h),v=E((a+a)*p);me(v)&&(v=E(-v));let m=E(o*g),w=E(v*m);if(!l||me(w)||m===mt)throw new Error(i);return new It(new M(v,m,z,w))}toRawBytes(){let{x:e,y:r,z:n,t:i}=this.ep,a=E(E(n+r)*E(n-r)),s=E(e*r),o=E(s*s),{value:f}=m0(E(a*o)),c=E(f*a),u=E(f*s),h=E(c*u*i),l;if(me(i*h)){let p=E(r*Cr),g=E(e*Cr);e=p,r=g,l=E(c*il)}else l=u;me(e*h)&&(r=E(-r));let d=E((n-r)*l);return me(d)&&(d=E(-d)),Tr(d)}toHex(){return Ir(this.toRawBytes())}toString(){return this.toHex()}equals(e){Ni(e);let r=this.ep,n=e.ep,i=E(r.x*n.y)===E(r.y*n.x),a=E(r.y*n.y)===E(r.x*n.x);return i||a}add(e){return Ni(e),new It(this.ep.add(e.ep))}subtract(e){return Ni(e),new It(this.ep.subtract(e.ep))}multiply(e){return new It(this.ep.multiply(e))}multiplyUnsafe(e){return new It(this.ep.multiplyUnsafe(e))}};It.BASE=new It(M.BASE);It.ZERO=new It(M.ZERO);var Ui=new WeakMap,st=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,Ui.delete(this)}static fromHex(e,r=!0){let{d:n,P:i}=tt;e=we(e,32);let a=e.slice();a[31]=e[31]&-129;let s=_r(a);if(r&&s>=i)throw new Error("Expected 0 < hex < P");if(!r&&s>=b0)throw new Error("Expected 0 < hex < 2**256");let o=E(s*s),f=E(o-z),c=E(n*o+z),{isValid:u,value:h}=Oi(f,c);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&z)===z;return(e[31]&128)!==0!==l&&(h=E(-h)),new st(h,s)}static async fromPrivateKey(e){return(await gn(e)).point}toRawBytes(){let e=Tr(this.y);return e[31]|=this.x&z?128:0,e}toHex(){return Ir(this.toRawBytes())}toX25519(){let{y:e}=this,r=E((z+e)*yn(z-e));return Tr(r)}isTorsionFree(){return M.fromAffine(this).isTorsionFree()}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new st(E(-this.x),this.y)}add(e){return M.fromAffine(this).add(M.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return M.fromAffine(this).multiply(e,this).toAffine()}};st.BASE=new st(tt.Gx,tt.Gy);st.ZERO=new st(mt,z);var Le=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromHex(e){let r=we(e,64),n=st.fromHex(r.slice(0,32),!1),i=_r(r.slice(32,64));return new Le(n,i)}assertValidity(){let{r:e,s:r}=this;if(!(e instanceof st))throw new Error("Expected Point instance");return dn(r,tt.l,!1),this}toRawBytes(){let e=new Uint8Array(64);return e.set(this.r.toRawBytes()),e.set(Tr(this.s),32),e}toHex(){return Ir(this.toRawBytes())}};function v0(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let a=t[n];r.set(a,i),i+=a.length}return r}var ol=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Ir(t){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=ol[t[r]];return e}function Fi(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),a=Number.parseInt(i,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");e[r]=a}return e}function w0(t){let r=t.toString(16).padStart(64,"0");return Fi(r)}function Tr(t){return w0(t).reverse()}function me(t){return(E(t)&z)===z}function _r(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Ir(Uint8Array.from(t).reverse()))}var fl=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function Pi(t){return E(_r(t)&fl)}function E(t,e=tt.P){let r=t%e;return r>=mt?r:e+r}function yn(t,e=tt.P){if(t===mt||e<=mt)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=E(t,e),n=e,i=mt,a=z,s=z,o=mt;for(;r!==mt;){let c=n/r,u=n%r,h=i-s*c,l=a-o*c;n=r,r=u,i=s,a=o,s=h,o=l}if(n!==z)throw new Error("invert: does not exist");return E(i,e)}function cl(t,e=tt.P){let r=new Array(t.length),n=t.reduce((a,s,o)=>s===mt?a:(r[o]=a,E(a*s,e)),z),i=yn(n,e);return t.reduceRight((a,s,o)=>s===mt?a:(r[o]=E(a*r[o],e),E(a*s,e)),i),r}function ee(t,e){let{P:r}=tt,n=t;for(;e-- >mt;)n*=n,n%=r;return n}function ul(t){let{P:e}=tt,r=BigInt(5),n=BigInt(10),i=BigInt(20),a=BigInt(40),s=BigInt(80),f=t*t%e*t%e,c=ee(f,be)*f%e,u=ee(c,z)*t%e,h=ee(u,r)*u%e,l=ee(h,n)*h%e,d=ee(l,i)*l%e,p=ee(d,a)*d%e,g=ee(p,s)*p%e,v=ee(g,s)*p%e,m=ee(v,n)*h%e;return{pow_p_5_8:ee(m,be)*t%e,b2:f}}function Oi(t,e){let r=E(e*e*e),n=E(r*r*e),i=ul(t*n).pow_p_5_8,a=E(t*r*i),s=E(e*a*a),o=a,f=E(a*Cr),c=s===t,u=s===E(-t),h=s===E(-t*Cr);return c&&(a=o),(u||h)&&(a=f),me(a)&&(a=E(-a)),{isValid:c||u,value:a}}function m0(t){return Oi(z,t)}function pn(t){return E(_r(t),tt.l)}function hl(t,e){if(t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(t[r]!==e[r])return!1;return!0}function we(t,e){let r=t instanceof Uint8Array?Uint8Array.from(t):Fi(t);if(typeof e=="number"&&r.length!==e)throw new Error(`Expected ${e} bytes`);return r}function dn(t,e,r=!0){if(!e)throw new TypeError("Specify max value");if(typeof t=="number"&&Number.isSafeInteger(t)&&(t=BigInt(t)),typeof t=="bigint"&&t<e){if(r){if(mt<t)return t}else if(mt<=t)return t}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function ll(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function pl(t){if(t=typeof t=="bigint"||typeof t=="number"?w0(dn(t,b0)):we(t),t.length!==32)throw new Error("Expected 32 bytes");return t}function dl(t){let e=ll(t.slice(0,32)),r=t.slice(32,64),n=pn(e),i=st.BASE.multiply(n),a=i.toRawBytes();return{head:e,prefix:r,scalar:n,point:i,pointBytes:a}}var Ki;async function gn(t){return dl(await Se.sha512(pl(t)))}async function Mi(t){return(await gn(t)).pointBytes}async function S0(t,e){t=we(t);let{prefix:r,scalar:n,pointBytes:i}=await gn(e),a=pn(await Se.sha512(r,t)),s=st.BASE.multiply(a),o=pn(await Se.sha512(s.toRawBytes(),i,t)),f=E(a+o*n,tt.l);return new Le(s,f).toRawBytes()}function yl(t,e,r){e=we(e),r instanceof st||(r=st.fromHex(r,!1));let{r:n,s:i}=t instanceof Le?t.assertValidity():Le.fromHex(t),a=M.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:a,pub:r,msg:e}}function gl(t,e,r,n){let i=pn(n),a=M.fromAffine(t).multiplyUnsafe(i);return M.fromAffine(e).add(a).subtract(r).multiplyUnsafe(tt.h).equals(M.ZERO)}async function E0(t,e,r){let{r:n,SB:i,msg:a,pub:s}=yl(t,e,r),o=await Se.sha512(n.toRawBytes(),s.toRawBytes(),a);return gl(s,n,i,o)}st.BASE._setWindowSize(8);var ve={node:el,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},Se={bytesToHex:Ir,hexToBytes:Fi,concatBytes:v0,getExtendedPublicKey:gn,mod:E,invert:yn,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:t=>{if(t=we(t),t.length<40||t.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return E(_r(t),tt.l-z)+z},randomBytes:(t=32)=>{if(ve.web)return ve.web.getRandomValues(new Uint8Array(t));if(ve.node){let{randomBytes:e}=ve.node;return new Uint8Array(e(t).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Se.randomBytes(32),sha512:async(...t)=>{let e=v0(...t);if(ve.web){let r=await ve.web.subtle.digest("SHA-512",e.buffer);return new Uint8Array(r)}else{if(ve.node)return Uint8Array.from(ve.node.createHash("sha512").update(e).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(t=8,e=st.BASE){let r=e.equals(st.BASE)?e:new st(e.x,e.y);return r._setWindowSize(t),r.multiply(be),r},sha512Sync:void 0};Object.defineProperties(Se,{sha512Sync:{configurable:!1,get(){return Ki},set(t){Ki||(Ki=t)}}});var tr=32,he=64,xn=32;async function B0(){let t=Se.randomPrivateKey(),e=await Mi(t);return{privateKey:I0(t,e),publicKey:e}}async function A0(t){if(t.length!==xn)throw new TypeError('"seed" must be 32 bytes in length.');if(!(t instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let e=t,r=await Mi(e);return{privateKey:I0(e,r),publicKey:r}}async function C0(t,e){let r=t.subarray(0,xn);return S0(e,r)}async function T0(t,e,r){return E0(e,r,t)}function I0(t,e){let r=new Uint8Array(he);for(let n=0;n<xn;n++)r[n]=t[n],r[xn+n]=e[n];return r}function re(t,e){e==null&&(e=t.reduce((i,a)=>i+a.length,0));let r=Qr(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return Qe(r)}var Vi={alg:"A128GCM",ext:!0,k:"scm9jmO_4BJAgdwWGVulLg",key_ops:["encrypt","decrypt"],kty:"oct"};function vn(t){let e=t?.algorithm??"AES-GCM",r=t?.keyLength??16,n=t?.nonceLength??12,i=t?.digest??"SHA-256",a=t?.saltLength??16,s=t?.iterations??32767,o=lt.get();r*=8;async function f(h,l){let d=o.getRandomValues(new Uint8Array(a)),p=o.getRandomValues(new Uint8Array(n)),g={name:e,iv:p};typeof l=="string"&&(l=St(l));let v;if(l.length===0){v=await o.subtle.importKey("jwk",Vi,{name:"AES-GCM"},!0,["encrypt"]);try{let w={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},A=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);v=await o.subtle.deriveKey(w,A,{name:e,length:r},!0,["encrypt"])}catch{v=await o.subtle.importKey("jwk",Vi,{name:"AES-GCM"},!0,["encrypt"])}}else{let w={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},A=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);v=await o.subtle.deriveKey(w,A,{name:e,length:r},!0,["encrypt"])}let m=await o.subtle.encrypt(g,v,h);return re([d,g.iv,new Uint8Array(m)])}async function c(h,l){let d=h.subarray(0,a),p=h.subarray(a,a+n),g=h.subarray(a+n),v={name:e,iv:p};typeof l=="string"&&(l=St(l));let m;if(l.length===0)try{let A={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},N=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await o.subtle.deriveKey(A,N,{name:e,length:r},!0,["decrypt"])}catch{m=await o.subtle.importKey("jwk",Vi,{name:"AES-GCM"},!0,["decrypt"])}else{let A={name:"PBKDF2",salt:d,iterations:s,hash:{name:i}},N=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey"]);m=await o.subtle.deriveKey(A,N,{name:e,length:r},!0,["decrypt"])}let w=await o.subtle.decrypt(v,m,g);return new Uint8Array(w)}return{encrypt:f,decrypt:c}}async function er(t,e){let n=await vn().encrypt(t,e);return yr.encode(n)}var ir={};ut(ir,{KeyType:()=>et,PrivateKey:()=>Gt,PublicKey:()=>Ht});var ta=it(Wi(),1),xo=it(fo(),1),vo=it(Ke(),1),ea=it(ji(),1),mo=it(go(),1);function Tl(){vo.default._configure(),ta.default._configure(xo.default),ea.default._configure(mo.default)}Tl();var bo=["uint64","int64","sint64","fixed64","sfixed64"];function Il(t){for(let e of bo){if(t[e]==null)continue;let r=t[e];t[e]=function(){return BigInt(r.call(this).toString())}}return t}function ra(t){return Il(new ta.default(t))}function _l(t){for(let e of bo){if(t[e]==null)continue;let r=t[e];t[e]=function(n){return r.call(this,n.toString())}}return t}function na(){return _l(ea.default.create())}function En(t,e){let r=ra(t instanceof Uint8Array?t:t.subarray());return e.decode(r)}function Bn(t,e){let r=na();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}var nr;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(nr||(nr={}));function An(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function ia(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(a,s){let o=e(a);s.int32(o)},n=function(a){let s=a.int32();return e(s)};return An("enum",nr.VARINT,r,n)}function Cn(t,e){return An("message",nr.LENGTH_DELIMITED,t,e)}var et;(function(t){t.RSA="RSA",t.Ed25519="Ed25519",t.Secp256k1="Secp256k1"})(et||(et={}));var aa;(function(t){t[t.RSA=0]="RSA",t[t.Ed25519=1]="Ed25519",t[t.Secp256k1=2]="Secp256k1"})(aa||(aa={}));(function(t){t.codec=()=>ia(aa)})(et||(et={}));var Ht;(function(t){let e;t.codec=()=>(e==null&&(e=Cn((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),et.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let s=r.uint32();switch(s>>>3){case 1:i.Type=et.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Bn(r,t.codec()),t.decode=r=>En(r,t.codec())})(Ht||(Ht={}));var Gt;(function(t){let e;t.codec=()=>(e==null&&(e=Cn((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),et.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},a=n==null?r.len:r.pos+n;for(;r.pos<a;){let s=r.uint32();switch(s>>>3){case 1:i.Type=et.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Bn(r,t.codec()),t.decode=r=>En(r,t.codec())})(Gt||(Gt={}));var Dr=class{_key;constructor(e){this._key=ar(e,tr)}async verify(e,r){return T0(this._key,r,e)}marshal(){return this._key}get bytes(){return Ht.encode({Type:et.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Vt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Rt.digest(this.bytes);return e}},Fe=class{_key;_publicKey;constructor(e,r){this._key=ar(e,he),this._publicKey=ar(r,tr)}async sign(e){return C0(this._key,e)}get public(){return new Dr(this._publicKey)}marshal(){return this._key}get bytes(){return Gt.encode({Type:et.Ed25519,Data:this.marshal()}).subarray()}equals(e){return Vt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Rt.digest(this.bytes);return e}async id(){let e=yi.digest(this.public.bytes);return Nt.encode(e.bytes).substring(1)}async export(e,r="libp2p-key"){if(r==="libp2p-key")return er(this.bytes,e);throw new U(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function Rl(t){if(t.length>he){t=ar(t,he+tr);let n=t.subarray(0,he),i=t.subarray(he,t.length);return new Fe(n,i)}t=ar(t,he);let e=t.subarray(0,he),r=t.subarray(tr);return new Fe(e,r)}function kl(t){return t=ar(t,tr),new Dr(t)}async function Dl(){let{privateKey:t,publicKey:e}=await B0();return new Fe(t,e)}async function sa(t){let{privateKey:e,publicKey:r}=await A0(t);return new Fe(e,r)}function ar(t,e){if(t=Uint8Array.from(t??[]),t.length!==e)throw new U(`Key must be a Uint8Array of length ${e}, got ${t.length}`,"ERR_INVALID_KEY_TYPE");return t}var Vy=it(ht(),1),qy=it(cn(),1),wo=it(X(),1);function Wt(t,e){let r=Uint8Array.from(t.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=re([new Uint8Array(e-r.length),r])}return ot(r,"base64url")}function kt(t){let e=Tn(t);return new wo.default.jsbn.BigInteger(ot(e,"base16"),16)}function Tn(t,e){let r=St(t,"base64urlpad");if(e!=null){if(r.length>e)throw new Error("byte array longer than desired length");r=re([new Uint8Array(e-r.length),r])}return r}var So={"P-256":256,"P-384":384,"P-521":521},Nl=Object.keys(So),fa=Nl.join(" / ");async function Eo(t){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new U(`Unknown curve: ${t}. Must be ${fa}`,"ERR_INVALID_CURVE");let e=await lt.get().subtle.generateKey({name:"ECDH",namedCurve:t},!0,["deriveBits"]),r=async(a,s)=>{let o;s!=null?o=await lt.get().subtle.importKey("jwk",Pl(t,s),{name:"ECDH",namedCurve:t},!1,["deriveBits"]):o=e.privateKey;let f=await lt.get().subtle.importKey("jwk",Ao(t,a),{name:"ECDH",namedCurve:t},!1,[]),c=await lt.get().subtle.deriveBits({name:"ECDH",namedCurve:t,public:f},o,So[t]);return new Uint8Array(c,0,c.byteLength)},n=await lt.get().subtle.exportKey("jwk",e.publicKey);return{key:Ll(n),genSharedKey:r}}var Bo={"P-256":32,"P-384":48,"P-521":66};function Ll(t){if(t.crv==null||t.x==null||t.y==null)throw new U("JWK was missing components","ERR_INVALID_PARAMETERS");if(t.crv!=="P-256"&&t.crv!=="P-384"&&t.crv!=="P-521")throw new U(`Unknown curve: ${t.crv}. Must be ${fa}`,"ERR_INVALID_CURVE");let e=Bo[t.crv];return re([Uint8Array.from([4]),Tn(t.x,e),Tn(t.y,e)],1+e*2)}function Ao(t,e){if(t!=="P-256"&&t!=="P-384"&&t!=="P-521")throw new U(`Unknown curve: ${t}. Must be ${fa}`,"ERR_INVALID_CURVE");let r=Bo[t];if(!Vt(e.subarray(0,1),Uint8Array.from([4])))throw new U("Cannot unmarshal public key - invalid key format","ERR_INVALID_KEY_FORMAT");return{kty:"EC",crv:t,x:ot(e.subarray(1,r+1),"base64url"),y:ot(e.subarray(1+r),"base64url"),ext:!0}}var Pl=(t,e)=>({...Ao(t,e.public),d:ot(e.private,"base64url")});var Co=Eo;async function To(t,e){let r=yr.decode(t);return vn().decrypt(r,e)}var Io={"AES-128":{ivSize:16,keySize:16},"AES-256":{ivSize:16,keySize:32},Blowfish:{ivSize:8,keySize:32}};async function _o(t,e,r){let n=Io[t];if(n==null){let w=Object.keys(Io).join(" / ");throw new U(`unknown cipher type '${t}'. Must be ${w}`,"ERR_INVALID_CIPHER_TYPE")}if(e==null)throw new U("missing hash type","ERR_MISSING_HASH_TYPE");let i=n.keySize,a=n.ivSize,s=20,o=St("key expansion"),f=2*(a+i+s),c=await wi(e,r),u=await c.digest(o),h=[],l=0;for(;l<f;){let w=await c.digest(re([u,o])),A=w.length;l+A>f&&(A=f-l),h.push(w),l+=A,u=await c.digest(u)}let d=f/2,p=re(h),g=p.subarray(0,d),v=p.subarray(d,f),m=w=>({iv:w.subarray(0,a),cipherKey:w.subarray(a,a+i),macKey:w.subarray(a+i)});return{k1:m(g),k2:m(v)}}var ma={};ut(ma,{RsaPrivateKey:()=>pr,RsaPublicKey:()=>Or,fromJwk:()=>sp,generateKeyPair:()=>op,unmarshalRsaPrivateKey:()=>ip,unmarshalRsaPublicKey:()=>ap});var Fr=it(X(),1);var R1=it(Lo(),1);var Ul=it(Xe(),1);var H=BigInt(0),nt=BigInt(1),Ce=BigInt(2),Pr=BigInt(3),Po=BigInt(8),ct=Object.freeze({a:H,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:nt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),Ko=(t,e)=>(t+e/Ce)/e,In={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(t){let{n:e}=ct,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-nt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),a=r,s=BigInt("0x100000000000000000000000000000000"),o=Ko(a*t,e),f=Ko(-n*t,e),c=R(t-o*r-f*i,e),u=R(-o*n-f*a,e),h=c>s,l=u>s;if(h&&(c=e-c),l&&(u=e-u),c>s||u>s)throw new Error("splitScalarEndo: Endomorphism failed, k="+t);return{k1neg:h,k1:c,k2neg:l,k2:u}}},Zt=32,fr=32,Fl=32,Uo=Zt+1,Fo=2*Zt+1;function Oo(t){let{a:e,b:r}=ct,n=R(t*t),i=R(n*t);return R(i+e*t+r)}var _n=ct.a===H,Dn=class extends Error{constructor(e){super(e)}};function Mo(t){if(!(t instanceof Z))throw new TypeError("JacobianPoint expected")}var Z=class{constructor(e,r,n){this.x=e,this.y=r,this.z=n}static fromAffine(e){if(!(e instanceof $))throw new TypeError("JacobianPoint#fromAffine: expected Point");return e.equals($.ZERO)?Z.ZERO:new Z(e.x,e.y,nt)}static toAffineBatch(e){let r=zl(e.map(n=>n.z));return e.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(e){return Z.toAffineBatch(e).map(Z.fromAffine)}equals(e){Mo(e);let{x:r,y:n,z:i}=this,{x:a,y:s,z:o}=e,f=R(i*i),c=R(o*o),u=R(r*c),h=R(a*f),l=R(R(n*o)*c),d=R(R(s*i)*f);return u===h&&l===d}negate(){return new Z(this.x,R(-this.y),this.z)}double(){let{x:e,y:r,z:n}=this,i=R(e*e),a=R(r*r),s=R(a*a),o=e+a,f=R(Ce*(R(o*o)-i-s)),c=R(Pr*i),u=R(c*c),h=R(u-Ce*f),l=R(c*(f-h)-Po*s),d=R(Ce*r*n);return new Z(h,l,d)}add(e){Mo(e);let{x:r,y:n,z:i}=this,{x:a,y:s,z:o}=e;if(a===H||s===H)return this;if(r===H||n===H)return e;let f=R(i*i),c=R(o*o),u=R(r*c),h=R(a*f),l=R(R(n*o)*c),d=R(R(s*i)*f),p=R(h-u),g=R(d-l);if(p===H)return g===H?this.double():Z.ZERO;let v=R(p*p),m=R(p*v),w=R(u*v),A=R(g*g-m-Ce*w),N=R(g*(w-A)-l*m),T=R(i*o*p);return new Z(A,N,T)}subtract(e){return this.add(e.negate())}multiplyUnsafe(e){let r=Z.ZERO;if(typeof e=="bigint"&&e===H)return r;let n=zo(e);if(n===nt)return this;if(!_n){let h=r,l=this;for(;n>H;)n&nt&&(h=h.add(l)),l=l.double(),n>>=nt;return h}let{k1neg:i,k1:a,k2neg:s,k2:o}=In.splitScalar(n),f=r,c=r,u=this;for(;a>H||o>H;)a&nt&&(f=f.add(u)),o&nt&&(c=c.add(u)),u=u.double(),a>>=nt,o>>=nt;return i&&(f=f.negate()),s&&(c=c.negate()),c=new Z(R(c.x*In.beta),c.y,c.z),f.add(c)}precomputeWindow(e){let r=_n?128/e+1:256/e+1,n=[],i=this,a=i;for(let s=0;s<r;s++){a=i,n.push(a);for(let o=1;o<2**(e-1);o++)a=a.add(i),n.push(a);i=a.double()}return n}wNAF(e,r){!r&&this.equals(Z.BASE)&&(r=$.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&la.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=Z.normalizeZ(i),la.set(r,i)));let a=Z.ZERO,s=Z.BASE,o=1+(_n?128/n:256/n),f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(e&c);e>>=h,p>f&&(p-=u,e+=nt);let g=d,v=d+Math.abs(p)-1,m=l%2!==0,w=p<0;p===0?s=s.add(Rn(m,i[g])):a=a.add(Rn(w,i[v]))}return{p:a,f:s}}multiply(e,r){let n=zo(e),i,a;if(_n){let{k1neg:s,k1:o,k2neg:f,k2:c}=In.splitScalar(n),{p:u,f:h}=this.wNAF(o,r),{p:l,f:d}=this.wNAF(c,r);u=Rn(s,u),l=Rn(f,l),l=new Z(R(l.x*In.beta),l.y,l.z),i=u.add(l),a=h.add(d)}else{let{p:s,f:o}=this.wNAF(n,r);i=s,a=o}return Z.normalizeZ([i,a])[0]}toAffine(e){let{x:r,y:n,z:i}=this,a=this.equals(Z.ZERO);e==null&&(e=a?Po:hr(i));let s=e,o=R(s*s),f=R(o*s),c=R(r*o),u=R(n*f),h=R(i*s);if(a)return $.ZERO;if(h!==nt)throw new Error("invZ was invalid");return new $(c,u)}};Z.BASE=new Z(ct.Gx,ct.Gy,nt);Z.ZERO=new Z(H,nt,H);function Rn(t,e){let r=e.negate();return t?r:e}var la=new WeakMap,$=class{constructor(e,r){this.x=e,this.y=r}_setWindowSize(e){this._WINDOW_SIZE=e,la.delete(this)}hasEvenY(){return this.y%Ce===H}static fromCompressedHex(e){let r=e.length===32,n=Te(r?e:e.subarray(1));if(!ha(n))throw new Error("Point is not on curve");let i=Oo(n),a=ql(i),s=(a&nt)===nt;r?s&&(a=R(-a)):(e[0]&1)===1!==s&&(a=R(-a));let o=new $(n,a);return o.assertValidity(),o}static fromUncompressedHex(e){let r=Te(e.subarray(1,Zt+1)),n=Te(e.subarray(Zt+1,Zt*2+1)),i=new $(r,n);return i.assertValidity(),i}static fromHex(e){let r=ur(e),n=r.length,i=r[0];if(n===Zt)return this.fromCompressedHex(r);if(n===Uo&&(i===2||i===3))return this.fromCompressedHex(r);if(n===Fo&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${Uo} compressed bytes or ${Fo} uncompressed bytes, not ${n}`)}static fromPrivateKey(e){return $.BASE.multiply(Ln(e))}static fromSignature(e,r,n){let{r:i,s:a}=Ho(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let s=ya(ur(e)),{n:o}=ct,f=n===2||n===3?i+o:i,c=hr(f,o),u=R(-s*c,o),h=R(a*c,o),l=n&1?"03":"02",d=$.fromHex(l+sr(f)),p=$.BASE.multiplyAndAddUnsafe(d,u,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(e=!1){return Me(this.toHex(e))}toHex(e=!1){let r=sr(this.x);return e?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${sr(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let e="Point is not on elliptic curve",{x:r,y:n}=this;if(!ha(r)||!ha(n))throw new Error(e);let i=R(n*n),a=Oo(r);if(R(i-a)!==H)throw new Error(e)}equals(e){return this.x===e.x&&this.y===e.y}negate(){return new $(this.x,R(-this.y))}double(){return Z.fromAffine(this).double().toAffine()}add(e){return Z.fromAffine(this).add(Z.fromAffine(e)).toAffine()}subtract(e){return this.add(e.negate())}multiply(e){return Z.fromAffine(this).multiply(e,this).toAffine()}multiplyAndAddUnsafe(e,r,n){let i=Z.fromAffine(this),a=r===H||r===nt||this!==$.BASE?i.multiplyUnsafe(r):i.multiply(r),s=Z.fromAffine(e).multiplyUnsafe(n),o=a.add(s);return o.equals(Z.ZERO)?void 0:o.toAffine()}};$.BASE=new $(ct.Gx,ct.Gy);$.ZERO=new $(H,H);function Vo(t){return Number.parseInt(t[0],16)>=8?"00"+t:t}function qo(t){if(t.length<2||t[0]!==2)throw new Error(`Invalid signature integer tag: ${cr(t)}`);let e=t[1],r=t.subarray(2,e+2);if(!e||r.length!==e)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:Te(r),left:t.subarray(e+2)}}function Ol(t){if(t.length<2||t[0]!=48)throw new Error(`Invalid signature tag: ${cr(t)}`);if(t[1]!==t.length-2)throw new Error("Invalid signature: incorrect length");let{data:e,left:r}=qo(t.subarray(2)),{data:n,left:i}=qo(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${cr(i)}`);return{r:e,s:n}}var ae=class{constructor(e,r){this.r=e,this.s=r,this.assertValidity()}static fromCompact(e){let r=e instanceof Uint8Array,n="Signature.fromCompact";if(typeof e!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?cr(e):e;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new ae(Nn(i.slice(0,64)),Nn(i.slice(64,128)))}static fromDER(e){let r=e instanceof Uint8Array;if(typeof e!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=Ol(r?e:Me(e));return new ae(n,i)}static fromHex(e){return this.fromDER(e)}assertValidity(){let{r:e,s:r}=this;if(!Ur(e))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Ur(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let e=ct.n>>nt;return this.s>e}normalizeS(){return this.hasHighS()?new ae(this.r,R(-this.s,ct.n)):this}toDERRawBytes(){return Me(this.toDERHex())}toDERHex(){let e=Vo(Lr(this.s)),r=Vo(Lr(this.r)),n=e.length/2,i=r.length/2,a=Lr(n),s=Lr(i);return`30${Lr(i+n+4)}02${s}${r}02${a}${e}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return Me(this.toCompactHex())}toCompactHex(){return sr(this.r)+sr(this.s)}};function Ae(...t){if(!t.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(t.length===1)return t[0];let e=t.reduce((n,i)=>n+i.length,0),r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let a=t[n];r.set(a,i),i+=a.length}return r}var Ml=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function cr(t){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");let e="";for(let r=0;r<t.length;r++)e+=Ml[t[r]];return e}var Vl=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function sr(t){if(typeof t!="bigint")throw new Error("Expected bigint");if(!(H<=t&&t<Vl))throw new Error("Expected number 0 <= n < 2^256");return t.toString(16).padStart(64,"0")}function pa(t){let e=Me(sr(t));if(e.length!==32)throw new Error("Error: expected 32 bytes");return e}function Lr(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function Nn(t){if(typeof t!="string")throw new TypeError("hexToNumber: expected string, got "+typeof t);return BigInt(`0x${t}`)}function Me(t){if(typeof t!="string")throw new TypeError("hexToBytes: expected string, got "+typeof t);if(t.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+t.length);let e=new Uint8Array(t.length/2);for(let r=0;r<e.length;r++){let n=r*2,i=t.slice(n,n+2),a=Number.parseInt(i,16);if(Number.isNaN(a)||a<0)throw new Error("Invalid byte sequence");e[r]=a}return e}function Te(t){return Nn(cr(t))}function ur(t){return t instanceof Uint8Array?Uint8Array.from(t):Me(t)}function zo(t){if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)return BigInt(t);if(typeof t=="bigint"&&Ur(t))return t;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function R(t,e=ct.P){let r=t%e;return r>=H?r:e+r}function Ut(t,e){let{P:r}=ct,n=t;for(;e-- >H;)n*=n,n%=r;return n}function ql(t){let{P:e}=ct,r=BigInt(6),n=BigInt(11),i=BigInt(22),a=BigInt(23),s=BigInt(44),o=BigInt(88),f=t*t*t%e,c=f*f*t%e,u=Ut(c,Pr)*c%e,h=Ut(u,Pr)*c%e,l=Ut(h,Ce)*f%e,d=Ut(l,n)*l%e,p=Ut(d,i)*d%e,g=Ut(p,s)*p%e,v=Ut(g,o)*g%e,m=Ut(v,s)*p%e,w=Ut(m,Pr)*c%e,A=Ut(w,a)*d%e,N=Ut(A,r)*f%e,T=Ut(N,Ce);if(T*T%e!==t)throw new Error("Cannot find square root");return T}function hr(t,e=ct.P){if(t===H||e<=H)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=R(t,e),n=e,i=H,a=nt,s=nt,o=H;for(;r!==H;){let c=n/r,u=n%r,h=i-s*c,l=a-o*c;n=r,r=u,i=s,a=o,s=h,o=l}if(n!==nt)throw new Error("invert: does not exist");return R(i,e)}function zl(t,e=ct.P){let r=new Array(t.length),n=t.reduce((a,s,o)=>s===H?a:(r[o]=a,R(a*s,e)),nt),i=hr(n,e);return t.reduceRight((a,s,o)=>s===H?a:(r[o]=R(a*r[o],e),R(a*s,e)),i),r}function Hl(t){let e=t.length*8-fr*8,r=Te(t);return e>0?r>>BigInt(e):r}function ya(t,e=!1){let r=Hl(t);if(e)return r;let{n}=ct;return r>=n?r-n:r}var or,Kr,da=class{constructor(e,r){if(this.hashLen=e,this.qByteLen=r,typeof e!="number"||e<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(e).fill(1),this.k=new Uint8Array(e).fill(0),this.counter=0}hmac(...e){return Yt.hmacSha256(this.k,...e)}hmacSync(...e){return Kr(this.k,...e)}checkSync(){if(typeof Kr!="function")throw new Dn("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(e=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),e),this.v=await this.hmac(this.v),e.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),e),this.v=await this.hmac(this.v))}reseedSync(e=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),e),this.v=this.hmacSync(this.v),e.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),e),this.v=this.hmacSync(this.v))}async generate(){this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=await this.hmac(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return Ae(...r)}generateSync(){this.checkSync(),this.incr();let e=0,r=[];for(;e<this.qByteLen;){this.v=this.hmacSync(this.v);let n=this.v.slice();r.push(n),e+=this.v.length}return Ae(...r)}};function Ur(t){return H<t&&t<ct.n}function ha(t){return H<t&&t<ct.P}function Gl(t,e,r,n=!0){let{n:i}=ct,a=ya(t,!0);if(!Ur(a))return;let s=hr(a,i),o=$.BASE.multiply(a),f=R(o.x,i);if(f===H)return;let c=R(s*R(e+r*f,i),i);if(c===H)return;let u=new ae(f,c),h=(o.x===u.r?0:2)|Number(o.y&nt);return n&&u.hasHighS()&&(u=u.normalizeS(),h^=1),{sig:u,recovery:h}}function Ln(t){let e;if(typeof t=="bigint")e=t;else if(typeof t=="number"&&Number.isSafeInteger(t)&&t>0)e=BigInt(t);else if(typeof t=="string"){if(t.length!==2*fr)throw new Error("Expected 32 bytes of private key");e=Nn(t)}else if(t instanceof Uint8Array){if(t.length!==fr)throw new Error("Expected 32 bytes of private key");e=Te(t)}else throw new TypeError("Expected valid private key");if(!Ur(e))throw new Error("Expected private key: 0 < key < n");return e}function Wl(t){return t instanceof $?(t.assertValidity(),t):$.fromHex(t)}function Ho(t){if(t instanceof ae)return t.assertValidity(),t;try{return ae.fromDER(t)}catch{return ae.fromCompact(t)}}function ga(t,e=!1){return $.fromPrivateKey(t).toRawBytes(e)}function Go(t){let e=t.length>Zt?t.slice(0,Zt):t;return Te(e)}function Zl(t){let e=Go(t),r=R(e,ct.n);return Wo(r<H?e:r)}function Wo(t){return pa(t)}function Yl(t,e,r){if(t==null)throw new Error(`sign: expected valid message hash, not "${t}"`);let n=ur(t),i=Ln(e),a=[Wo(i),Zl(n)];if(r!=null){r===!0&&(r=Yt.randomBytes(Zt));let f=ur(r);if(f.length!==Zt)throw new Error(`sign: Expected ${Zt} bytes of extra data`);a.push(f)}let s=Ae(...a),o=Go(n);return{seed:s,m:o,d:i}}function $l(t,e){let{sig:r,recovery:n}=t,{der:i,recovered:a}=Object.assign({canonical:!0,der:!0},e),s=i?r.toDERRawBytes():r.toCompactRawBytes();return a?[s,n]:s}async function Zo(t,e,r={}){let{seed:n,m:i,d:a}=Yl(t,e,r.extraEntropy),s=new da(Fl,fr);await s.reseed(n);let o;for(;!(o=Gl(await s.generate(),i,a,r.canonical));)await s.reseed();return $l(o,r)}var Ql={strict:!0};function Yo(t,e,r,n=Ql){let i;try{i=Ho(t),e=ur(e)}catch{return!1}let{r:a,s}=i;if(n.strict&&i.hasHighS())return!1;let o=ya(e),f;try{f=Wl(r)}catch{return!1}let{n:c}=ct,u=hr(s,c),h=R(o*u,c),l=R(a*u,c),d=$.BASE.multiplyAndAddUnsafe(f,h,l);return d?R(d.x,c)===a:!1}$.BASE._setWindowSize(8);var Dt={node:Ul,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var kn={},Yt={bytesToHex:cr,hexToBytes:Me,concatBytes:Ae,mod:R,invert:hr,isValidPrivateKey(t){try{return Ln(t),!0}catch{return!1}},_bigintTo32Bytes:pa,_normalizePrivateKey:Ln,hashToPrivateKey:t=>{t=ur(t);let e=fr+8;if(t.length<e||t.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=R(Te(t),ct.n-nt)+nt;return pa(r)},randomBytes:(t=32)=>{if(Dt.web)return Dt.web.getRandomValues(new Uint8Array(t));if(Dt.node){let{randomBytes:e}=Dt.node;return Uint8Array.from(e(t))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Yt.hashToPrivateKey(Yt.randomBytes(fr+8)),precompute(t=8,e=$.BASE){let r=e===$.BASE?e:new $(e.x,e.y);return r._setWindowSize(t),r.multiply(Pr),r},sha256:async(...t)=>{if(Dt.web){let e=await Dt.web.subtle.digest("SHA-256",Ae(...t));return new Uint8Array(e)}else if(Dt.node){let{createHash:e}=Dt.node,r=e("sha256");return t.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(t,...e)=>{if(Dt.web){let r=await Dt.web.subtle.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=Ae(...e),i=await Dt.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(Dt.node){let{createHmac:r}=Dt.node,n=r("sha256",t);return e.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(t,...e)=>{let r=kn[t];if(r===void 0){let n=await Yt.sha256(Uint8Array.from(t,i=>i.charCodeAt(0)));r=Ae(n,n),kn[t]=r}return Yt.sha256(r,...e)},taggedHashSync:(t,...e)=>{if(typeof or!="function")throw new Dn("sha256Sync is undefined, you need to set it");let r=kn[t];if(r===void 0){let n=or(Uint8Array.from(t,i=>i.charCodeAt(0)));r=Ae(n,n),kn[t]=r}return or(r,...e)},_JacobianPoint:Z};Object.defineProperties(Yt,{sha256Sync:{configurable:!1,get(){return or},set(t){or||(or=t)}},hmacSha256Sync:{configurable:!1,get(){return Kr},set(t){Kr||(Kr=t)}}});function lr(t){if(isNaN(t)||t<=0)throw new U("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Yt.randomBytes(t)}var l1=it(ln(),1),xa=it(X(),1);function $o(t,e){return e.map(r=>kt(t[r]))}function Qo(t){return xa.default.pki.setRsaPrivateKey(...$o(t,["n","e","d","p","q","dp","dq","qi"]))}function Xo(t){return xa.default.pki.setRsaPublicKey(...$o(t,["n","e"]))}var Ve={};ut(Ve,{jwkToPkcs1:()=>jl,jwkToPkix:()=>ep,pkcs1ToJwk:()=>Jl,pkixToJwk:()=>tp});var y1=it(Er(),1),g1=it(ln(),1);var le=it(X(),1);function Jl(t){let e=le.default.asn1.fromDer(ot(t,"ascii")),r=le.default.pki.privateKeyFromAsn1(e);return{kty:"RSA",n:Wt(r.n),e:Wt(r.e),d:Wt(r.d),p:Wt(r.p),q:Wt(r.q),dp:Wt(r.dP),dq:Wt(r.dQ),qi:Wt(r.qInv),alg:"RS256"}}function jl(t){if(t.n==null||t.e==null||t.d==null||t.p==null||t.q==null||t.dp==null||t.dq==null||t.qi==null)throw new U("JWK was missing components","ERR_INVALID_PARAMETERS");let e=le.default.pki.privateKeyToAsn1({n:kt(t.n),e:kt(t.e),d:kt(t.d),p:kt(t.p),q:kt(t.q),dP:kt(t.dp),dQ:kt(t.dq),qInv:kt(t.qi)});return St(le.default.asn1.toDer(e).getBytes(),"ascii")}function tp(t){let e=le.default.asn1.fromDer(ot(t,"ascii")),r=le.default.pki.publicKeyFromAsn1(e);return{kty:"RSA",n:Wt(r.n),e:Wt(r.e)}}function ep(t){if(t.n==null||t.e==null)throw new U("JWK was missing components","ERR_INVALID_PARAMETERS");let e=le.default.pki.publicKeyToAsn1({n:kt(t.n),e:kt(t.e)});return St(le.default.asn1.toDer(e).getBytes(),"ascii")}async function Jo(t){let e=await lt.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:t,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await ef(e);return{privateKey:r[0],publicKey:r[1]}}async function va(t){let r=[await lt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await rp(t)],n=await ef({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function jo(t,e){let r=await lt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await lt.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(e));return new Uint8Array(n,0,n.byteLength)}async function tf(t,e,r){let n=await lt.get().subtle.importKey("jwk",t,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return lt.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,e,r)}async function ef(t){if(t.privateKey==null||t.publicKey==null)throw new U("Private and public key are required","ERR_INVALID_PARAMETERS");return Promise.all([lt.get().subtle.exportKey("jwk",t.privateKey),lt.get().subtle.exportKey("jwk",t.publicKey)])}async function rp(t){return lt.get().subtle.importKey("jwk",{kty:t.kty,n:t.n,e:t.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function rf(t,e,r,n){let i=e?Xo(t):Qo(t),a=ot(Uint8Array.from(r),"ascii"),s=n(a,i);return St(s,"ascii")}function nf(t,e){return rf(t,!0,e,(r,n)=>n.encrypt(r))}function af(t,e){return rf(t,!1,e,(r,n)=>n.decrypt(r))}var Or=class{_key;constructor(e){this._key=e}async verify(e,r){return tf(this._key,r,e)}marshal(){return Ve.jwkToPkix(this._key)}get bytes(){return Ht.encode({Type:et.RSA,Data:this.marshal()}).subarray()}encrypt(e){return nf(this._key,e)}equals(e){return Vt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Rt.digest(this.bytes);return e}},pr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r}genSecret(){return lr(16)}async sign(e){return jo(this._key,e)}get public(){if(this._publicKey==null)throw new U("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Or(this._publicKey)}decrypt(e){return af(this._key,e)}marshal(){return Ve.jwkToPkcs1(this._key)}get bytes(){return Gt.encode({Type:et.RSA,Data:this.marshal()}).subarray()}equals(e){return Vt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Rt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return ot(e,"base58btc")}async export(e,r="pkcs-8"){if(r==="pkcs-8"){let n=new Fr.default.util.ByteBuffer(this.marshal()),i=Fr.default.asn1.fromDer(n),a=Fr.default.pki.privateKeyFromAsn1(i),s={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return Fr.default.pki.encryptRsaPrivateKey(a,e,s)}else{if(r==="libp2p-key")return er(this.bytes,e);throw new U(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function ip(t){let e=Ve.pkcs1ToJwk(t),r=await va(e);return new pr(r.privateKey,r.publicKey)}function ap(t){let e=Ve.pkixToJwk(t);return new Or(e)}async function sp(t){let e=await va(t);return new pr(e.privateKey,e.publicKey)}async function op(t){let e=await Jo(t);return new pr(e.privateKey,e.publicKey)}var wa={};ut(wa,{Secp256k1PrivateKey:()=>Vr,Secp256k1PublicKey:()=>Mr,generateKeyPair:()=>hp,unmarshalSecp256k1PrivateKey:()=>cp,unmarshalSecp256k1PublicKey:()=>up});function sf(){return Yt.randomPrivateKey()}async function of(t,e){let{digest:r}=await Rt.digest(e);try{return await Zo(r,t)}catch(n){throw new U(String(n),"ERR_INVALID_INPUT")}}async function ff(t,e,r){try{let{digest:n}=await Rt.digest(r);return Yo(e,n,t)}catch(n){throw new U(String(n),"ERR_INVALID_INPUT")}}function cf(t){return $.fromHex(t).toRawBytes(!0)}function uf(t){try{ga(t,!0)}catch(e){throw new U(String(e),"ERR_INVALID_PRIVATE_KEY")}}function ba(t){try{$.fromHex(t)}catch(e){throw new U(String(e),"ERR_INVALID_PUBLIC_KEY")}}function hf(t){try{return ga(t,!0)}catch(e){throw new U(String(e),"ERR_INVALID_PRIVATE_KEY")}}var Mr=class{_key;constructor(e){ba(e),this._key=e}async verify(e,r){return ff(this._key,r,e)}marshal(){return cf(this._key)}get bytes(){return Ht.encode({Type:et.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Vt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Rt.digest(this.bytes);return e}},Vr=class{_key;_publicKey;constructor(e,r){this._key=e,this._publicKey=r??hf(e),uf(this._key),ba(this._publicKey)}async sign(e){return of(this._key,e)}get public(){return new Mr(this._publicKey)}marshal(){return this._key}get bytes(){return Gt.encode({Type:et.Secp256k1,Data:this.marshal()}).subarray()}equals(e){return Vt(this.bytes,e.bytes)}async hash(){let{bytes:e}=await Rt.digest(this.bytes);return e}async id(){let e=await this.public.hash();return ot(e,"base58btc")}async export(e,r="libp2p-key"){if(r==="libp2p-key")return er(this.bytes,e);throw new U(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function cp(t){return new Vr(t)}function up(t){return new Mr(t)}async function hp(){let t=sf();return new Vr(t)}var se={rsa:ma,ed25519:oa,secp256k1:wa};function Sa(t){let e=Object.keys(se).join(" / ");return new U(`invalid or unsupported key type ${t}. Must be ${e}`,"ERR_UNSUPPORTED_KEY_TYPE")}function Ea(t){if(t=t.toLowerCase(),t==="rsa"||t==="ed25519"||t==="secp256k1")return se[t];throw Sa(t)}async function lp(t,e){return Ea(t).generateKeyPair(e??2048)}async function pp(t,e,r){if(t.toLowerCase()!=="ed25519")throw new U("Seed key derivation is unimplemented for RSA or secp256k1","ERR_UNSUPPORTED_KEY_DERIVATION_TYPE");return sa(e)}function dp(t){let e=Ht.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case et.RSA:return se.rsa.unmarshalRsaPublicKey(r);case et.Ed25519:return se.ed25519.unmarshalEd25519PublicKey(r);case et.Secp256k1:return se.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw Sa(e.Type??"RSA")}}function yp(t,e){return e=(e??"rsa").toLowerCase(),Ea(e),t.bytes}async function lf(t){let e=Gt.decode(t),r=e.Data??new Uint8Array;switch(e.Type){case et.RSA:return se.rsa.unmarshalRsaPrivateKey(r);case et.Ed25519:return se.ed25519.unmarshalEd25519PrivateKey(r);case et.Secp256k1:return se.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw Sa(e.Type??"RSA")}}function gp(t,e){return e=(e??"rsa").toLowerCase(),Ea(e),t.bytes}async function xp(t,e){try{let i=await To(t,e);return await lf(i)}catch{}let r=Pn.default.pki.decryptRsaPrivateKey(t,e);if(r===null)throw new U("Cannot read the key, most likely the password is wrong or not a RSA key","ERR_CANNOT_DECRYPT_PEM");let n=Pn.default.asn1.toDer(Pn.default.pki.privateKeyToAsn1(r));return n=St(n.getBytes(),"ascii"),se.rsa.unmarshalRsaPrivateKey(n)}var df=it(Ei(),1),yf=it(ht(),1),pf={sha1:"sha1","sha2-256":"sha256","sha2-512":"sha512"};function Aa(t,e,r,n,i){if(i!=="sha1"&&i!=="sha2-256"&&i!=="sha2-512"){let o=Object.keys(pf).join(" / ");throw new U(`Hash '${i}' is unknown or not supported. Must be ${o}`,"ERR_UNSUPPORTED_HASH_TYPE")}let a=pf[i],s=(0,df.default)(t,e,r,n,a);return yf.default.encode64(s,null)}return wf(vp);})();
/*! Bundled license information:

@noble/ed25519/lib/esm/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
return Libp2PCrypto}));
