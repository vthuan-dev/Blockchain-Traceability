(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.ChainsafeLibp2PNoise = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var ChainsafeLibp2PNoise=(()=>{var wh=Object.create;var ai=Object.defineProperty;var Eh=Object.getOwnPropertyDescriptor;var Sh=Object.getOwnPropertyNames;var Bh=Object.getPrototypeOf,Ah=Object.prototype.hasOwnProperty;var Co=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var k=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),Ht=(e,t)=>{for(var r in t)ai(e,r,{get:t[r],enumerable:!0})},To=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of Sh(t))!Ah.call(e,i)&&i!==r&&ai(e,i,{get:()=>t[i],enumerable:!(n=Eh(t,i))||n.enumerable});return e};var gt=(e,t,r)=>(r=e!=null?wh(Bh(e)):{},To(t||!e||!e.__esModule?ai(r,"default",{value:e,enumerable:!0}):r,e)),_h=e=>To(ai({},"__esModule",{value:!0}),e);var Ko=k((Og,Do)=>{"use strict";function ko(e,t){for(let r in t)Object.defineProperty(e,r,{value:t[r],enumerable:!0,configurable:!0});return e}function Kh(e,t,r){if(!e||typeof e=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof t=="object"&&(r=t,t=""),t&&(r.code=t);try{return ko(e,r)}catch{r.message=e.message,r.stack=e.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(e)),ko(new i,r)}}Do.exports=Kh});var Vo=k(Ss=>{"use strict";Object.defineProperty(Ss,"__esModule",{value:!0});function qh(e){return typeof e.saveState<"u"&&typeof e.restoreState<"u"&&typeof e.cleanSavedState<"u"}Ss.isSerializableHash=qh});var li=k(qr=>{"use strict";Object.defineProperty(qr,"__esModule",{value:!0});function zh(e,t,r){return~(e-1)&t|e-1&r}qr.select=zh;function Gh(e,t){return(e|0)-(t|0)-1>>>31&1}qr.lessOrEqual=Gh;function qo(e,t){if(e.length!==t.length)return 0;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 1&r-1>>>8}qr.compare=qo;function Wh(e,t){return e.length===0||t.length===0?!1:qo(e,t)!==0}qr.equal=Wh});var _e=k(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});function Yh(e){for(var t=0;t<e.length;t++)e[t]=0;return e}Bs.wipe=Yh});var Go=k(Bn=>{"use strict";Object.defineProperty(Bn,"__esModule",{value:!0});var Ce=Vo(),$h=li(),Xh=_e(),zo=function(){function e(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),Ce.isSerializableHash(this._inner)&&Ce.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Xh.wipe(n)}return e.prototype.reset=function(){if(!Ce.isSerializableHash(this._inner)||!Ce.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){Ce.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),Ce.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(t){return this._inner.update(t),this},e.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},e.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},e.prototype.saveState=function(){if(!Ce.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(t){if(!Ce.isSerializableHash(this._inner)||!Ce.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(t){if(!Ce.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},e}();Bn.HMAC=zo;function Zh(e,t,r){var n=new zo(e,t);n.update(r);var i=n.digest();return n.clean(),i}Bn.hmac=Zh;Bn.equal=$h.equal});var $o=k(As=>{"use strict";Object.defineProperty(As,"__esModule",{value:!0});var Wo=Go(),Yo=_e(),Qh=function(){function e(t,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=i;var s=Wo.hmac(this._hash,n,r);this._hmac=new Wo.HMAC(t,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(t){for(var r=new Uint8Array(t),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},e.prototype.clean=function(){this._hmac.clean(),Yo.wipe(this._buffer),Yo.wipe(this._counter),this._bufpos=0},e}();As.HKDF=Qh});var Zo=k(pi=>{"use strict";Object.defineProperty(pi,"__esModule",{value:!0});pi.BrowserRandomSource=void 0;var Xo=65536,_s=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;let t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");let r=new Uint8Array(t);for(let n=0;n<r.length;n+=Xo)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,Xo)));return r}};pi.BrowserRandomSource=_s});var wr=k(()=>{});var Qo=k(di=>{"use strict";Object.defineProperty(di,"__esModule",{value:!0});di.NodeRandomSource=void 0;var Jh=_e(),Cs=class{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof Co<"u"){let t=wr();t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");let n=new Uint8Array(t);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,Jh.wipe)(r),n}};di.NodeRandomSource=Cs});var Jo=k(yi=>{"use strict";Object.defineProperty(yi,"__esModule",{value:!0});yi.SystemRandomSource=void 0;var jh=Zo(),tl=Qo(),Ts=class{constructor(){if(this.isAvailable=!1,this.name="",this._source=new jh.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new tl.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}};yi.SystemRandomSource=Ts});var jo=k(fe=>{"use strict";Object.defineProperty(fe,"__esModule",{value:!0});function el(e,t){var r=e>>>16&65535,n=e&65535,i=t>>>16&65535,s=t&65535;return n*s+(r*s+n*i<<16>>>0)|0}fe.mul=Math.imul||el;function rl(e,t){return e+t|0}fe.add=rl;function nl(e,t){return e-t|0}fe.sub=nl;function il(e,t){return e<<t|e>>>32-t}fe.rotl=il;function sl(e,t){return e<<32-t|e>>>t}fe.rotr=sl;function al(e){return typeof e=="number"&&isFinite(e)&&Math.floor(e)===e}fe.isInteger=Number.isInteger||al;fe.MAX_SAFE_INTEGER=9007199254740991;fe.isSafeInteger=function(e){return fe.isInteger(e)&&e>=-fe.MAX_SAFE_INTEGER&&e<=fe.MAX_SAFE_INTEGER}});var An=k(Y=>{"use strict";Object.defineProperty(Y,"__esModule",{value:!0});var t0=jo();function ol(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}Y.readInt16BE=ol;function fl(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}Y.readUint16BE=fl;function cl(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}Y.readInt16LE=cl;function ul(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}Y.readUint16LE=ul;function e0(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}Y.writeUint16BE=e0;Y.writeInt16BE=e0;function r0(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}Y.writeUint16LE=r0;Y.writeInt16LE=r0;function Is(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}Y.readInt32BE=Is;function Ls(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}Y.readUint32BE=Ls;function Rs(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}Y.readInt32LE=Rs;function Us(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}Y.readUint32LE=Us;function gi(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}Y.writeUint32BE=gi;Y.writeInt32BE=gi;function xi(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}Y.writeUint32LE=xi;Y.writeInt32LE=xi;function hl(e,t){t===void 0&&(t=0);var r=Is(e,t),n=Is(e,t+4);return r*4294967296+n-(n>>31)*4294967296}Y.readInt64BE=hl;function ll(e,t){t===void 0&&(t=0);var r=Ls(e,t),n=Ls(e,t+4);return r*4294967296+n}Y.readUint64BE=ll;function pl(e,t){t===void 0&&(t=0);var r=Rs(e,t),n=Rs(e,t+4);return n*4294967296+r-(r>>31)*4294967296}Y.readInt64LE=pl;function dl(e,t){t===void 0&&(t=0);var r=Us(e,t),n=Us(e,t+4);return n*4294967296+r}Y.readUint64LE=dl;function n0(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),gi(e/4294967296>>>0,t,r),gi(e>>>0,t,r+4),t}Y.writeUint64BE=n0;Y.writeInt64BE=n0;function i0(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),xi(e>>>0,t,r),xi(e/4294967296>>>0,t,r+4),t}Y.writeUint64LE=i0;Y.writeInt64LE=i0;function yl(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=e/8+r-1;s>=r;s--)n+=t[s]*i,i*=256;return n}Y.readUintBE=yl;function gl(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+e/8;s++)n+=t[s]*i,i*=256;return n}Y.readUintLE=gl;function xl(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!t0.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var i=1,s=e/8+n-1;s>=n;s--)r[s]=t/i&255,i*=256;return r}Y.writeUintBE=xl;function ml(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!t0.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+e/8;s++)r[s]=t/i&255,i*=256;return r}Y.writeUintLE=ml;function vl(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t)}Y.readFloat32BE=vl;function bl(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t,!0)}Y.readFloat32LE=bl;function wl(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t)}Y.readFloat64BE=wl;function El(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t,!0)}Y.readFloat64LE=El;function Sl(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e),t}Y.writeFloat32BE=Sl;function Bl(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e,!0),t}Y.writeFloat32LE=Bl;function Al(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e),t}Y.writeFloat64BE=Al;function _l(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e,!0),t}Y.writeFloat64LE=_l});var f0=k(jt=>{"use strict";Object.defineProperty(jt,"__esModule",{value:!0});jt.randomStringForEntropy=jt.randomString=jt.randomUint32=jt.randomBytes=jt.defaultRandomSource=void 0;var Cl=Jo(),Tl=An(),s0=_e();jt.defaultRandomSource=new Cl.SystemRandomSource;function Ns(e,t=jt.defaultRandomSource){return t.randomBytes(e)}jt.randomBytes=Ns;function Il(e=jt.defaultRandomSource){let t=Ns(4,e),r=(0,Tl.readUint32LE)(t);return(0,s0.wipe)(t),r}jt.randomUint32=Il;var a0="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function o0(e,t=a0,r=jt.defaultRandomSource){if(t.length<2)throw new Error("randomString charset is too short");if(t.length>256)throw new Error("randomString charset is too long");let n="",i=t.length,s=256-256%i;for(;e>0;){let a=Ns(Math.ceil(e*256/s),r);for(let o=0;o<a.length&&e>0;o++){let f=a[o];f<s&&(n+=t.charAt(f%i),e--)}(0,s0.wipe)(a)}return n}jt.randomString=o0;function Ll(e,t=a0,r=jt.defaultRandomSource){let n=Math.ceil(e/(Math.log(t.length)/Math.LN2));return o0(n,t,r)}jt.randomStringForEntropy=Ll});var l0=k(Tt=>{"use strict";Object.defineProperty(Tt,"__esModule",{value:!0});Tt.sharedKey=Tt.generateKeyPair=Tt.generateKeyPairFromSeed=Tt.scalarMultBase=Tt.scalarMult=Tt.SHARED_KEY_LENGTH=Tt.SECRET_KEY_LENGTH=Tt.PUBLIC_KEY_LENGTH=void 0;var Rl=f0(),Ul=_e();Tt.PUBLIC_KEY_LENGTH=32;Tt.SECRET_KEY_LENGTH=32;Tt.SHARED_KEY_LENGTH=32;function Te(e){let t=new Float64Array(16);if(e)for(let r=0;r<e.length;r++)t[r]=e[r];return t}var c0=new Uint8Array(32);c0[0]=9;var Nl=Te([56129,1]);function Ps(e){let t=1;for(let r=0;r<16;r++){let n=e[r]+t+65535;t=Math.floor(n/65536),e[r]=n-t*65536}e[0]+=t-1+37*(t-1)}function _n(e,t,r){let n=~(r-1);for(let i=0;i<16;i++){let s=n&(e[i]^t[i]);e[i]^=s,t[i]^=s}}function Pl(e,t){let r=Te(),n=Te();for(let i=0;i<16;i++)n[i]=t[i];Ps(n),Ps(n),Ps(n);for(let i=0;i<2;i++){r[0]=n[0]-65517;for(let a=1;a<15;a++)r[a]=n[a]-65535-(r[a-1]>>16&1),r[a-1]&=65535;r[15]=n[15]-32767-(r[14]>>16&1);let s=r[15]>>16&1;r[14]&=65535,_n(n,r,1-s)}for(let i=0;i<16;i++)e[2*i]=n[i]&255,e[2*i+1]=n[i]>>8}function kl(e,t){for(let r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function mi(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]+r[n]}function vi(e,t,r){for(let n=0;n<16;n++)e[n]=t[n]-r[n]}function qe(e,t,r){let n,i,s=0,a=0,o=0,f=0,c=0,u=0,h=0,l=0,d=0,p=0,y=0,x=0,m=0,b=0,w=0,C=0,B=0,A=0,L=0,R=0,D=0,O=0,G=0,z=0,rt=0,pt=0,F=0,V=0,S=0,H=0,xt=0,X=r[0],Z=r[1],Q=r[2],at=r[3],ot=r[4],ft=r[5],ct=r[6],ut=r[7],Gt=r[8],Wt=r[9],Yt=r[10],$t=r[11],Xt=r[12],Zt=r[13],Qt=r[14],Jt=r[15];n=t[0],s+=n*X,a+=n*Z,o+=n*Q,f+=n*at,c+=n*ot,u+=n*ft,h+=n*ct,l+=n*ut,d+=n*Gt,p+=n*Wt,y+=n*Yt,x+=n*$t,m+=n*Xt,b+=n*Zt,w+=n*Qt,C+=n*Jt,n=t[1],a+=n*X,o+=n*Z,f+=n*Q,c+=n*at,u+=n*ot,h+=n*ft,l+=n*ct,d+=n*ut,p+=n*Gt,y+=n*Wt,x+=n*Yt,m+=n*$t,b+=n*Xt,w+=n*Zt,C+=n*Qt,B+=n*Jt,n=t[2],o+=n*X,f+=n*Z,c+=n*Q,u+=n*at,h+=n*ot,l+=n*ft,d+=n*ct,p+=n*ut,y+=n*Gt,x+=n*Wt,m+=n*Yt,b+=n*$t,w+=n*Xt,C+=n*Zt,B+=n*Qt,A+=n*Jt,n=t[3],f+=n*X,c+=n*Z,u+=n*Q,h+=n*at,l+=n*ot,d+=n*ft,p+=n*ct,y+=n*ut,x+=n*Gt,m+=n*Wt,b+=n*Yt,w+=n*$t,C+=n*Xt,B+=n*Zt,A+=n*Qt,L+=n*Jt,n=t[4],c+=n*X,u+=n*Z,h+=n*Q,l+=n*at,d+=n*ot,p+=n*ft,y+=n*ct,x+=n*ut,m+=n*Gt,b+=n*Wt,w+=n*Yt,C+=n*$t,B+=n*Xt,A+=n*Zt,L+=n*Qt,R+=n*Jt,n=t[5],u+=n*X,h+=n*Z,l+=n*Q,d+=n*at,p+=n*ot,y+=n*ft,x+=n*ct,m+=n*ut,b+=n*Gt,w+=n*Wt,C+=n*Yt,B+=n*$t,A+=n*Xt,L+=n*Zt,R+=n*Qt,D+=n*Jt,n=t[6],h+=n*X,l+=n*Z,d+=n*Q,p+=n*at,y+=n*ot,x+=n*ft,m+=n*ct,b+=n*ut,w+=n*Gt,C+=n*Wt,B+=n*Yt,A+=n*$t,L+=n*Xt,R+=n*Zt,D+=n*Qt,O+=n*Jt,n=t[7],l+=n*X,d+=n*Z,p+=n*Q,y+=n*at,x+=n*ot,m+=n*ft,b+=n*ct,w+=n*ut,C+=n*Gt,B+=n*Wt,A+=n*Yt,L+=n*$t,R+=n*Xt,D+=n*Zt,O+=n*Qt,G+=n*Jt,n=t[8],d+=n*X,p+=n*Z,y+=n*Q,x+=n*at,m+=n*ot,b+=n*ft,w+=n*ct,C+=n*ut,B+=n*Gt,A+=n*Wt,L+=n*Yt,R+=n*$t,D+=n*Xt,O+=n*Zt,G+=n*Qt,z+=n*Jt,n=t[9],p+=n*X,y+=n*Z,x+=n*Q,m+=n*at,b+=n*ot,w+=n*ft,C+=n*ct,B+=n*ut,A+=n*Gt,L+=n*Wt,R+=n*Yt,D+=n*$t,O+=n*Xt,G+=n*Zt,z+=n*Qt,rt+=n*Jt,n=t[10],y+=n*X,x+=n*Z,m+=n*Q,b+=n*at,w+=n*ot,C+=n*ft,B+=n*ct,A+=n*ut,L+=n*Gt,R+=n*Wt,D+=n*Yt,O+=n*$t,G+=n*Xt,z+=n*Zt,rt+=n*Qt,pt+=n*Jt,n=t[11],x+=n*X,m+=n*Z,b+=n*Q,w+=n*at,C+=n*ot,B+=n*ft,A+=n*ct,L+=n*ut,R+=n*Gt,D+=n*Wt,O+=n*Yt,G+=n*$t,z+=n*Xt,rt+=n*Zt,pt+=n*Qt,F+=n*Jt,n=t[12],m+=n*X,b+=n*Z,w+=n*Q,C+=n*at,B+=n*ot,A+=n*ft,L+=n*ct,R+=n*ut,D+=n*Gt,O+=n*Wt,G+=n*Yt,z+=n*$t,rt+=n*Xt,pt+=n*Zt,F+=n*Qt,V+=n*Jt,n=t[13],b+=n*X,w+=n*Z,C+=n*Q,B+=n*at,A+=n*ot,L+=n*ft,R+=n*ct,D+=n*ut,O+=n*Gt,G+=n*Wt,z+=n*Yt,rt+=n*$t,pt+=n*Xt,F+=n*Zt,V+=n*Qt,S+=n*Jt,n=t[14],w+=n*X,C+=n*Z,B+=n*Q,A+=n*at,L+=n*ot,R+=n*ft,D+=n*ct,O+=n*ut,G+=n*Gt,z+=n*Wt,rt+=n*Yt,pt+=n*$t,F+=n*Xt,V+=n*Zt,S+=n*Qt,H+=n*Jt,n=t[15],C+=n*X,B+=n*Z,A+=n*Q,L+=n*at,R+=n*ot,D+=n*ft,O+=n*ct,G+=n*ut,z+=n*Gt,rt+=n*Wt,pt+=n*Yt,F+=n*$t,V+=n*Xt,S+=n*Zt,H+=n*Qt,xt+=n*Jt,s+=38*B,a+=38*A,o+=38*L,f+=38*R,c+=38*D,u+=38*O,h+=38*G,l+=38*z,d+=38*rt,p+=38*pt,y+=38*F,x+=38*V,m+=38*S,b+=38*H,w+=38*xt,i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=x+i+65535,i=Math.floor(n/65536),x=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=b+i+65535,i=Math.floor(n/65536),b=n-i*65536,n=w+i+65535,i=Math.floor(n/65536),w=n-i*65536,n=C+i+65535,i=Math.floor(n/65536),C=n-i*65536,s+=i-1+37*(i-1),i=1,n=s+i+65535,i=Math.floor(n/65536),s=n-i*65536,n=a+i+65535,i=Math.floor(n/65536),a=n-i*65536,n=o+i+65535,i=Math.floor(n/65536),o=n-i*65536,n=f+i+65535,i=Math.floor(n/65536),f=n-i*65536,n=c+i+65535,i=Math.floor(n/65536),c=n-i*65536,n=u+i+65535,i=Math.floor(n/65536),u=n-i*65536,n=h+i+65535,i=Math.floor(n/65536),h=n-i*65536,n=l+i+65535,i=Math.floor(n/65536),l=n-i*65536,n=d+i+65535,i=Math.floor(n/65536),d=n-i*65536,n=p+i+65535,i=Math.floor(n/65536),p=n-i*65536,n=y+i+65535,i=Math.floor(n/65536),y=n-i*65536,n=x+i+65535,i=Math.floor(n/65536),x=n-i*65536,n=m+i+65535,i=Math.floor(n/65536),m=n-i*65536,n=b+i+65535,i=Math.floor(n/65536),b=n-i*65536,n=w+i+65535,i=Math.floor(n/65536),w=n-i*65536,n=C+i+65535,i=Math.floor(n/65536),C=n-i*65536,s+=i-1+37*(i-1),e[0]=s,e[1]=a,e[2]=o,e[3]=f,e[4]=c,e[5]=u,e[6]=h,e[7]=l,e[8]=d,e[9]=p,e[10]=y,e[11]=x,e[12]=m,e[13]=b,e[14]=w,e[15]=C}function Cn(e,t){qe(e,t,t)}function Dl(e,t){let r=Te();for(let n=0;n<16;n++)r[n]=t[n];for(let n=253;n>=0;n--)Cn(r,r),n!==2&&n!==4&&qe(r,r,t);for(let n=0;n<16;n++)e[n]=r[n]}function ks(e,t){let r=new Uint8Array(32),n=new Float64Array(80),i=Te(),s=Te(),a=Te(),o=Te(),f=Te(),c=Te();for(let d=0;d<31;d++)r[d]=e[d];r[31]=e[31]&127|64,r[0]&=248,kl(n,t);for(let d=0;d<16;d++)s[d]=n[d];i[0]=o[0]=1;for(let d=254;d>=0;--d){let p=r[d>>>3]>>>(d&7)&1;_n(i,s,p),_n(a,o,p),mi(f,i,a),vi(i,i,a),mi(a,s,o),vi(s,s,o),Cn(o,f),Cn(c,i),qe(i,a,i),qe(a,s,f),mi(f,i,a),vi(i,i,a),Cn(s,i),vi(a,o,c),qe(i,a,Nl),mi(i,i,o),qe(a,a,i),qe(i,o,c),qe(o,s,n),Cn(s,f),_n(i,s,p),_n(a,o,p)}for(let d=0;d<16;d++)n[d+16]=i[d],n[d+32]=a[d],n[d+48]=s[d],n[d+64]=o[d];let u=n.subarray(32),h=n.subarray(16);Dl(u,u),qe(h,h,u);let l=new Uint8Array(32);return Pl(l,h),l}Tt.scalarMult=ks;function u0(e){return ks(e,c0)}Tt.scalarMultBase=u0;function h0(e){if(e.length!==Tt.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${Tt.SECRET_KEY_LENGTH} bytes`);let t=new Uint8Array(e);return{publicKey:u0(t),secretKey:t}}Tt.generateKeyPairFromSeed=h0;function Kl(e){let t=(0,Rl.randomBytes)(32,e),r=h0(t);return(0,Ul.wipe)(t),r}Tt.generateKeyPair=Kl;function Ml(e,t,r=!1){if(e.length!==Tt.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(t.length!==Tt.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");let n=ks(e,t);if(r){let i=0;for(let s=0;s<n.length;s++)i|=n[s];if(i===0)throw new Error("X25519: invalid shared key")}return n}Tt.sharedKey=Ml});var d0=k(tr=>{"use strict";Object.defineProperty(tr,"__esModule",{value:!0});var wi=An(),bi=_e();tr.DIGEST_LENGTH=32;tr.BLOCK_SIZE=64;var p0=function(){function e(){this.digestLength=tr.DIGEST_LENGTH,this.blockSize=tr.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return e.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},e.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},e.prototype.clean=function(){bi.wipe(this._buffer),bi.wipe(this._temp),this.reset()},e.prototype.update=function(t,r){if(r===void 0&&(r=t.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var n=0;if(this._bytesHashed+=r,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&r>0;)this._buffer[this._bufferLength++]=t[n++],r--;this._bufferLength===this.blockSize&&(Ds(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(r>=this.blockSize&&(n=Ds(this._temp,this._state,t,n,r),r%=this.blockSize);r>0;)this._buffer[this._bufferLength++]=t[n++],r--;return this},e.prototype.finish=function(t){if(!this._finished){var r=this._bytesHashed,n=this._bufferLength,i=r/536870912|0,s=r<<3,a=r%64<56?64:128;this._buffer[n]=128;for(var o=n+1;o<a-8;o++)this._buffer[o]=0;wi.writeUint32BE(i,this._buffer,a-8),wi.writeUint32BE(s,this._buffer,a-4),Ds(this._temp,this._state,this._buffer,0,a),this._finished=!0}for(var o=0;o<this.digestLength/4;o++)wi.writeUint32BE(this._state[o],t,o*4);return this},e.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},e.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},e.prototype.restoreState=function(t){return this._state.set(t.state),this._bufferLength=t.bufferLength,t.buffer&&this._buffer.set(t.buffer),this._bytesHashed=t.bytesHashed,this._finished=!1,this},e.prototype.cleanSavedState=function(t){bi.wipe(t.state),t.buffer&&bi.wipe(t.buffer),t.bufferLength=0,t.bytesHashed=0},e}();tr.SHA256=p0;var Fl=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function Ds(e,t,r,n,i){for(;i>=64;){for(var s=t[0],a=t[1],o=t[2],f=t[3],c=t[4],u=t[5],h=t[6],l=t[7],d=0;d<16;d++){var p=n+d*4;e[d]=wi.readUint32BE(r,p)}for(var d=16;d<64;d++){var y=e[d-2],x=(y>>>17|y<<32-17)^(y>>>19|y<<32-19)^y>>>10;y=e[d-15];var m=(y>>>7|y<<32-7)^(y>>>18|y<<32-18)^y>>>3;e[d]=(x+e[d-7]|0)+(m+e[d-16]|0)}for(var d=0;d<64;d++){var x=(((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))+(c&u^~c&h)|0)+(l+(Fl[d]+e[d]|0)|0)|0,m=((s>>>2|s<<32-2)^(s>>>13|s<<32-13)^(s>>>22|s<<32-22))+(s&a^s&o^a&o)|0;l=h,h=u,u=c,c=f+x|0,f=o,o=a,a=s,s=x+m|0}t[0]+=s,t[1]+=a,t[2]+=o,t[3]+=f,t[4]+=c,t[5]+=u,t[6]+=h,t[7]+=l,n+=64,i-=64}return n}function Ol(e){var t=new p0;t.update(e);var r=t.digest();return t.clean(),r}tr.hash=Ol});var g0=k(Ei=>{"use strict";Object.defineProperty(Ei,"__esModule",{value:!0});var te=An(),Ks=_e(),Hl=20;function Vl(e,t,r){for(var n=1634760805,i=857760878,s=2036477234,a=1797285236,o=r[3]<<24|r[2]<<16|r[1]<<8|r[0],f=r[7]<<24|r[6]<<16|r[5]<<8|r[4],c=r[11]<<24|r[10]<<16|r[9]<<8|r[8],u=r[15]<<24|r[14]<<16|r[13]<<8|r[12],h=r[19]<<24|r[18]<<16|r[17]<<8|r[16],l=r[23]<<24|r[22]<<16|r[21]<<8|r[20],d=r[27]<<24|r[26]<<16|r[25]<<8|r[24],p=r[31]<<24|r[30]<<16|r[29]<<8|r[28],y=t[3]<<24|t[2]<<16|t[1]<<8|t[0],x=t[7]<<24|t[6]<<16|t[5]<<8|t[4],m=t[11]<<24|t[10]<<16|t[9]<<8|t[8],b=t[15]<<24|t[14]<<16|t[13]<<8|t[12],w=n,C=i,B=s,A=a,L=o,R=f,D=c,O=u,G=h,z=l,rt=d,pt=p,F=y,V=x,S=m,H=b,xt=0;xt<Hl;xt+=2)w=w+L|0,F^=w,F=F>>>32-16|F<<16,G=G+F|0,L^=G,L=L>>>32-12|L<<12,C=C+R|0,V^=C,V=V>>>32-16|V<<16,z=z+V|0,R^=z,R=R>>>32-12|R<<12,B=B+D|0,S^=B,S=S>>>32-16|S<<16,rt=rt+S|0,D^=rt,D=D>>>32-12|D<<12,A=A+O|0,H^=A,H=H>>>32-16|H<<16,pt=pt+H|0,O^=pt,O=O>>>32-12|O<<12,B=B+D|0,S^=B,S=S>>>32-8|S<<8,rt=rt+S|0,D^=rt,D=D>>>32-7|D<<7,A=A+O|0,H^=A,H=H>>>32-8|H<<8,pt=pt+H|0,O^=pt,O=O>>>32-7|O<<7,C=C+R|0,V^=C,V=V>>>32-8|V<<8,z=z+V|0,R^=z,R=R>>>32-7|R<<7,w=w+L|0,F^=w,F=F>>>32-8|F<<8,G=G+F|0,L^=G,L=L>>>32-7|L<<7,w=w+R|0,H^=w,H=H>>>32-16|H<<16,rt=rt+H|0,R^=rt,R=R>>>32-12|R<<12,C=C+D|0,F^=C,F=F>>>32-16|F<<16,pt=pt+F|0,D^=pt,D=D>>>32-12|D<<12,B=B+O|0,V^=B,V=V>>>32-16|V<<16,G=G+V|0,O^=G,O=O>>>32-12|O<<12,A=A+L|0,S^=A,S=S>>>32-16|S<<16,z=z+S|0,L^=z,L=L>>>32-12|L<<12,B=B+O|0,V^=B,V=V>>>32-8|V<<8,G=G+V|0,O^=G,O=O>>>32-7|O<<7,A=A+L|0,S^=A,S=S>>>32-8|S<<8,z=z+S|0,L^=z,L=L>>>32-7|L<<7,C=C+D|0,F^=C,F=F>>>32-8|F<<8,pt=pt+F|0,D^=pt,D=D>>>32-7|D<<7,w=w+R|0,H^=w,H=H>>>32-8|H<<8,rt=rt+H|0,R^=rt,R=R>>>32-7|R<<7;te.writeUint32LE(w+n|0,e,0),te.writeUint32LE(C+i|0,e,4),te.writeUint32LE(B+s|0,e,8),te.writeUint32LE(A+a|0,e,12),te.writeUint32LE(L+o|0,e,16),te.writeUint32LE(R+f|0,e,20),te.writeUint32LE(D+c|0,e,24),te.writeUint32LE(O+u|0,e,28),te.writeUint32LE(G+h|0,e,32),te.writeUint32LE(z+l|0,e,36),te.writeUint32LE(rt+d|0,e,40),te.writeUint32LE(pt+p|0,e,44),te.writeUint32LE(F+y|0,e,48),te.writeUint32LE(V+x|0,e,52),te.writeUint32LE(S+m|0,e,56),te.writeUint32LE(H+b|0,e,60)}function y0(e,t,r,n,i){if(i===void 0&&(i=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,a;if(i===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),a=s.length-t.length,s.set(t,a)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=t,a=i}for(var o=new Uint8Array(64),f=0;f<r.length;f+=64){Vl(o,s,e);for(var c=f;c<f+64&&c<r.length;c++)n[c]=r[c]^o[c-f];zl(s,0,a)}return Ks.wipe(o),i===0&&Ks.wipe(s),n}Ei.streamXOR=y0;function ql(e,t,r,n){return n===void 0&&(n=0),Ks.wipe(r),y0(e,t,r,r,n)}Ei.stream=ql;function zl(e,t,r){for(var n=1;r--;)n=n+(e[t]&255)|0,e[t]=n&255,n>>>=8,t++;if(n>0)throw new Error("ChaCha: counter overflow")}});var m0=k(ze=>{"use strict";Object.defineProperty(ze,"__esModule",{value:!0});var Gl=li(),Si=_e();ze.DIGEST_LENGTH=16;var x0=function(){function e(t){this.digestLength=ze.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var r=t[0]|t[1]<<8;this._r[0]=r&8191;var n=t[2]|t[3]<<8;this._r[1]=(r>>>13|n<<3)&8191;var i=t[4]|t[5]<<8;this._r[2]=(n>>>10|i<<6)&7939;var s=t[6]|t[7]<<8;this._r[3]=(i>>>7|s<<9)&8191;var a=t[8]|t[9]<<8;this._r[4]=(s>>>4|a<<12)&255,this._r[5]=a>>>1&8190;var o=t[10]|t[11]<<8;this._r[6]=(a>>>14|o<<2)&8191;var f=t[12]|t[13]<<8;this._r[7]=(o>>>11|f<<5)&8065;var c=t[14]|t[15]<<8;this._r[8]=(f>>>8|c<<8)&8191,this._r[9]=c>>>5&127,this._pad[0]=t[16]|t[17]<<8,this._pad[1]=t[18]|t[19]<<8,this._pad[2]=t[20]|t[21]<<8,this._pad[3]=t[22]|t[23]<<8,this._pad[4]=t[24]|t[25]<<8,this._pad[5]=t[26]|t[27]<<8,this._pad[6]=t[28]|t[29]<<8,this._pad[7]=t[30]|t[31]<<8}return e.prototype._blocks=function(t,r,n){for(var i=this._fin?0:2048,s=this._h[0],a=this._h[1],o=this._h[2],f=this._h[3],c=this._h[4],u=this._h[5],h=this._h[6],l=this._h[7],d=this._h[8],p=this._h[9],y=this._r[0],x=this._r[1],m=this._r[2],b=this._r[3],w=this._r[4],C=this._r[5],B=this._r[6],A=this._r[7],L=this._r[8],R=this._r[9];n>=16;){var D=t[r+0]|t[r+1]<<8;s+=D&8191;var O=t[r+2]|t[r+3]<<8;a+=(D>>>13|O<<3)&8191;var G=t[r+4]|t[r+5]<<8;o+=(O>>>10|G<<6)&8191;var z=t[r+6]|t[r+7]<<8;f+=(G>>>7|z<<9)&8191;var rt=t[r+8]|t[r+9]<<8;c+=(z>>>4|rt<<12)&8191,u+=rt>>>1&8191;var pt=t[r+10]|t[r+11]<<8;h+=(rt>>>14|pt<<2)&8191;var F=t[r+12]|t[r+13]<<8;l+=(pt>>>11|F<<5)&8191;var V=t[r+14]|t[r+15]<<8;d+=(F>>>8|V<<8)&8191,p+=V>>>5|i;var S=0,H=S;H+=s*y,H+=a*(5*R),H+=o*(5*L),H+=f*(5*A),H+=c*(5*B),S=H>>>13,H&=8191,H+=u*(5*C),H+=h*(5*w),H+=l*(5*b),H+=d*(5*m),H+=p*(5*x),S+=H>>>13,H&=8191;var xt=S;xt+=s*x,xt+=a*y,xt+=o*(5*R),xt+=f*(5*L),xt+=c*(5*A),S=xt>>>13,xt&=8191,xt+=u*(5*B),xt+=h*(5*C),xt+=l*(5*w),xt+=d*(5*b),xt+=p*(5*m),S+=xt>>>13,xt&=8191;var X=S;X+=s*m,X+=a*x,X+=o*y,X+=f*(5*R),X+=c*(5*L),S=X>>>13,X&=8191,X+=u*(5*A),X+=h*(5*B),X+=l*(5*C),X+=d*(5*w),X+=p*(5*b),S+=X>>>13,X&=8191;var Z=S;Z+=s*b,Z+=a*m,Z+=o*x,Z+=f*y,Z+=c*(5*R),S=Z>>>13,Z&=8191,Z+=u*(5*L),Z+=h*(5*A),Z+=l*(5*B),Z+=d*(5*C),Z+=p*(5*w),S+=Z>>>13,Z&=8191;var Q=S;Q+=s*w,Q+=a*b,Q+=o*m,Q+=f*x,Q+=c*y,S=Q>>>13,Q&=8191,Q+=u*(5*R),Q+=h*(5*L),Q+=l*(5*A),Q+=d*(5*B),Q+=p*(5*C),S+=Q>>>13,Q&=8191;var at=S;at+=s*C,at+=a*w,at+=o*b,at+=f*m,at+=c*x,S=at>>>13,at&=8191,at+=u*y,at+=h*(5*R),at+=l*(5*L),at+=d*(5*A),at+=p*(5*B),S+=at>>>13,at&=8191;var ot=S;ot+=s*B,ot+=a*C,ot+=o*w,ot+=f*b,ot+=c*m,S=ot>>>13,ot&=8191,ot+=u*x,ot+=h*y,ot+=l*(5*R),ot+=d*(5*L),ot+=p*(5*A),S+=ot>>>13,ot&=8191;var ft=S;ft+=s*A,ft+=a*B,ft+=o*C,ft+=f*w,ft+=c*b,S=ft>>>13,ft&=8191,ft+=u*m,ft+=h*x,ft+=l*y,ft+=d*(5*R),ft+=p*(5*L),S+=ft>>>13,ft&=8191;var ct=S;ct+=s*L,ct+=a*A,ct+=o*B,ct+=f*C,ct+=c*w,S=ct>>>13,ct&=8191,ct+=u*b,ct+=h*m,ct+=l*x,ct+=d*y,ct+=p*(5*R),S+=ct>>>13,ct&=8191;var ut=S;ut+=s*R,ut+=a*L,ut+=o*A,ut+=f*B,ut+=c*C,S=ut>>>13,ut&=8191,ut+=u*w,ut+=h*b,ut+=l*m,ut+=d*x,ut+=p*y,S+=ut>>>13,ut&=8191,S=(S<<2)+S|0,S=S+H|0,H=S&8191,S=S>>>13,xt+=S,s=H,a=xt,o=X,f=Z,c=Q,u=at,h=ot,l=ft,d=ct,p=ut,r+=16,n-=16}this._h[0]=s,this._h[1]=a,this._h[2]=o,this._h[3]=f,this._h[4]=c,this._h[5]=u,this._h[6]=h,this._h[7]=l,this._h[8]=d,this._h[9]=p},e.prototype.finish=function(t,r){r===void 0&&(r=0);var n=new Uint16Array(10),i,s,a,o;if(this._leftover){for(o=this._leftover,this._buffer[o++]=1;o<16;o++)this._buffer[o]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(i=this._h[1]>>>13,this._h[1]&=8191,o=2;o<10;o++)this._h[o]+=i,i=this._h[o]>>>13,this._h[o]&=8191;for(this._h[0]+=i*5,i=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=i,i=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=i,n[0]=this._h[0]+5,i=n[0]>>>13,n[0]&=8191,o=1;o<10;o++)n[o]=this._h[o]+i,i=n[o]>>>13,n[o]&=8191;for(n[9]-=1<<13,s=(i^1)-1,o=0;o<10;o++)n[o]&=s;for(s=~s,o=0;o<10;o++)this._h[o]=this._h[o]&s|n[o];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,a=this._h[0]+this._pad[0],this._h[0]=a&65535,o=1;o<8;o++)a=(this._h[o]+this._pad[o]|0)+(a>>>16)|0,this._h[o]=a&65535;return t[r+0]=this._h[0]>>>0,t[r+1]=this._h[0]>>>8,t[r+2]=this._h[1]>>>0,t[r+3]=this._h[1]>>>8,t[r+4]=this._h[2]>>>0,t[r+5]=this._h[2]>>>8,t[r+6]=this._h[3]>>>0,t[r+7]=this._h[3]>>>8,t[r+8]=this._h[4]>>>0,t[r+9]=this._h[4]>>>8,t[r+10]=this._h[5]>>>0,t[r+11]=this._h[5]>>>8,t[r+12]=this._h[6]>>>0,t[r+13]=this._h[6]>>>8,t[r+14]=this._h[7]>>>0,t[r+15]=this._h[7]>>>8,this._finished=!0,this},e.prototype.update=function(t){var r=0,n=t.length,i;if(this._leftover){i=16-this._leftover,i>n&&(i=n);for(var s=0;s<i;s++)this._buffer[this._leftover+s]=t[r+s];if(n-=i,r+=i,this._leftover+=i,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(n>=16&&(i=n-n%16,this._blocks(t,r,i),r+=i,n-=i),n){for(var s=0;s<n;s++)this._buffer[this._leftover+s]=t[r+s];this._leftover+=n}return this},e.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var t=new Uint8Array(16);return this.finish(t),t},e.prototype.clean=function(){return Si.wipe(this._buffer),Si.wipe(this._r),Si.wipe(this._h),Si.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},e}();ze.Poly1305=x0;function Wl(e,t){var r=new x0(e);r.update(t);var n=r.digest();return r.clean(),n}ze.oneTimeAuth=Wl;function Yl(e,t){return e.length!==ze.DIGEST_LENGTH||t.length!==ze.DIGEST_LENGTH?!1:Gl.equal(e,t)}ze.equal=Yl});var Ms=k(Ge=>{"use strict";Object.defineProperty(Ge,"__esModule",{value:!0});var Bi=g0(),$l=m0(),Tn=_e(),v0=An(),Xl=li();Ge.KEY_LENGTH=32;Ge.NONCE_LENGTH=12;Ge.TAG_LENGTH=16;var b0=new Uint8Array(16),Zl=function(){function e(t){if(this.nonceLength=Ge.NONCE_LENGTH,this.tagLength=Ge.TAG_LENGTH,t.length!==Ge.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(t)}return e.prototype.seal=function(t,r,n,i){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var s=new Uint8Array(16);s.set(t,s.length-t.length);var a=new Uint8Array(32);Bi.stream(this._key,s,a,4);var o=r.length+this.tagLength,f;if(i){if(i.length!==o)throw new Error("ChaCha20Poly1305: incorrect destination length");f=i}else f=new Uint8Array(o);return Bi.streamXOR(this._key,s,r,f,4),this._authenticate(f.subarray(f.length-this.tagLength,f.length),a,f.subarray(0,f.length-this.tagLength),n),Tn.wipe(s),f},e.prototype.open=function(t,r,n,i){if(t.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(r.length<this.tagLength)return null;var s=new Uint8Array(16);s.set(t,s.length-t.length);var a=new Uint8Array(32);Bi.stream(this._key,s,a,4);var o=new Uint8Array(this.tagLength);if(this._authenticate(o,a,r.subarray(0,r.length-this.tagLength),n),!Xl.equal(o,r.subarray(r.length-this.tagLength,r.length)))return null;var f=r.length-this.tagLength,c;if(i){if(i.length!==f)throw new Error("ChaCha20Poly1305: incorrect destination length");c=i}else c=new Uint8Array(f);return Bi.streamXOR(this._key,s,r.subarray(0,r.length-this.tagLength),c,4),Tn.wipe(s),c},e.prototype.clean=function(){return Tn.wipe(this._key),this},e.prototype._authenticate=function(t,r,n,i){var s=new $l.Poly1305(r);i&&(s.update(i),i.length%16>0&&s.update(b0.subarray(i.length%16))),s.update(n),n.length%16>0&&s.update(b0.subarray(n.length%16));var a=new Uint8Array(8);i&&v0.writeUint64LE(i.length,a),s.update(a),v0.writeUint64LE(n.length,a),s.update(a);for(var o=s.digest(),f=0;f<o.length;f++)t[f]=o[f];s.clean(),Tn.wipe(o),Tn.wipe(a)},e}();Ge.ChaCha20Poly1305=Zl});var U0=k((Lx,R0)=>{"use strict";R0.exports=Jl;function Jl(e,t){for(var r=new Array(arguments.length-1),n=0,i=2,s=!0;i<arguments.length;)r[n++]=arguments[i++];return new Promise(function(o,f){r[n]=function(u){if(s)if(s=!1,u)f(u);else{for(var h=new Array(arguments.length-1),l=0;l<h.length;)h[l++]=arguments[l];o.apply(null,h)}};try{e.apply(t||null,r)}catch(c){s&&(s=!1,f(c))}})}});var D0=k(k0=>{"use strict";var _i=k0;_i.length=function(t){var r=t.length;if(!r)return 0;for(var n=0;--r%4>1&&t.charAt(r)==="=";)++n;return Math.ceil(t.length*3)/4-n};var Wr=new Array(64),P0=new Array(123);for(me=0;me<64;)P0[Wr[me]=me<26?me+65:me<52?me+71:me<62?me-4:me-59|43]=me++;var me;_i.encode=function(t,r,n){for(var i=null,s=[],a=0,o=0,f;r<n;){var c=t[r++];switch(o){case 0:s[a++]=Wr[c>>2],f=(c&3)<<4,o=1;break;case 1:s[a++]=Wr[f|c>>4],f=(c&15)<<2,o=2;break;case 2:s[a++]=Wr[f|c>>6],s[a++]=Wr[c&63],o=0;break}a>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,s)),a=0)}return o&&(s[a++]=Wr[f],s[a++]=61,o===1&&(s[a++]=61)),i?(a&&i.push(String.fromCharCode.apply(String,s.slice(0,a))),i.join("")):String.fromCharCode.apply(String,s.slice(0,a))};var N0="invalid encoding";_i.decode=function(t,r,n){for(var i=n,s=0,a,o=0;o<t.length;){var f=t.charCodeAt(o++);if(f===61&&s>1)break;if((f=P0[f])===void 0)throw Error(N0);switch(s){case 0:a=f,s=1;break;case 1:r[n++]=a<<2|(f&48)>>4,a=f,s=2;break;case 2:r[n++]=(a&15)<<4|(f&60)>>2,a=f,s=3;break;case 3:r[n++]=(a&3)<<6|f,s=0;break}}if(s===1)throw Error(N0);return n-i};_i.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}});var M0=k((Ux,K0)=>{"use strict";K0.exports=Ci;function Ci(){this._listeners={}}Ci.prototype.on=function(t,r,n){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:r,ctx:n||this}),this};Ci.prototype.off=function(t,r){if(t===void 0)this._listeners={};else if(r===void 0)this._listeners[t]=[];else for(var n=this._listeners[t],i=0;i<n.length;)n[i].fn===r?n.splice(i,1):++i;return this};Ci.prototype.emit=function(t){var r=this._listeners[t];if(r){for(var n=[],i=1;i<arguments.length;)n.push(arguments[i++]);for(i=0;i<r.length;)r[i].fn.apply(r[i++].ctx,n)}return this}});var G0=k((Nx,z0)=>{"use strict";z0.exports=F0(F0);function F0(e){return typeof Float32Array<"u"?function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),n=r[3]===128;function i(f,c,u){t[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3]}function s(f,c,u){t[0]=f,c[u]=r[3],c[u+1]=r[2],c[u+2]=r[1],c[u+3]=r[0]}e.writeFloatLE=n?i:s,e.writeFloatBE=n?s:i;function a(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],t[0]}function o(f,c){return r[3]=f[c],r[2]=f[c+1],r[1]=f[c+2],r[0]=f[c+3],t[0]}e.readFloatLE=n?a:o,e.readFloatBE=n?o:a}():function(){function t(n,i,s,a){var o=i<0?1:0;if(o&&(i=-i),i===0)n(1/i>0?0:2147483648,s,a);else if(isNaN(i))n(2143289344,s,a);else if(i>34028234663852886e22)n((o<<31|2139095040)>>>0,s,a);else if(i<11754943508222875e-54)n((o<<31|Math.round(i/1401298464324817e-60))>>>0,s,a);else{var f=Math.floor(Math.log(i)/Math.LN2),c=Math.round(i*Math.pow(2,-f)*8388608)&8388607;n((o<<31|f+127<<23|c)>>>0,s,a)}}e.writeFloatLE=t.bind(null,O0),e.writeFloatBE=t.bind(null,H0);function r(n,i,s){var a=n(i,s),o=(a>>31)*2+1,f=a>>>23&255,c=a&8388607;return f===255?c?NaN:o*(1/0):f===0?o*1401298464324817e-60*c:o*Math.pow(2,f-150)*(c+8388608)}e.readFloatLE=r.bind(null,V0),e.readFloatBE=r.bind(null,q0)}(),typeof Float64Array<"u"?function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),n=r[7]===128;function i(f,c,u){t[0]=f,c[u]=r[0],c[u+1]=r[1],c[u+2]=r[2],c[u+3]=r[3],c[u+4]=r[4],c[u+5]=r[5],c[u+6]=r[6],c[u+7]=r[7]}function s(f,c,u){t[0]=f,c[u]=r[7],c[u+1]=r[6],c[u+2]=r[5],c[u+3]=r[4],c[u+4]=r[3],c[u+5]=r[2],c[u+6]=r[1],c[u+7]=r[0]}e.writeDoubleLE=n?i:s,e.writeDoubleBE=n?s:i;function a(f,c){return r[0]=f[c],r[1]=f[c+1],r[2]=f[c+2],r[3]=f[c+3],r[4]=f[c+4],r[5]=f[c+5],r[6]=f[c+6],r[7]=f[c+7],t[0]}function o(f,c){return r[7]=f[c],r[6]=f[c+1],r[5]=f[c+2],r[4]=f[c+3],r[3]=f[c+4],r[2]=f[c+5],r[1]=f[c+6],r[0]=f[c+7],t[0]}e.readDoubleLE=n?a:o,e.readDoubleBE=n?o:a}():function(){function t(n,i,s,a,o,f){var c=a<0?1:0;if(c&&(a=-a),a===0)n(0,o,f+i),n(1/a>0?0:2147483648,o,f+s);else if(isNaN(a))n(0,o,f+i),n(2146959360,o,f+s);else if(a>17976931348623157e292)n(0,o,f+i),n((c<<31|2146435072)>>>0,o,f+s);else{var u;if(a<22250738585072014e-324)u=a/5e-324,n(u>>>0,o,f+i),n((c<<31|u/4294967296)>>>0,o,f+s);else{var h=Math.floor(Math.log(a)/Math.LN2);h===1024&&(h=1023),u=a*Math.pow(2,-h),n(u*4503599627370496>>>0,o,f+i),n((c<<31|h+1023<<20|u*1048576&1048575)>>>0,o,f+s)}}}e.writeDoubleLE=t.bind(null,O0,0,4),e.writeDoubleBE=t.bind(null,H0,4,0);function r(n,i,s,a,o){var f=n(a,o+i),c=n(a,o+s),u=(c>>31)*2+1,h=c>>>20&2047,l=4294967296*(c&1048575)+f;return h===2047?l?NaN:u*(1/0):h===0?u*5e-324*l:u*Math.pow(2,h-1075)*(l+4503599627370496)}e.readDoubleLE=r.bind(null,V0,0,4),e.readDoubleBE=r.bind(null,q0,4,0)}(),e}function O0(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function H0(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=e&255}function V0(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function q0(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}});var W0=k((exports,module)=>{"use strict";module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}});var $0=k(Y0=>{"use strict";var Vs=Y0;Vs.length=function(t){for(var r=0,n=0,i=0;i<t.length;++i)n=t.charCodeAt(i),n<128?r+=1:n<2048?r+=2:(n&64512)===55296&&(t.charCodeAt(i+1)&64512)===56320?(++i,r+=4):r+=3;return r};Vs.read=function(t,r,n){var i=n-r;if(i<1)return"";for(var s=null,a=[],o=0,f;r<n;)f=t[r++],f<128?a[o++]=f:f>191&&f<224?a[o++]=(f&31)<<6|t[r++]&63:f>239&&f<365?(f=((f&7)<<18|(t[r++]&63)<<12|(t[r++]&63)<<6|t[r++]&63)-65536,a[o++]=55296+(f>>10),a[o++]=56320+(f&1023)):a[o++]=(f&15)<<12|(t[r++]&63)<<6|t[r++]&63,o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),o=0);return s?(o&&s.push(String.fromCharCode.apply(String,a.slice(0,o))),s.join("")):String.fromCharCode.apply(String,a.slice(0,o))};Vs.write=function(t,r,n){for(var i=n,s,a,o=0;o<t.length;++o)s=t.charCodeAt(o),s<128?r[n++]=s:s<2048?(r[n++]=s>>6|192,r[n++]=s&63|128):(s&64512)===55296&&((a=t.charCodeAt(o+1))&64512)===56320?(s=65536+((s&1023)<<10)+(a&1023),++o,r[n++]=s>>18|240,r[n++]=s>>12&63|128,r[n++]=s>>6&63|128,r[n++]=s&63|128):(r[n++]=s>>12|224,r[n++]=s>>6&63|128,r[n++]=s&63|128);return n-i}});var Z0=k((kx,X0)=>{"use strict";X0.exports=jl;function jl(e,t,r){var n=r||8192,i=n>>>1,s=null,a=n;return function(f){if(f<1||f>i)return e(f);a+f>n&&(s=e(n),a=0);var c=t.call(s,a,a+=f);return a&7&&(a=(a|7)+1),c}}});var J0=k((Dx,Q0)=>{"use strict";Q0.exports=kt;var Rn=Br();function kt(e,t){this.lo=e>>>0,this.hi=t>>>0}var Sr=kt.zero=new kt(0,0);Sr.toNumber=function(){return 0};Sr.zzEncode=Sr.zzDecode=function(){return this};Sr.length=function(){return 1};var tp=kt.zeroHash="\0\0\0\0\0\0\0\0";kt.fromNumber=function(t){if(t===0)return Sr;var r=t<0;r&&(t=-t);var n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new kt(n,i)};kt.from=function(t){if(typeof t=="number")return kt.fromNumber(t);if(Rn.isString(t))if(Rn.Long)t=Rn.Long.fromString(t);else return kt.fromNumber(parseInt(t,10));return t.low||t.high?new kt(t.low>>>0,t.high>>>0):Sr};kt.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var r=~this.lo+1>>>0,n=~this.hi>>>0;return r||(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296};kt.prototype.toLong=function(t){return Rn.Long?new Rn.Long(this.lo|0,this.hi|0,!!t):{low:this.lo|0,high:this.hi|0,unsigned:!!t}};var er=String.prototype.charCodeAt;kt.fromHash=function(t){return t===tp?Sr:new kt((er.call(t,0)|er.call(t,1)<<8|er.call(t,2)<<16|er.call(t,3)<<24)>>>0,(er.call(t,4)|er.call(t,5)<<8|er.call(t,6)<<16|er.call(t,7)<<24)>>>0)};kt.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)};kt.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this};kt.prototype.zzDecode=function(){var t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this};kt.prototype.length=function(){var t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}});var Br=k(qs=>{"use strict";var K=qs;K.asPromise=U0();K.base64=D0();K.EventEmitter=M0();K.float=G0();K.inquire=W0();K.utf8=$0();K.pool=Z0();K.LongBits=J0();K.isNode=!!(typeof globalThis<"u"&&globalThis&&globalThis.process&&globalThis.process.versions&&globalThis.process.versions.node);K.global=K.isNode&&globalThis||typeof window<"u"&&window||typeof self<"u"&&self||qs;K.emptyArray=Object.freeze?Object.freeze([]):[];K.emptyObject=Object.freeze?Object.freeze({}):{};K.isInteger=Number.isInteger||function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t};K.isString=function(t){return typeof t=="string"||t instanceof String};K.isObject=function(t){return t&&typeof t=="object"};K.isset=K.isSet=function(t,r){var n=t[r];return n!=null&&t.hasOwnProperty(r)?typeof n!="object"||(Array.isArray(n)?n.length:Object.keys(n).length)>0:!1};K.Buffer=function(){try{var e=K.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch{return null}}();K._Buffer_from=null;K._Buffer_allocUnsafe=null;K.newBuffer=function(t){return typeof t=="number"?K.Buffer?K._Buffer_allocUnsafe(t):new K.Array(t):K.Buffer?K._Buffer_from(t):typeof Uint8Array>"u"?t:new Uint8Array(t)};K.Array=typeof Uint8Array<"u"?Uint8Array:Array;K.Long=K.global.dcodeIO&&K.global.dcodeIO.Long||K.global.Long||K.inquire("long");K.key2Re=/^true|false|0|1$/;K.key32Re=/^-?(?:0|[1-9][0-9]*)$/;K.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/;K.longToHash=function(t){return t?K.LongBits.from(t).toHash():K.LongBits.zeroHash};K.longFromHash=function(t,r){var n=K.LongBits.fromHash(t);return K.Long?K.Long.fromBits(n.lo,n.hi,r):n.toNumber(!!r)};function j0(e,t,r){for(var n=Object.keys(t),i=0;i<n.length;++i)(e[n[i]]===void 0||!r)&&(e[n[i]]=t[n[i]]);return e}K.merge=j0;K.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)};function tf(e){function t(r,n){if(!(this instanceof t))return new t(r,n);Object.defineProperty(this,"message",{get:function(){return r}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:new Error().stack||""}),n&&j0(this,n)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}K.newError=tf;K.ProtocolError=tf("ProtocolError");K.oneOfGetter=function(t){for(var r={},n=0;n<t.length;++n)r[t[n]]=1;return function(){for(var i=Object.keys(this),s=i.length-1;s>-1;--s)if(r[i[s]]===1&&this[i[s]]!==void 0&&this[i[s]]!==null)return i[s]}};K.oneOfSetter=function(t){return function(r){for(var n=0;n<t.length;++n)t[n]!==r&&delete this[t[n]]}};K.toJSONOptions={longs:String,enums:String,bytes:String,json:!0};K._configure=function(){var e=K.Buffer;if(!e){K._Buffer_from=K._Buffer_allocUnsafe=null;return}K._Buffer_from=e.from!==Uint8Array.from&&e.from||function(r,n){return new e(r,n)},K._Buffer_allocUnsafe=e.allocUnsafe||function(r){return new e(r)}}});var Ws=k((Mx,af)=>{"use strict";af.exports=Rt;var Ie=Br(),Gs,nf=Ie.LongBits,ep=Ie.utf8;function ve(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function Rt(e){this.buf=e,this.pos=0,this.len=e.length}var ef=typeof Uint8Array<"u"?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new Rt(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new Rt(t);throw Error("illegal buffer")},sf=function(){return Ie.Buffer?function(r){return(Rt.create=function(i){return Ie.Buffer.isBuffer(i)?new Gs(i):ef(i)})(r)}:ef};Rt.create=sf();Rt.prototype._slice=Ie.Array.prototype.subarray||Ie.Array.prototype.slice;Rt.prototype.uint32=function(){var t=4294967295;return function(){if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,ve(this,10);return t}}();Rt.prototype.int32=function(){return this.uint32()|0};Rt.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(t&1)|0};function zs(){var e=new nf(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw ve(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<t*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<t*7)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw ve(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<t*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}Rt.prototype.bool=function(){return this.uint32()!==0};function Ti(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}Rt.prototype.fixed32=function(){if(this.pos+4>this.len)throw ve(this,4);return Ti(this.buf,this.pos+=4)};Rt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw ve(this,4);return Ti(this.buf,this.pos+=4)|0};function rf(){if(this.pos+8>this.len)throw ve(this,8);return new nf(Ti(this.buf,this.pos+=4),Ti(this.buf,this.pos+=4))}Rt.prototype.float=function(){if(this.pos+4>this.len)throw ve(this,4);var t=Ie.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t};Rt.prototype.double=function(){if(this.pos+8>this.len)throw ve(this,4);var t=Ie.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t};Rt.prototype.bytes=function(){var t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw ve(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(r,n):r===n?new this.buf.constructor(0):this._slice.call(this.buf,r,n)};Rt.prototype.string=function(){var t=this.bytes();return ep.read(t,0,t.length)};Rt.prototype.skip=function(t){if(typeof t=="number"){if(this.pos+t>this.len)throw ve(this,t);this.pos+=t}else do if(this.pos>=this.len)throw ve(this);while(this.buf[this.pos++]&128);return this};Rt.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this};Rt._configure=function(e){Gs=e,Rt.create=sf(),Gs._configure();var t=Ie.Long?"toLong":"toNumber";Ie.merge(Rt.prototype,{int64:function(){return zs.call(this)[t](!1)},uint64:function(){return zs.call(this)[t](!0)},sint64:function(){return zs.call(this).zzDecode()[t](!1)},fixed64:function(){return rf.call(this)[t](!0)},sfixed64:function(){return rf.call(this)[t](!1)}})}});var uf=k((Fx,cf)=>{"use strict";cf.exports=Ar;var ff=Ws();(Ar.prototype=Object.create(ff.prototype)).constructor=Ar;var of=Br();function Ar(e){ff.call(this,e)}Ar._configure=function(){of.Buffer&&(Ar.prototype._slice=of.Buffer.prototype.slice)};Ar.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))};Ar._configure()});var js=k((Ox,df)=>{"use strict";df.exports=nt;var le=Br(),Ys,Ii=le.LongBits,hf=le.base64,lf=le.utf8;function Un(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function Xs(){}function rp(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function nt(){this.len=0,this.head=new Un(Xs,0,0),this.tail=this.head,this.states=null}var pf=function(){return le.Buffer?function(){return(nt.create=function(){return new Ys})()}:function(){return new nt}};nt.create=pf();nt.alloc=function(t){return new le.Array(t)};le.Array!==Array&&(nt.alloc=le.pool(nt.alloc,le.Array.prototype.subarray));nt.prototype._push=function(t,r,n){return this.tail=this.tail.next=new Un(t,r,n),this.len+=r,this};function Zs(e,t,r){t[r]=e&255}function np(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}function Qs(e,t){this.len=e,this.next=void 0,this.val=t}Qs.prototype=Object.create(Un.prototype);Qs.prototype.fn=np;nt.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new Qs((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this};nt.prototype.int32=function(t){return t<0?this._push(Js,10,Ii.fromNumber(t)):this.uint32(t)};nt.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)};function Js(e,t,r){for(;e.hi;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}nt.prototype.uint64=function(t){var r=Ii.from(t);return this._push(Js,r.length(),r)};nt.prototype.int64=nt.prototype.uint64;nt.prototype.sint64=function(t){var r=Ii.from(t).zzEncode();return this._push(Js,r.length(),r)};nt.prototype.bool=function(t){return this._push(Zs,1,t?1:0)};function $s(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}nt.prototype.fixed32=function(t){return this._push($s,4,t>>>0)};nt.prototype.sfixed32=nt.prototype.fixed32;nt.prototype.fixed64=function(t){var r=Ii.from(t);return this._push($s,4,r.lo)._push($s,4,r.hi)};nt.prototype.sfixed64=nt.prototype.fixed64;nt.prototype.float=function(t){return this._push(le.float.writeFloatLE,4,t)};nt.prototype.double=function(t){return this._push(le.float.writeDoubleLE,8,t)};var ip=le.Array.prototype.set?function(t,r,n){r.set(t,n)}:function(t,r,n){for(var i=0;i<t.length;++i)r[n+i]=t[i]};nt.prototype.bytes=function(t){var r=t.length>>>0;if(!r)return this._push(Zs,1,0);if(le.isString(t)){var n=nt.alloc(r=hf.length(t));hf.decode(t,n,0),t=n}return this.uint32(r)._push(ip,r,t)};nt.prototype.string=function(t){var r=lf.length(t);return r?this.uint32(r)._push(lf.write,r,t):this._push(Zs,1,0)};nt.prototype.fork=function(){return this.states=new rp(this),this.head=this.tail=new Un(Xs,0,0),this.len=0,this};nt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Un(Xs,0,0),this.len=0),this};nt.prototype.ldelim=function(){var t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n&&(this.tail.next=t.next,this.tail=r,this.len+=n),this};nt.prototype.finish=function(){for(var t=this.head.next,r=this.constructor.alloc(this.len),n=0;t;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r};nt._configure=function(e){Ys=e,nt.create=pf(),Ys._configure()}});var xf=k((Hx,gf)=>{"use strict";gf.exports=Le;var yf=js();(Le.prototype=Object.create(yf.prototype)).constructor=Le;var rr=Br();function Le(){yf.call(this)}Le._configure=function(){Le.alloc=rr._Buffer_allocUnsafe,Le.writeBytesBuffer=rr.Buffer&&rr.Buffer.prototype instanceof Uint8Array&&rr.Buffer.prototype.set.name==="set"?function(t,r,n){r.set(t,n)}:function(t,r,n){if(t.copy)t.copy(r,n,0,t.length);else for(var i=0;i<t.length;)r[n++]=t[i++]}};Le.prototype.bytes=function(t){rr.isString(t)&&(t=rr._Buffer_from(t,"base64"));var r=t.length>>>0;return this.uint32(r),r&&this._push(Le.writeBytesBuffer,r,t),this};function sp(e,t,r){e.length<40?rr.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}Le.prototype.string=function(t){var r=rr.Buffer.byteLength(t);return this.uint32(r),r&&this._push(sp,r,t),this};Le._configure()});var dt=k((sm,Ef)=>{Ef.exports={options:{usePureJavaScript:!1}}});var Af=k((am,Bf)=>{var aa={};Bf.exports=aa;var Sf={};aa.encode=function(e,t,r){if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');if(r!==void 0&&typeof r!="number")throw new TypeError('"maxline" must be a number.');var n="";if(!(e instanceof Uint8Array))n=cp(e,t);else{var i=0,s=t.length,a=t.charAt(0),o=[0];for(i=0;i<e.length;++i){for(var f=0,c=e[i];f<o.length;++f)c+=o[f]<<8,o[f]=c%s,c=c/s|0;for(;c>0;)o.push(c%s),c=c/s|0}for(i=0;e[i]===0&&i<e.length-1;++i)n+=a;for(i=o.length-1;i>=0;--i)n+=t[o[i]]}if(r){var u=new RegExp(".{1,"+r+"}","g");n=n.match(u).join(`\r
`)}return n};aa.decode=function(e,t){if(typeof e!="string")throw new TypeError('"input" must be a string.');if(typeof t!="string")throw new TypeError('"alphabet" must be a string.');var r=Sf[t];if(!r){r=Sf[t]=[];for(var n=0;n<t.length;++n)r[t.charCodeAt(n)]=n}e=e.replace(/\s/g,"");for(var i=t.length,s=t.charAt(0),a=[0],n=0;n<e.length;n++){var o=r[e.charCodeAt(n)];if(o===void 0)return;for(var f=0,c=o;f<a.length;++f)c+=a[f]*i,a[f]=c&255,c>>=8;for(;c>0;)a.push(c&255),c>>=8}for(var u=0;e[u]===s&&u<e.length-1;++u)a.push(0);return typeof Buffer<"u"?Buffer.from(a.reverse()):new Uint8Array(a.reverse())};function cp(e,t){var r=0,n=t.length,i=t.charAt(0),s=[0];for(r=0;r<e.length();++r){for(var a=0,o=e.at(r);a<s.length;++a)o+=s[a]<<8,s[a]=o%n,o=o/n|0;for(;o>0;)s.push(o%n),o=o/n|0}var f="";for(r=0;e.at(r)===0&&r<e.length()-1;++r)f+=i;for(r=s.length-1;r>=0;--r)f+=t[s[r]];return f}});var Ut=k((om,If)=>{var _f=dt(),Cf=Af(),g=If.exports=_f.util=_f.util||{};(function(){if(typeof process<"u"&&process.nextTick&&!process.browser){g.nextTick=process.nextTick,typeof setImmediate=="function"?g.setImmediate=setImmediate:g.setImmediate=g.nextTick;return}if(typeof setImmediate=="function"){g.setImmediate=function(){return setImmediate.apply(void 0,arguments)},g.nextTick=function(o){return setImmediate(o)};return}if(g.setImmediate=function(o){setTimeout(o,0)},typeof window<"u"&&typeof window.postMessage=="function"){let o=function(f){if(f.source===window&&f.data===e){f.stopPropagation();var c=t.slice();t.length=0,c.forEach(function(u){u()})}};var a=o,e="forge.setImmediate",t=[];g.setImmediate=function(f){t.push(f),t.length===1&&window.postMessage(e,"*")},window.addEventListener("message",o,!0)}if(typeof MutationObserver<"u"){var r=Date.now(),n=!0,i=document.createElement("div"),t=[];new MutationObserver(function(){var f=t.slice();t.length=0,f.forEach(function(c){c()})}).observe(i,{attributes:!0});var s=g.setImmediate;g.setImmediate=function(f){Date.now()-r>15?(r=Date.now(),s(f)):(t.push(f),t.length===1&&i.setAttribute("a",n=!n))}}g.nextTick=g.setImmediate})();g.isNodejs=typeof process<"u"&&process.versions&&process.versions.node;g.globalScope=function(){return g.isNodejs?globalThis:typeof self>"u"?window:self}();g.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};g.isArrayBuffer=function(e){return typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer};g.isArrayBufferView=function(e){return e&&g.isArrayBuffer(e.buffer)&&e.byteLength!==void 0};function Nn(e){if(!(e===8||e===16||e===24||e===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+e)}g.ByteBuffer=oa;function oa(e){if(this.data="",this.read=0,typeof e=="string")this.data=e;else if(g.isArrayBuffer(e)||g.isArrayBufferView(e))if(typeof Buffer<"u"&&e instanceof Buffer)this.data=e.toString("binary");else{var t=new Uint8Array(e);try{this.data=String.fromCharCode.apply(null,t)}catch{for(var r=0;r<t.length;++r)this.putByte(t[r])}}else(e instanceof oa||typeof e=="object"&&typeof e.data=="string"&&typeof e.read=="number")&&(this.data=e.data,this.read=e.read);this._constructedStringLength=0}g.ByteStringBuffer=oa;var up=4096;g.ByteStringBuffer.prototype._optimizeConstructedString=function(e){this._constructedStringLength+=e,this._constructedStringLength>up&&(this.data.substr(0,1),this._constructedStringLength=0)};g.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};g.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};g.ByteStringBuffer.prototype.putByte=function(e){return this.putBytes(String.fromCharCode(e))};g.ByteStringBuffer.prototype.fillWithByte=function(e,t){e=String.fromCharCode(e);for(var r=this.data;t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return this.data=r,this._optimizeConstructedString(t),this};g.ByteStringBuffer.prototype.putBytes=function(e){return this.data+=e,this._optimizeConstructedString(e.length),this};g.ByteStringBuffer.prototype.putString=function(e){return this.putBytes(g.encodeUtf8(e))};g.ByteStringBuffer.prototype.putInt16=function(e){return this.putBytes(String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};g.ByteStringBuffer.prototype.putInt24=function(e){return this.putBytes(String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};g.ByteStringBuffer.prototype.putInt32=function(e){return this.putBytes(String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255))};g.ByteStringBuffer.prototype.putInt16Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255))};g.ByteStringBuffer.prototype.putInt24Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255))};g.ByteStringBuffer.prototype.putInt32Le=function(e){return this.putBytes(String.fromCharCode(e&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>24&255))};g.ByteStringBuffer.prototype.putInt=function(e,t){Nn(t);var r="";do t-=8,r+=String.fromCharCode(e>>t&255);while(t>0);return this.putBytes(r)};g.ByteStringBuffer.prototype.putSignedInt=function(e,t){return e<0&&(e+=2<<t-1),this.putInt(e,t)};g.ByteStringBuffer.prototype.putBuffer=function(e){return this.putBytes(e.getBytes())};g.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};g.ByteStringBuffer.prototype.getInt16=function(){var e=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,e};g.ByteStringBuffer.prototype.getInt24=function(){var e=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,e};g.ByteStringBuffer.prototype.getInt32=function(){var e=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,e};g.ByteStringBuffer.prototype.getInt16Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,e};g.ByteStringBuffer.prototype.getInt24Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,e};g.ByteStringBuffer.prototype.getInt32Le=function(){var e=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,e};g.ByteStringBuffer.prototype.getInt=function(e){Nn(e);var t=0;do t=(t<<8)+this.data.charCodeAt(this.read++),e-=8;while(e>0);return t};g.ByteStringBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};g.ByteStringBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};g.ByteStringBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};g.ByteStringBuffer.prototype.at=function(e){return this.data.charCodeAt(this.read+e)};g.ByteStringBuffer.prototype.setAt=function(e,t){return this.data=this.data.substr(0,this.read+e)+String.fromCharCode(t)+this.data.substr(this.read+e+1),this};g.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};g.ByteStringBuffer.prototype.copy=function(){var e=g.createBuffer(this.data);return e.read=this.read,e};g.ByteStringBuffer.prototype.compact=function(){return this.read>0&&(this.data=this.data.slice(this.read),this.read=0),this};g.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};g.ByteStringBuffer.prototype.truncate=function(e){var t=Math.max(0,this.length()-e);return this.data=this.data.substr(this.read,t),this.read=0,this};g.ByteStringBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.length;++t){var r=this.data.charCodeAt(t);r<16&&(e+="0"),e+=r.toString(16)}return e};g.ByteStringBuffer.prototype.toString=function(){return g.decodeUtf8(this.bytes())};function hp(e,t){t=t||{},this.read=t.readOffset||0,this.growSize=t.growSize||1024;var r=g.isArrayBuffer(e),n=g.isArrayBufferView(e);if(r||n){r?this.data=new DataView(e):this.data=new DataView(e.buffer,e.byteOffset,e.byteLength),this.write="writeOffset"in t?t.writeOffset:this.data.byteLength;return}this.data=new DataView(new ArrayBuffer(0)),this.write=0,e!=null&&this.putBytes(e),"writeOffset"in t&&(this.write=t.writeOffset)}g.DataBuffer=hp;g.DataBuffer.prototype.length=function(){return this.write-this.read};g.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};g.DataBuffer.prototype.accommodate=function(e,t){if(this.length()>=e)return this;t=Math.max(t||this.growSize,e);var r=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),n=new Uint8Array(this.length()+t);return n.set(r),this.data=new DataView(n.buffer),this};g.DataBuffer.prototype.putByte=function(e){return this.accommodate(1),this.data.setUint8(this.write++,e),this};g.DataBuffer.prototype.fillWithByte=function(e,t){this.accommodate(t);for(var r=0;r<t;++r)this.data.setUint8(e);return this};g.DataBuffer.prototype.putBytes=function(e,t){if(g.isArrayBufferView(e)){var r=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),n=r.byteLength-r.byteOffset;this.accommodate(n);var i=new Uint8Array(this.data.buffer,this.write);return i.set(r),this.write+=n,this}if(g.isArrayBuffer(e)){var r=new Uint8Array(e);this.accommodate(r.byteLength);var i=new Uint8Array(this.data.buffer);return i.set(r,this.write),this.write+=r.byteLength,this}if(e instanceof g.DataBuffer||typeof e=="object"&&typeof e.read=="number"&&typeof e.write=="number"&&g.isArrayBufferView(e.data)){var r=new Uint8Array(e.data.byteLength,e.read,e.length());this.accommodate(r.byteLength);var i=new Uint8Array(e.data.byteLength,this.write);return i.set(r),this.write+=r.byteLength,this}if(e instanceof g.ByteStringBuffer&&(e=e.data,t="binary"),t=t||"binary",typeof e=="string"){var s;if(t==="hex")return this.accommodate(Math.ceil(e.length/2)),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.hex.decode(e,s,this.write),this;if(t==="base64")return this.accommodate(Math.ceil(e.length/4)*3),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.base64.decode(e,s,this.write),this;if(t==="utf8"&&(e=g.encodeUtf8(e),t="binary"),t==="binary"||t==="raw")return this.accommodate(e.length),s=new Uint8Array(this.data.buffer,this.write),this.write+=g.binary.raw.decode(s),this;if(t==="utf16")return this.accommodate(e.length*2),s=new Uint16Array(this.data.buffer,this.write),this.write+=g.text.utf16.encode(s),this;throw new Error("Invalid encoding: "+t)}throw Error("Invalid parameter: "+e)};g.DataBuffer.prototype.putBuffer=function(e){return this.putBytes(e),e.clear(),this};g.DataBuffer.prototype.putString=function(e){return this.putBytes(e,"utf16")};g.DataBuffer.prototype.putInt16=function(e){return this.accommodate(2),this.data.setInt16(this.write,e),this.write+=2,this};g.DataBuffer.prototype.putInt24=function(e){return this.accommodate(3),this.data.setInt16(this.write,e>>8&65535),this.data.setInt8(this.write,e>>16&255),this.write+=3,this};g.DataBuffer.prototype.putInt32=function(e){return this.accommodate(4),this.data.setInt32(this.write,e),this.write+=4,this};g.DataBuffer.prototype.putInt16Le=function(e){return this.accommodate(2),this.data.setInt16(this.write,e,!0),this.write+=2,this};g.DataBuffer.prototype.putInt24Le=function(e){return this.accommodate(3),this.data.setInt8(this.write,e>>16&255),this.data.setInt16(this.write,e>>8&65535,!0),this.write+=3,this};g.DataBuffer.prototype.putInt32Le=function(e){return this.accommodate(4),this.data.setInt32(this.write,e,!0),this.write+=4,this};g.DataBuffer.prototype.putInt=function(e,t){Nn(t),this.accommodate(t/8);do t-=8,this.data.setInt8(this.write++,e>>t&255);while(t>0);return this};g.DataBuffer.prototype.putSignedInt=function(e,t){return Nn(t),this.accommodate(t/8),e<0&&(e+=2<<t-1),this.putInt(e,t)};g.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};g.DataBuffer.prototype.getInt16=function(){var e=this.data.getInt16(this.read);return this.read+=2,e};g.DataBuffer.prototype.getInt24=function(){var e=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,e};g.DataBuffer.prototype.getInt32=function(){var e=this.data.getInt32(this.read);return this.read+=4,e};g.DataBuffer.prototype.getInt16Le=function(){var e=this.data.getInt16(this.read,!0);return this.read+=2,e};g.DataBuffer.prototype.getInt24Le=function(){var e=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,e};g.DataBuffer.prototype.getInt32Le=function(){var e=this.data.getInt32(this.read,!0);return this.read+=4,e};g.DataBuffer.prototype.getInt=function(e){Nn(e);var t=0;do t=(t<<8)+this.data.getInt8(this.read++),e-=8;while(e>0);return t};g.DataBuffer.prototype.getSignedInt=function(e){var t=this.getInt(e),r=2<<e-2;return t>=r&&(t-=r<<1),t};g.DataBuffer.prototype.getBytes=function(e){var t;return e?(e=Math.min(this.length(),e),t=this.data.slice(this.read,this.read+e),this.read+=e):e===0?t="":(t=this.read===0?this.data:this.data.slice(this.read),this.clear()),t};g.DataBuffer.prototype.bytes=function(e){return typeof e>"u"?this.data.slice(this.read):this.data.slice(this.read,this.read+e)};g.DataBuffer.prototype.at=function(e){return this.data.getUint8(this.read+e)};g.DataBuffer.prototype.setAt=function(e,t){return this.data.setUint8(e,t),this};g.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};g.DataBuffer.prototype.copy=function(){return new g.DataBuffer(this)};g.DataBuffer.prototype.compact=function(){if(this.read>0){var e=new Uint8Array(this.data.buffer,this.read),t=new Uint8Array(e.byteLength);t.set(e),this.data=new DataView(t),this.write-=this.read,this.read=0}return this};g.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};g.DataBuffer.prototype.truncate=function(e){return this.write=Math.max(0,this.length()-e),this.read=Math.min(this.read,this.write),this};g.DataBuffer.prototype.toHex=function(){for(var e="",t=this.read;t<this.data.byteLength;++t){var r=this.data.getUint8(t);r<16&&(e+="0"),e+=r.toString(16)}return e};g.DataBuffer.prototype.toString=function(e){var t=new Uint8Array(this.data,this.read,this.length());if(e=e||"utf8",e==="binary"||e==="raw")return g.binary.raw.encode(t);if(e==="hex")return g.binary.hex.encode(t);if(e==="base64")return g.binary.base64.encode(t);if(e==="utf8")return g.text.utf8.decode(t);if(e==="utf16")return g.text.utf16.decode(t);throw new Error("Invalid encoding: "+e)};g.createBuffer=function(e,t){return t=t||"raw",e!==void 0&&t==="utf8"&&(e=g.encodeUtf8(e)),new g.ByteBuffer(e)};g.fillString=function(e,t){for(var r="";t>0;)t&1&&(r+=e),t>>>=1,t>0&&(e+=e);return r};g.xorBytes=function(e,t,r){for(var n="",i="",s="",a=0,o=0;r>0;--r,++a)i=e.charCodeAt(a)^t.charCodeAt(a),o>=10&&(n+=s,s="",o=0),s+=String.fromCharCode(i),++o;return n+=s,n};g.hexToBytes=function(e){var t="",r=0;for(e.length&!0&&(r=1,t+=String.fromCharCode(parseInt(e[0],16)));r<e.length;r+=2)t+=String.fromCharCode(parseInt(e.substr(r,2),16));return t};g.bytesToHex=function(e){return g.createBuffer(e).toHex()};g.int32ToBytes=function(e){return String.fromCharCode(e>>24&255)+String.fromCharCode(e>>16&255)+String.fromCharCode(e>>8&255)+String.fromCharCode(e&255)};var nr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ir=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],Tf="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";g.encode64=function(e,t){for(var r="",n="",i,s,a,o=0;o<e.length;)i=e.charCodeAt(o++),s=e.charCodeAt(o++),a=e.charCodeAt(o++),r+=nr.charAt(i>>2),r+=nr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=nr.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":nr.charAt(a&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};g.decode64=function(e){e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");for(var t="",r,n,i,s,a=0;a<e.length;)r=ir[e.charCodeAt(a++)-43],n=ir[e.charCodeAt(a++)-43],i=ir[e.charCodeAt(a++)-43],s=ir[e.charCodeAt(a++)-43],t+=String.fromCharCode(r<<2|n>>4),i!==64&&(t+=String.fromCharCode((n&15)<<4|i>>2),s!==64&&(t+=String.fromCharCode((i&3)<<6|s)));return t};g.encodeUtf8=function(e){return unescape(encodeURIComponent(e))};g.decodeUtf8=function(e){return decodeURIComponent(escape(e))};g.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:Cf.encode,decode:Cf.decode}};g.binary.raw.encode=function(e){return String.fromCharCode.apply(null,e)};g.binary.raw.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};g.binary.hex.encode=g.bytesToHex;g.binary.hex.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/2))),r=r||0;var i=0,s=r;for(e.length&1&&(i=1,n[s++]=parseInt(e[0],16));i<e.length;i+=2)n[s++]=parseInt(e.substr(i,2),16);return t?s-r:n};g.binary.base64.encode=function(e,t){for(var r="",n="",i,s,a,o=0;o<e.byteLength;)i=e[o++],s=e[o++],a=e[o++],r+=nr.charAt(i>>2),r+=nr.charAt((i&3)<<4|s>>4),isNaN(s)?r+="==":(r+=nr.charAt((s&15)<<2|a>>6),r+=isNaN(a)?"=":nr.charAt(a&63)),t&&r.length>t&&(n+=r.substr(0,t)+`\r
`,r=r.substr(t));return n+=r,n};g.binary.base64.decode=function(e,t,r){var n=t;n||(n=new Uint8Array(Math.ceil(e.length/4)*3)),e=e.replace(/[^A-Za-z0-9\+\/\=]/g,""),r=r||0;for(var i,s,a,o,f=0,c=r;f<e.length;)i=ir[e.charCodeAt(f++)-43],s=ir[e.charCodeAt(f++)-43],a=ir[e.charCodeAt(f++)-43],o=ir[e.charCodeAt(f++)-43],n[c++]=i<<2|s>>4,a!==64&&(n[c++]=(s&15)<<4|a>>2,o!==64&&(n[c++]=(a&3)<<6|o));return t?c-r:n.subarray(0,c)};g.binary.base58.encode=function(e,t){return g.binary.baseN.encode(e,Tf,t)};g.binary.base58.decode=function(e,t){return g.binary.baseN.decode(e,Tf,t)};g.text={utf8:{},utf16:{}};g.text.utf8.encode=function(e,t,r){e=g.encodeUtf8(e);var n=t;n||(n=new Uint8Array(e.length)),r=r||0;for(var i=r,s=0;s<e.length;++s)n[i++]=e.charCodeAt(s);return t?i-r:n};g.text.utf8.decode=function(e){return g.decodeUtf8(String.fromCharCode.apply(null,e))};g.text.utf16.encode=function(e,t,r){var n=t;n||(n=new Uint8Array(e.length*2));var i=new Uint16Array(n.buffer);r=r||0;for(var s=r,a=r,o=0;o<e.length;++o)i[a++]=e.charCodeAt(o),s+=2;return t?s-r:n};g.text.utf16.decode=function(e){return String.fromCharCode.apply(null,new Uint16Array(e.buffer))};g.deflate=function(e,t,r){if(t=g.decode64(e.deflate(g.encode64(t)).rval),r){var n=2,i=t.charCodeAt(1);i&32&&(n=6),t=t.substring(n,t.length-4)}return t};g.inflate=function(e,t,r){var n=e.inflate(g.encode64(t)).rval;return n===null?null:g.decode64(n)};var fa=function(e,t,r){if(!e)throw new Error("WebStorage not available.");var n;if(r===null?n=e.removeItem(t):(r=g.encode64(JSON.stringify(r)),n=e.setItem(t,r)),typeof n<"u"&&n.rval!==!0){var i=new Error(n.error.message);throw i.id=n.error.id,i.name=n.error.name,i}},ca=function(e,t){if(!e)throw new Error("WebStorage not available.");var r=e.getItem(t);if(e.init)if(r.rval===null){if(r.error){var n=new Error(r.error.message);throw n.id=r.error.id,n.name=r.error.name,n}r=null}else r=r.rval;return r!==null&&(r=JSON.parse(g.decode64(r))),r},lp=function(e,t,r,n){var i=ca(e,t);i===null&&(i={}),i[r]=n,fa(e,t,i)},pp=function(e,t,r){var n=ca(e,t);return n!==null&&(n=r in n?n[r]:null),n},dp=function(e,t,r){var n=ca(e,t);if(n!==null&&r in n){delete n[r];var i=!0;for(var s in n){i=!1;break}i&&(n=null),fa(e,t,n)}},yp=function(e,t){fa(e,t,null)},Ui=function(e,t,r){var n=null;typeof r>"u"&&(r=["web","flash"]);var i,s=!1,a=null;for(var o in r){i=r[o];try{if(i==="flash"||i==="both"){if(t[0]===null)throw new Error("Flash local storage not available.");n=e.apply(this,t),s=i==="flash"}(i==="web"||i==="both")&&(t[0]=localStorage,n=e.apply(this,t),s=!0)}catch(f){a=f}if(s)break}if(!s)throw a;return n};g.setItem=function(e,t,r,n,i){Ui(lp,arguments,i)};g.getItem=function(e,t,r,n){return Ui(pp,arguments,n)};g.removeItem=function(e,t,r,n){Ui(dp,arguments,n)};g.clearItems=function(e,t,r){Ui(yp,arguments,r)};g.isEmpty=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};g.format=function(e){for(var t=/%./g,r,n,i=0,s=[],a=0;r=t.exec(e);){n=e.substring(a,t.lastIndex-2),n.length>0&&s.push(n),a=t.lastIndex;var o=r[0][1];switch(o){case"s":case"o":i<arguments.length?s.push(arguments[i+++1]):s.push("<?>");break;case"%":s.push("%");break;default:s.push("<%"+o+"?>")}}return s.push(e.substring(a)),s.join("")};g.formatNumber=function(e,t,r,n){var i=e,s=isNaN(t=Math.abs(t))?2:t,a=r===void 0?",":r,o=n===void 0?".":n,f=i<0?"-":"",c=parseInt(i=Math.abs(+i||0).toFixed(s),10)+"",u=c.length>3?c.length%3:0;return f+(u?c.substr(0,u)+o:"")+c.substr(u).replace(/(\d{3})(?=\d)/g,"$1"+o)+(s?a+Math.abs(i-c).toFixed(s).slice(2):"")};g.formatSize=function(e){return e>=1073741824?e=g.formatNumber(e/1073741824,2,".","")+" GiB":e>=1048576?e=g.formatNumber(e/1048576,2,".","")+" MiB":e>=1024?e=g.formatNumber(e/1024,0)+" KiB":e=g.formatNumber(e,0)+" bytes",e};g.bytesFromIP=function(e){return e.indexOf(".")!==-1?g.bytesFromIPv4(e):e.indexOf(":")!==-1?g.bytesFromIPv6(e):null};g.bytesFromIPv4=function(e){if(e=e.split("."),e.length!==4)return null;for(var t=g.createBuffer(),r=0;r<e.length;++r){var n=parseInt(e[r],10);if(isNaN(n))return null;t.putByte(n)}return t.getBytes()};g.bytesFromIPv6=function(e){var t=0;e=e.split(":").filter(function(a){return a.length===0&&++t,!0});for(var r=(8-e.length+t)*2,n=g.createBuffer(),i=0;i<8;++i){if(!e[i]||e[i].length===0){n.fillWithByte(0,r),r=0;continue}var s=g.hexToBytes(e[i]);s.length<2&&n.putByte(0),n.putBytes(s)}return n.getBytes()};g.bytesToIP=function(e){return e.length===4?g.bytesToIPv4(e):e.length===16?g.bytesToIPv6(e):null};g.bytesToIPv4=function(e){if(e.length!==4)return null;for(var t=[],r=0;r<e.length;++r)t.push(e.charCodeAt(r));return t.join(".")};g.bytesToIPv6=function(e){if(e.length!==16)return null;for(var t=[],r=[],n=0,i=0;i<e.length;i+=2){for(var s=g.bytesToHex(e[i]+e[i+1]);s[0]==="0"&&s!=="0";)s=s.substr(1);if(s==="0"){var a=r[r.length-1],o=t.length;!a||o!==a.end+1?r.push({start:o,end:o}):(a.end=o,a.end-a.start>r[n].end-r[n].start&&(n=r.length-1))}t.push(s)}if(r.length>0){var f=r[n];f.end-f.start>0&&(t.splice(f.start,f.end-f.start+1,""),f.start===0&&t.unshift(""),f.end===7&&t.push(""))}return t.join(":")};g.estimateCores=function(e,t){if(typeof e=="function"&&(t=e,e={}),e=e||{},"cores"in g&&!e.update)return t(null,g.cores);if(typeof navigator<"u"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return g.cores=navigator.hardwareConcurrency,t(null,g.cores);if(typeof Worker>"u")return g.cores=1,t(null,g.cores);if(typeof Blob>"u")return g.cores=2,t(null,g.cores);var r=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(a){for(var o=Date.now(),f=o+4;Date.now()<f;);self.postMessage({st:o,et:f})})}.toString(),")()"],{type:"application/javascript"}));n([],5,16);function n(a,o,f){if(o===0){var c=Math.floor(a.reduce(function(u,h){return u+h},0)/a.length);return g.cores=Math.max(1,c),URL.revokeObjectURL(r),t(null,g.cores)}i(f,function(u,h){a.push(s(f,h)),n(a,o-1,f)})}function i(a,o){for(var f=[],c=[],u=0;u<a;++u){var h=new Worker(r);h.addEventListener("message",function(l){if(c.push(l.data),c.length===a){for(var d=0;d<a;++d)f[d].terminate();o(null,c)}}),f.push(h)}for(var u=0;u<a;++u)f[u].postMessage(u)}function s(a,o){for(var f=[],c=0;c<a;++c)for(var u=o[c],h=f[c]=[],l=0;l<a;++l)if(c!==l){var d=o[l];(u.st>d.st&&u.st<d.et||d.st>u.st&&d.st<u.et)&&h.push(l)}return f.reduce(function(p,y){return Math.max(p,y.length)},0)}}});var Ni=k((fm,Lf)=>{var Pn=dt();Pn.pki=Pn.pki||{};var ua=Lf.exports=Pn.pki.oids=Pn.oids=Pn.oids||{};function I(e,t){ua[e]=t,ua[t]=e}function lt(e,t){ua[e]=t}I("1.2.840.113549.1.1.1","rsaEncryption");I("1.2.840.113549.1.1.4","md5WithRSAEncryption");I("1.2.840.113549.1.1.5","sha1WithRSAEncryption");I("1.2.840.113549.1.1.7","RSAES-OAEP");I("1.2.840.113549.1.1.8","mgf1");I("1.2.840.113549.1.1.9","pSpecified");I("1.2.840.113549.1.1.10","RSASSA-PSS");I("1.2.840.113549.1.1.11","sha256WithRSAEncryption");I("1.2.840.113549.1.1.12","sha384WithRSAEncryption");I("1.2.840.113549.1.1.13","sha512WithRSAEncryption");I("1.3.101.112","EdDSA25519");I("1.2.840.10040.4.3","dsa-with-sha1");I("1.3.14.3.2.7","desCBC");I("1.3.14.3.2.26","sha1");I("1.3.14.3.2.29","sha1WithRSASignature");I("2.16.840.1.101.3.4.2.1","sha256");I("2.16.840.1.101.3.4.2.2","sha384");I("2.16.840.1.101.3.4.2.3","sha512");I("2.16.840.1.101.3.4.2.4","sha224");I("2.16.840.1.101.3.4.2.5","sha512-224");I("2.16.840.1.101.3.4.2.6","sha512-256");I("1.2.840.113549.2.2","md2");I("1.2.840.113549.2.5","md5");I("1.2.840.113549.1.7.1","data");I("1.2.840.113549.1.7.2","signedData");I("1.2.840.113549.1.7.3","envelopedData");I("1.2.840.113549.1.7.4","signedAndEnvelopedData");I("1.2.840.113549.1.7.5","digestedData");I("1.2.840.113549.1.7.6","encryptedData");I("1.2.840.113549.1.9.1","emailAddress");I("1.2.840.113549.1.9.2","unstructuredName");I("1.2.840.113549.1.9.3","contentType");I("1.2.840.113549.1.9.4","messageDigest");I("1.2.840.113549.1.9.5","signingTime");I("1.2.840.113549.1.9.6","counterSignature");I("1.2.840.113549.1.9.7","challengePassword");I("1.2.840.113549.1.9.8","unstructuredAddress");I("1.2.840.113549.1.9.14","extensionRequest");I("1.2.840.113549.1.9.20","friendlyName");I("1.2.840.113549.1.9.21","localKeyId");I("1.2.840.113549.1.9.22.1","x509Certificate");I("1.2.840.113549.1.12.10.1.1","keyBag");I("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");I("1.2.840.113549.1.12.10.1.3","certBag");I("1.2.840.113549.1.12.10.1.4","crlBag");I("1.2.840.113549.1.12.10.1.5","secretBag");I("1.2.840.113549.1.12.10.1.6","safeContentsBag");I("1.2.840.113549.1.5.13","pkcs5PBES2");I("1.2.840.113549.1.5.12","pkcs5PBKDF2");I("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");I("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");I("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");I("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");I("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");I("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");I("1.2.840.113549.2.7","hmacWithSHA1");I("1.2.840.113549.2.8","hmacWithSHA224");I("1.2.840.113549.2.9","hmacWithSHA256");I("1.2.840.113549.2.10","hmacWithSHA384");I("1.2.840.113549.2.11","hmacWithSHA512");I("1.2.840.113549.3.7","des-EDE3-CBC");I("2.16.840.1.101.3.4.1.2","aes128-CBC");I("2.16.840.1.101.3.4.1.22","aes192-CBC");I("2.16.840.1.101.3.4.1.42","aes256-CBC");I("2.5.4.3","commonName");I("2.5.4.4","surname");I("2.5.4.5","serialNumber");I("2.5.4.6","countryName");I("2.5.4.7","localityName");I("2.5.4.8","stateOrProvinceName");I("2.5.4.9","streetAddress");I("2.5.4.10","organizationName");I("2.5.4.11","organizationalUnitName");I("2.5.4.12","title");I("2.5.4.13","description");I("2.5.4.15","businessCategory");I("2.5.4.17","postalCode");I("2.5.4.42","givenName");I("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");I("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");I("2.16.840.1.113730.1.1","nsCertType");I("2.16.840.1.113730.1.13","nsComment");lt("2.5.29.1","authorityKeyIdentifier");lt("2.5.29.2","keyAttributes");lt("2.5.29.3","certificatePolicies");lt("2.5.29.4","keyUsageRestriction");lt("2.5.29.5","policyMapping");lt("2.5.29.6","subtreesConstraint");lt("2.5.29.7","subjectAltName");lt("2.5.29.8","issuerAltName");lt("2.5.29.9","subjectDirectoryAttributes");lt("2.5.29.10","basicConstraints");lt("2.5.29.11","nameConstraints");lt("2.5.29.12","policyConstraints");lt("2.5.29.13","basicConstraints");I("2.5.29.14","subjectKeyIdentifier");I("2.5.29.15","keyUsage");lt("2.5.29.16","privateKeyUsagePeriod");I("2.5.29.17","subjectAltName");I("2.5.29.18","issuerAltName");I("2.5.29.19","basicConstraints");lt("2.5.29.20","cRLNumber");lt("2.5.29.21","cRLReason");lt("2.5.29.22","expirationDate");lt("2.5.29.23","instructionCode");lt("2.5.29.24","invalidityDate");lt("2.5.29.25","cRLDistributionPoints");lt("2.5.29.26","issuingDistributionPoint");lt("2.5.29.27","deltaCRLIndicator");lt("2.5.29.28","issuingDistributionPoint");lt("2.5.29.29","certificateIssuer");lt("2.5.29.30","nameConstraints");I("2.5.29.31","cRLDistributionPoints");I("2.5.29.32","certificatePolicies");lt("2.5.29.33","policyMappings");lt("2.5.29.34","policyConstraints");I("2.5.29.35","authorityKeyIdentifier");lt("2.5.29.36","policyConstraints");I("2.5.29.37","extKeyUsage");lt("2.5.29.46","freshestCRL");lt("2.5.29.54","inhibitAnyPolicy");I("1.3.6.1.4.1.11129.2.4.2","timestampList");I("1.3.6.1.5.5.7.1.1","authorityInfoAccess");I("1.3.6.1.5.5.7.3.1","serverAuth");I("1.3.6.1.5.5.7.3.2","clientAuth");I("1.3.6.1.5.5.7.3.3","codeSigning");I("1.3.6.1.5.5.7.3.4","emailProtection");I("1.3.6.1.5.5.7.3.8","timeStamping")});var Dn=k((cm,Uf)=>{var vt=dt();Ut();Ni();var U=Uf.exports=vt.asn1=vt.asn1||{};U.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};U.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};U.create=function(e,t,r,n,i){if(vt.util.isArray(n)){for(var s=[],a=0;a<n.length;++a)n[a]!==void 0&&s.push(n[a]);n=s}var o={tagClass:e,type:t,constructed:r,composed:r||vt.util.isArray(n),value:n};return i&&"bitStringContents"in i&&(o.bitStringContents=i.bitStringContents,o.original=U.copy(o)),o};U.copy=function(e,t){var r;if(vt.util.isArray(e)){r=[];for(var n=0;n<e.length;++n)r.push(U.copy(e[n],t));return r}return typeof e=="string"?e:(r={tagClass:e.tagClass,type:e.type,constructed:e.constructed,composed:e.composed,value:U.copy(e.value,t)},t&&!t.excludeBitStringContents&&(r.bitStringContents=e.bitStringContents),r)};U.equals=function(e,t,r){if(vt.util.isArray(e)){if(!vt.util.isArray(t)||e.length!==t.length)return!1;for(var n=0;n<e.length;++n)if(!U.equals(e[n],t[n]))return!1;return!0}if(typeof e!=typeof t)return!1;if(typeof e=="string")return e===t;var i=e.tagClass===t.tagClass&&e.type===t.type&&e.constructed===t.constructed&&e.composed===t.composed&&U.equals(e.value,t.value);return r&&r.includeBitStringContents&&(i=i&&e.bitStringContents===t.bitStringContents),i};U.getBerValueLength=function(e){var t=e.getByte();if(t!==128){var r,n=t&128;return n?r=e.getInt((t&127)<<3):r=t,r}};function kn(e,t,r){if(r>t){var n=new Error("Too few bytes to parse DER.");throw n.available=e.length(),n.remaining=t,n.requested=r,n}}var gp=function(e,t){var r=e.getByte();if(t--,r!==128){var n,i=r&128;if(!i)n=r;else{var s=r&127;kn(e,t,s),n=e.getInt(s<<3)}if(n<0)throw new Error("Negative length: "+n);return n}};U.fromDer=function(e,t){t===void 0&&(t={strict:!0,parseAllBytes:!0,decodeBitStrings:!0}),typeof t=="boolean"&&(t={strict:t,parseAllBytes:!0,decodeBitStrings:!0}),"strict"in t||(t.strict=!0),"parseAllBytes"in t||(t.parseAllBytes=!0),"decodeBitStrings"in t||(t.decodeBitStrings=!0),typeof e=="string"&&(e=vt.util.createBuffer(e));var r=e.length(),n=Pi(e,e.length(),0,t);if(t.parseAllBytes&&e.length()!==0){var i=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw i.byteCount=r,i.remaining=e.length(),i}return n};function Pi(e,t,r,n){var i;kn(e,t,2);var s=e.getByte();t--;var a=s&192,o=s&31;i=e.length();var f=gp(e,t);if(t-=i-e.length(),f!==void 0&&f>t){if(n.strict){var c=new Error("Too few bytes to read ASN.1 value.");throw c.available=e.length(),c.remaining=t,c.requested=f,c}f=t}var u,h,l=(s&32)===32;if(l)if(u=[],f===void 0)for(;;){if(kn(e,t,2),e.bytes(2)===String.fromCharCode(0,0)){e.getBytes(2),t-=2;break}i=e.length(),u.push(Pi(e,t,r+1,n)),t-=i-e.length()}else for(;f>0;)i=e.length(),u.push(Pi(e,f,r+1,n)),t-=i-e.length(),f-=i-e.length();if(u===void 0&&a===U.Class.UNIVERSAL&&o===U.Type.BITSTRING&&(h=e.bytes(f)),u===void 0&&n.decodeBitStrings&&a===U.Class.UNIVERSAL&&o===U.Type.BITSTRING&&f>1){var d=e.read,p=t,y=0;if(o===U.Type.BITSTRING&&(kn(e,t,1),y=e.getByte(),t--),y===0)try{i=e.length();var x={strict:!0,decodeBitStrings:!0},m=Pi(e,t,r+1,x),b=i-e.length();t-=b,o==U.Type.BITSTRING&&b++;var w=m.tagClass;b===f&&(w===U.Class.UNIVERSAL||w===U.Class.CONTEXT_SPECIFIC)&&(u=[m])}catch{}u===void 0&&(e.read=d,t=p)}if(u===void 0){if(f===void 0){if(n.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");f=t}if(o===U.Type.BMPSTRING)for(u="";f>0;f-=2)kn(e,t,2),u+=String.fromCharCode(e.getInt16()),t-=2;else u=e.getBytes(f),t-=f}var C=h===void 0?null:{bitStringContents:h};return U.create(a,o,l,u,C)}U.toDer=function(e){var t=vt.util.createBuffer(),r=e.tagClass|e.type,n=vt.util.createBuffer(),i=!1;if("bitStringContents"in e&&(i=!0,e.original&&(i=U.equals(e,e.original))),i)n.putBytes(e.bitStringContents);else if(e.composed){e.constructed?r|=32:n.putByte(0);for(var s=0;s<e.value.length;++s)e.value[s]!==void 0&&n.putBuffer(U.toDer(e.value[s]))}else if(e.type===U.Type.BMPSTRING)for(var s=0;s<e.value.length;++s)n.putInt16(e.value.charCodeAt(s));else e.type===U.Type.INTEGER&&e.value.length>1&&(e.value.charCodeAt(0)===0&&!(e.value.charCodeAt(1)&128)||e.value.charCodeAt(0)===255&&(e.value.charCodeAt(1)&128)===128)?n.putBytes(e.value.substr(1)):n.putBytes(e.value);if(t.putByte(r),n.length()<=127)t.putByte(n.length()&127);else{var a=n.length(),o="";do o+=String.fromCharCode(a&255),a=a>>>8;while(a>0);t.putByte(o.length|128);for(var s=o.length-1;s>=0;--s)t.putByte(o.charCodeAt(s))}return t.putBuffer(n),t};U.oidToDer=function(e){var t=e.split("."),r=vt.util.createBuffer();r.putByte(40*parseInt(t[0],10)+parseInt(t[1],10));for(var n,i,s,a,o=2;o<t.length;++o){n=!0,i=[],s=parseInt(t[o],10);do a=s&127,s=s>>>7,n||(a|=128),i.push(a),n=!1;while(s>0);for(var f=i.length-1;f>=0;--f)r.putByte(i[f])}return r};U.derToOid=function(e){var t;typeof e=="string"&&(e=vt.util.createBuffer(e));var r=e.getByte();t=Math.floor(r/40)+"."+r%40;for(var n=0;e.length()>0;)r=e.getByte(),n=n<<7,r&128?n+=r&127:(t+="."+(n+r),n=0);return t};U.utcTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,2),10);r=r>=50?1900+r:2e3+r;var n=parseInt(e.substr(2,2),10)-1,i=parseInt(e.substr(4,2),10),s=parseInt(e.substr(6,2),10),a=parseInt(e.substr(8,2),10),o=0;if(e.length>11){var f=e.charAt(10),c=10;f!=="+"&&f!=="-"&&(o=parseInt(e.substr(10,2),10),c+=2)}if(t.setUTCFullYear(r,n,i),t.setUTCHours(s,a,o,0),c&&(f=e.charAt(c),f==="+"||f==="-")){var u=parseInt(e.substr(c+1,2),10),h=parseInt(e.substr(c+4,2),10),l=u*60+h;l*=6e4,f==="+"?t.setTime(+t-l):t.setTime(+t+l)}return t};U.generalizedTimeToDate=function(e){var t=new Date,r=parseInt(e.substr(0,4),10),n=parseInt(e.substr(4,2),10)-1,i=parseInt(e.substr(6,2),10),s=parseInt(e.substr(8,2),10),a=parseInt(e.substr(10,2),10),o=parseInt(e.substr(12,2),10),f=0,c=0,u=!1;e.charAt(e.length-1)==="Z"&&(u=!0);var h=e.length-5,l=e.charAt(h);if(l==="+"||l==="-"){var d=parseInt(e.substr(h+1,2),10),p=parseInt(e.substr(h+4,2),10);c=d*60+p,c*=6e4,l==="+"&&(c*=-1),u=!0}return e.charAt(14)==="."&&(f=parseFloat(e.substr(14),10)*1e3),u?(t.setUTCFullYear(r,n,i),t.setUTCHours(s,a,o,f),t.setTime(+t+c)):(t.setFullYear(r,n,i),t.setHours(s,a,o,f)),t};U.dateToUtcTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push((""+e.getUTCFullYear()).substr(2)),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};U.dateToGeneralizedTime=function(e){if(typeof e=="string")return e;var t="",r=[];r.push(""+e.getUTCFullYear()),r.push(""+(e.getUTCMonth()+1)),r.push(""+e.getUTCDate()),r.push(""+e.getUTCHours()),r.push(""+e.getUTCMinutes()),r.push(""+e.getUTCSeconds());for(var n=0;n<r.length;++n)r[n].length<2&&(t+="0"),t+=r[n];return t+="Z",t};U.integerToDer=function(e){var t=vt.util.createBuffer();if(e>=-128&&e<128)return t.putSignedInt(e,8);if(e>=-32768&&e<32768)return t.putSignedInt(e,16);if(e>=-8388608&&e<8388608)return t.putSignedInt(e,24);if(e>=-2147483648&&e<2147483648)return t.putSignedInt(e,32);var r=new Error("Integer too large; max is 32-bits.");throw r.integer=e,r};U.derToInteger=function(e){typeof e=="string"&&(e=vt.util.createBuffer(e));var t=e.length()*8;if(t>32)throw new Error("Integer too large; max is 32-bits.");return e.getSignedInt(t)};U.validate=function(e,t,r,n){var i=!1;if((e.tagClass===t.tagClass||typeof t.tagClass>"u")&&(e.type===t.type||typeof t.type>"u"))if(e.constructed===t.constructed||typeof t.constructed>"u"){if(i=!0,t.value&&vt.util.isArray(t.value))for(var s=0,a=0;i&&a<t.value.length;++a)i=t.value[a].optional||!1,e.value[s]&&(i=U.validate(e.value[s],t.value[a],r,n),i?++s:t.value[a].optional&&(i=!0)),!i&&n&&n.push("["+t.name+'] Tag class "'+t.tagClass+'", type "'+t.type+'" expected value length "'+t.value.length+'", got "'+e.value.length+'"');if(i&&r&&(t.capture&&(r[t.capture]=e.value),t.captureAsn1&&(r[t.captureAsn1]=e),t.captureBitStringContents&&"bitStringContents"in e&&(r[t.captureBitStringContents]=e.bitStringContents),t.captureBitStringValue&&"bitStringContents"in e)){var o;if(e.bitStringContents.length<2)r[t.captureBitStringValue]="";else{var f=e.bitStringContents.charCodeAt(0);if(f!==0)throw new Error("captureBitStringValue only supported for zero unused bits");r[t.captureBitStringValue]=e.bitStringContents.slice(1)}}}else n&&n.push("["+t.name+'] Expected constructed "'+t.constructed+'", got "'+e.constructed+'"');else n&&(e.tagClass!==t.tagClass&&n.push("["+t.name+'] Expected tag class "'+t.tagClass+'", got "'+e.tagClass+'"'),e.type!==t.type&&n.push("["+t.name+'] Expected type "'+t.type+'", got "'+e.type+'"'));return i};var Rf=/[^\\u0000-\\u00ff]/;U.prettyPrint=function(e,t,r){var n="";t=t||0,r=r||2,t>0&&(n+=`
`);for(var i="",s=0;s<t*r;++s)i+=" ";switch(n+=i+"Tag: ",e.tagClass){case U.Class.UNIVERSAL:n+="Universal:";break;case U.Class.APPLICATION:n+="Application:";break;case U.Class.CONTEXT_SPECIFIC:n+="Context-Specific:";break;case U.Class.PRIVATE:n+="Private:";break}if(e.tagClass===U.Class.UNIVERSAL)switch(n+=e.type,e.type){case U.Type.NONE:n+=" (None)";break;case U.Type.BOOLEAN:n+=" (Boolean)";break;case U.Type.INTEGER:n+=" (Integer)";break;case U.Type.BITSTRING:n+=" (Bit string)";break;case U.Type.OCTETSTRING:n+=" (Octet string)";break;case U.Type.NULL:n+=" (Null)";break;case U.Type.OID:n+=" (Object Identifier)";break;case U.Type.ODESC:n+=" (Object Descriptor)";break;case U.Type.EXTERNAL:n+=" (External or Instance of)";break;case U.Type.REAL:n+=" (Real)";break;case U.Type.ENUMERATED:n+=" (Enumerated)";break;case U.Type.EMBEDDED:n+=" (Embedded PDV)";break;case U.Type.UTF8:n+=" (UTF8)";break;case U.Type.ROID:n+=" (Relative Object Identifier)";break;case U.Type.SEQUENCE:n+=" (Sequence)";break;case U.Type.SET:n+=" (Set)";break;case U.Type.PRINTABLESTRING:n+=" (Printable String)";break;case U.Type.IA5String:n+=" (IA5String (ASCII))";break;case U.Type.UTCTIME:n+=" (UTC time)";break;case U.Type.GENERALIZEDTIME:n+=" (Generalized time)";break;case U.Type.BMPSTRING:n+=" (BMP String)";break}else n+=e.type;if(n+=`
`,n+=i+"Constructed: "+e.constructed+`
`,e.composed){for(var a=0,o="",s=0;s<e.value.length;++s)e.value[s]!==void 0&&(a+=1,o+=U.prettyPrint(e.value[s],t+1,r),s+1<e.value.length&&(o+=","));n+=i+"Sub values: "+a+o}else{if(n+=i+"Value: ",e.type===U.Type.OID){var f=U.derToOid(e.value);n+=f,vt.pki&&vt.pki.oids&&f in vt.pki.oids&&(n+=" ("+vt.pki.oids[f]+") ")}if(e.type===U.Type.INTEGER)try{n+=U.derToInteger(e.value)}catch{n+="0x"+vt.util.bytesToHex(e.value)}else if(e.type===U.Type.BITSTRING){if(e.value.length>1?n+="0x"+vt.util.bytesToHex(e.value.slice(1)):n+="(none)",e.value.length>0){var c=e.value.charCodeAt(0);c==1?n+=" (1 unused bit shown)":c>1&&(n+=" ("+c+" unused bits shown)")}}else if(e.type===U.Type.OCTETSTRING)Rf.test(e.value)||(n+="("+e.value+") "),n+="0x"+vt.util.bytesToHex(e.value);else if(e.type===U.Type.UTF8)try{n+=vt.util.decodeUtf8(e.value)}catch(u){if(u.message==="URI malformed")n+="0x"+vt.util.bytesToHex(e.value)+" (malformed UTF8)";else throw u}else e.type===U.Type.PRINTABLESTRING||e.type===U.Type.IA5String?n+=e.value:Rf.test(e.value)?n+="0x"+vt.util.bytesToHex(e.value):e.value.length===0?n+="[null]":n+=e.value}return n}});var la=k((um,Nf)=>{var Dt=dt();Ut();Nf.exports=Dt.cipher=Dt.cipher||{};Dt.cipher.algorithms=Dt.cipher.algorithms||{};Dt.cipher.createCipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Dt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Dt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!1})};Dt.cipher.createDecipher=function(e,t){var r=e;if(typeof r=="string"&&(r=Dt.cipher.getAlgorithm(r),r&&(r=r())),!r)throw new Error("Unsupported algorithm: "+e);return new Dt.cipher.BlockCipher({algorithm:r,key:t,decrypt:!0})};Dt.cipher.registerAlgorithm=function(e,t){e=e.toUpperCase(),Dt.cipher.algorithms[e]=t};Dt.cipher.getAlgorithm=function(e){return e=e.toUpperCase(),e in Dt.cipher.algorithms?Dt.cipher.algorithms[e]:null};var ha=Dt.cipher.BlockCipher=function(e){this.algorithm=e.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=e.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=e.decrypt,this.algorithm.initialize(e)};ha.prototype.start=function(e){e=e||{};var t={};for(var r in e)t[r]=e[r];t.decrypt=this._decrypt,this._finish=!1,this._input=Dt.util.createBuffer(),this.output=e.output||Dt.util.createBuffer(),this.mode.start(t)};ha.prototype.update=function(e){for(e&&this._input.putBuffer(e);!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish;);this._input.compact()};ha.prototype.finish=function(e){e&&(this.mode.name==="ECB"||this.mode.name==="CBC")&&(this.mode.pad=function(r){return e(this.blockSize,r,!1)},this.mode.unpad=function(r){return e(this.blockSize,r,!0)});var t={};return t.decrypt=this._decrypt,t.overflow=this._input.length()%this.blockSize,!(!this._decrypt&&this.mode.pad&&!this.mode.pad(this._input,t)||(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad&&!this.mode.unpad(this.output,t))||this.mode.afterFinish&&!this.mode.afterFinish(this.output,t))}});var da=k((hm,Pf)=>{var Kt=dt();Ut();Kt.cipher=Kt.cipher||{};var $=Pf.exports=Kt.cipher.modes=Kt.cipher.modes||{};$.ecb=function(e){e=e||{},this.name="ECB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};$.ecb.prototype.start=function(e){};$.ecb.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};$.ecb.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n])};$.ecb.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};$.ecb.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};$.cbc=function(e){e=e||{},this.name="CBC",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};$.cbc.prototype.start=function(e){if(e.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if("iv"in e)this._iv=ki(e.iv,this.blockSize),this._prev=this._iv.slice(0);else throw new Error("Invalid IV parameter.")};$.cbc.prototype.encrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=this._prev[n]^e.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._outBlock[n]);this._prev=this._outBlock};$.cbc.prototype.decrypt=function(e,t,r){if(e.length()<this.blockSize&&!(r&&e.length()>0))return!0;for(var n=0;n<this._ints;++n)this._inBlock[n]=e.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var n=0;n<this._ints;++n)t.putInt32(this._prev[n]^this._outBlock[n]);this._prev=this._inBlock.slice(0)};$.cbc.prototype.pad=function(e,t){var r=e.length()===this.blockSize?this.blockSize:this.blockSize-e.length();return e.fillWithByte(r,r),!0};$.cbc.prototype.unpad=function(e,t){if(t.overflow>0)return!1;var r=e.length(),n=e.at(r-1);return n>this.blockSize<<2?!1:(e.truncate(n),!0)};$.cfb=function(e){e=e||{},this.name="CFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=Kt.util.createBuffer(),this._partialBytes=0};$.cfb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=ki(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.cfb.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32()^this._outBlock[i],t.putInt32(this._inBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32()^this._outBlock[i],this._partialOutput.putInt32(this._partialBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.cfb.prototype.decrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)this._inBlock[i]=e.getInt32(),t.putInt32(this._inBlock[i]^this._outBlock[i]);return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialBlock[i]=e.getInt32(),this._partialOutput.putInt32(this._partialBlock[i]^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._partialBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.ofb=function(e){e=e||{},this.name="OFB",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Kt.util.createBuffer(),this._partialBytes=0};$.ofb.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=ki(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.ofb.prototype.encrypt=function(e,t,r){var n=e.length();if(e.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]),this._inBlock[i]=this._outBlock[i];return}var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0)e.read-=this.blockSize;else for(var i=0;i<this._ints;++i)this._inBlock[i]=this._outBlock[i];if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0};$.ofb.prototype.decrypt=$.ofb.prototype.encrypt;$.ctr=function(e){e=e||{},this.name="CTR",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=Kt.util.createBuffer(),this._partialBytes=0};$.ctr.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");this._iv=ki(e.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};$.ctr.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize)for(var i=0;i<this._ints;++i)t.putInt32(e.getInt32()^this._outBlock[i]);else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s>0&&(e.read-=this.blockSize),this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}Di(this._inBlock)};$.ctr.prototype.decrypt=$.ctr.prototype.encrypt;$.gcm=function(e){e=e||{},this.name="GCM",this.cipher=e.cipher,this.blockSize=e.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=Kt.util.createBuffer(),this._partialBytes=0,this._R=3774873600};$.gcm.prototype.start=function(e){if(!("iv"in e))throw new Error("Invalid IV parameter.");var t=Kt.util.createBuffer(e.iv);this._cipherLength=0;var r;if("additionalData"in e?r=Kt.util.createBuffer(e.additionalData):r=Kt.util.createBuffer(),"tagLength"in e?this._tagLength=e.tagLength:this._tagLength=128,this._tag=null,e.decrypt&&(this._tag=Kt.util.createBuffer(e.tag).getBytes(),this._tag.length!==this._tagLength/8))throw new Error("Authentication tag does not match tag length.");this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var n=t.length();if(n===12)this._j0=[t.getInt32(),t.getInt32(),t.getInt32(),1];else{for(this._j0=[0,0,0,0];t.length()>0;)this._j0=this.ghash(this._hashSubkey,this._j0,[t.getInt32(),t.getInt32(),t.getInt32(),t.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(pa(n*8)))}this._inBlock=this._j0.slice(0),Di(this._inBlock),this._partialBytes=0,r=Kt.util.createBuffer(r),this._aDataLength=pa(r.length()*8);var i=r.length()%this.blockSize;for(i&&r.fillWithByte(0,this.blockSize-i),this._s=[0,0,0,0];r.length()>0;)this._s=this.ghash(this._hashSubkey,this._s,[r.getInt32(),r.getInt32(),r.getInt32(),r.getInt32()])};$.gcm.prototype.encrypt=function(e,t,r){var n=e.length();if(n===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&n>=this.blockSize){for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^=e.getInt32());this._cipherLength+=this.blockSize}else{var s=(this.blockSize-n)%this.blockSize;s>0&&(s=this.blockSize-s),this._partialOutput.clear();for(var i=0;i<this._ints;++i)this._partialOutput.putInt32(e.getInt32()^this._outBlock[i]);if(s<=0||r){if(r){var a=n%this.blockSize;this._cipherLength+=a,this._partialOutput.truncate(this.blockSize-a)}else this._cipherLength+=this.blockSize;for(var i=0;i<this._ints;++i)this._outBlock[i]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0&&this._partialOutput.getBytes(this._partialBytes),s>0&&!r)return e.read-=this.blockSize,t.putBytes(this._partialOutput.getBytes(s-this._partialBytes)),this._partialBytes=s,!0;t.putBytes(this._partialOutput.getBytes(n-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),Di(this._inBlock)};$.gcm.prototype.decrypt=function(e,t,r){var n=e.length();if(n<this.blockSize&&!(r&&n>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),Di(this._inBlock),this._hashBlock[0]=e.getInt32(),this._hashBlock[1]=e.getInt32(),this._hashBlock[2]=e.getInt32(),this._hashBlock[3]=e.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var i=0;i<this._ints;++i)t.putInt32(this._outBlock[i]^this._hashBlock[i]);n<this.blockSize?this._cipherLength+=n%this.blockSize:this._cipherLength+=this.blockSize};$.gcm.prototype.afterFinish=function(e,t){var r=!0;t.decrypt&&t.overflow&&e.truncate(this.blockSize-t.overflow),this.tag=Kt.util.createBuffer();var n=this._aDataLength.concat(pa(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,n);var i=[];this.cipher.encrypt(this._j0,i);for(var s=0;s<this._ints;++s)this.tag.putInt32(this._s[s]^i[s]);return this.tag.truncate(this.tag.length()%(this._tagLength/8)),t.decrypt&&this.tag.bytes()!==this._tag&&(r=!1),r};$.gcm.prototype.multiply=function(e,t){for(var r=[0,0,0,0],n=t.slice(0),i=0;i<128;++i){var s=e[i/32|0]&1<<31-i%32;s&&(r[0]^=n[0],r[1]^=n[1],r[2]^=n[2],r[3]^=n[3]),this.pow(n,n)}return r};$.gcm.prototype.pow=function(e,t){for(var r=e[3]&1,n=3;n>0;--n)t[n]=e[n]>>>1|(e[n-1]&1)<<31;t[0]=e[0]>>>1,r&&(t[0]^=this._R)};$.gcm.prototype.tableMultiply=function(e){for(var t=[0,0,0,0],r=0;r<32;++r){var n=r/8|0,i=e[n]>>>(7-r%8)*4&15,s=this._m[r][i];t[0]^=s[0],t[1]^=s[1],t[2]^=s[2],t[3]^=s[3]}return t};$.gcm.prototype.ghash=function(e,t,r){return t[0]^=r[0],t[1]^=r[1],t[2]^=r[2],t[3]^=r[3],this.tableMultiply(t)};$.gcm.prototype.generateHashTable=function(e,t){for(var r=8/t,n=4*r,i=16*r,s=new Array(i),a=0;a<i;++a){var o=[0,0,0,0],f=a/n|0,c=(n-1-a%n)*t;o[f]=1<<t-1<<c,s[a]=this.generateSubHashTable(this.multiply(o,e),t)}return s};$.gcm.prototype.generateSubHashTable=function(e,t){var r=1<<t,n=r>>>1,i=new Array(r);i[n]=e.slice(0);for(var s=n>>>1;s>0;)this.pow(i[2*s],i[s]=[]),s>>=1;for(s=2;s<n;){for(var a=1;a<s;++a){var o=i[s],f=i[a];i[s+a]=[o[0]^f[0],o[1]^f[1],o[2]^f[2],o[3]^f[3]]}s*=2}for(i[0]=[0,0,0,0],s=n+1;s<r;++s){var c=i[s^n];i[s]=[e[0]^c[0],e[1]^c[1],e[2]^c[2],e[3]^c[3]]}return i};function ki(e,t){if(typeof e=="string"&&(e=Kt.util.createBuffer(e)),Kt.util.isArray(e)&&e.length>4){var r=e;e=Kt.util.createBuffer();for(var n=0;n<r.length;++n)e.putByte(r[n])}if(e.length()<t)throw new Error("Invalid IV length; got "+e.length()+" bytes and expected "+t+" bytes.");if(!Kt.util.isArray(e)){for(var i=[],s=t/4,n=0;n<s;++n)i.push(e.getInt32());e=i}return e}function Di(e){e[e.length-1]=e[e.length-1]+1&4294967295}function pa(e){return[e/4294967296|0,e&4294967295]}});var ma=k((lm,Mf)=>{var mt=dt();la();da();Ut();Mf.exports=mt.aes=mt.aes||{};mt.aes.startEncrypting=function(e,t,r,n){var i=Ki({key:e,output:r,decrypt:!1,mode:n});return i.start(t),i};mt.aes.createEncryptionCipher=function(e,t){return Ki({key:e,output:null,decrypt:!1,mode:t})};mt.aes.startDecrypting=function(e,t,r,n){var i=Ki({key:e,output:r,decrypt:!0,mode:n});return i.start(t),i};mt.aes.createDecryptionCipher=function(e,t){return Ki({key:e,output:null,decrypt:!0,mode:t})};mt.aes.Algorithm=function(e,t){xa||Df();var r=this;r.name=e,r.mode=new t({blockSize:16,cipher:{encrypt:function(n,i){return ga(r._w,n,i,!1)},decrypt:function(n,i){return ga(r._w,n,i,!0)}}}),r._init=!1};mt.aes.Algorithm.prototype.initialize=function(e){if(!this._init){var t=e.key,r;if(typeof t=="string"&&(t.length===16||t.length===24||t.length===32))t=mt.util.createBuffer(t);else if(mt.util.isArray(t)&&(t.length===16||t.length===24||t.length===32)){r=t,t=mt.util.createBuffer();for(var n=0;n<r.length;++n)t.putByte(r[n])}if(!mt.util.isArray(t)){r=t,t=[];var i=r.length();if(i===16||i===24||i===32){i=i>>>2;for(var n=0;n<i;++n)t.push(r.getInt32())}}if(!mt.util.isArray(t)||!(t.length===4||t.length===6||t.length===8))throw new Error("Invalid key parameter.");var s=this.mode.name,a=["CFB","OFB","CTR","GCM"].indexOf(s)!==-1;this._w=Kf(t,e.decrypt&&!a),this._init=!0}};mt.aes._expandKey=function(e,t){return xa||Df(),Kf(e,t)};mt.aes._updateBlock=ga;Xr("AES-ECB",mt.cipher.modes.ecb);Xr("AES-CBC",mt.cipher.modes.cbc);Xr("AES-CFB",mt.cipher.modes.cfb);Xr("AES-OFB",mt.cipher.modes.ofb);Xr("AES-CTR",mt.cipher.modes.ctr);Xr("AES-GCM",mt.cipher.modes.gcm);function Xr(e,t){var r=function(){return new mt.aes.Algorithm(e,t)};mt.cipher.registerAlgorithm(e,r)}var xa=!1,$r=4,ee,ya,kf,Ir,be;function Df(){xa=!0,kf=[0,1,2,4,8,16,32,64,128,27,54];for(var e=new Array(256),t=0;t<128;++t)e[t]=t<<1,e[t+128]=t+128<<1^283;ee=new Array(256),ya=new Array(256),Ir=new Array(4),be=new Array(4);for(var t=0;t<4;++t)Ir[t]=new Array(256),be[t]=new Array(256);for(var r=0,n=0,i,s,a,o,f,c,u,t=0;t<256;++t){o=n^n<<1^n<<2^n<<3^n<<4,o=o>>8^o&255^99,ee[r]=o,ya[o]=r,f=e[o],i=e[r],s=e[i],a=e[s],c=f<<24^o<<16^o<<8^(o^f),u=(i^s^a)<<24^(r^a)<<16^(r^s^a)<<8^(r^i^a);for(var h=0;h<4;++h)Ir[h][r]=c,be[h][o]=u,c=c<<24|c>>>8,u=u<<24|u>>>8;r===0?r=n=1:(r=i^e[e[e[i^a]]],n^=e[e[n]])}}function Kf(e,t){for(var r=e.slice(0),n,i=1,s=r.length,a=s+6+1,o=$r*a,f=s;f<o;++f)n=r[f-1],f%s===0?(n=ee[n>>>16&255]<<24^ee[n>>>8&255]<<16^ee[n&255]<<8^ee[n>>>24]^kf[i]<<24,i++):s>6&&f%s===4&&(n=ee[n>>>24]<<24^ee[n>>>16&255]<<16^ee[n>>>8&255]<<8^ee[n&255]),r[f]=r[f-s]^n;if(t){var c,u=be[0],h=be[1],l=be[2],d=be[3],p=r.slice(0);o=r.length;for(var f=0,y=o-$r;f<o;f+=$r,y-=$r)if(f===0||f===o-$r)p[f]=r[y],p[f+1]=r[y+3],p[f+2]=r[y+2],p[f+3]=r[y+1];else for(var x=0;x<$r;++x)c=r[y+x],p[f+(3&-x)]=u[ee[c>>>24]]^h[ee[c>>>16&255]]^l[ee[c>>>8&255]]^d[ee[c&255]];r=p}return r}function ga(e,t,r,n){var i=e.length/4-1,s,a,o,f,c;n?(s=be[0],a=be[1],o=be[2],f=be[3],c=ya):(s=Ir[0],a=Ir[1],o=Ir[2],f=Ir[3],c=ee);var u,h,l,d,p,y,x;u=t[0]^e[0],h=t[n?3:1]^e[1],l=t[2]^e[2],d=t[n?1:3]^e[3];for(var m=3,b=1;b<i;++b)p=s[u>>>24]^a[h>>>16&255]^o[l>>>8&255]^f[d&255]^e[++m],y=s[h>>>24]^a[l>>>16&255]^o[d>>>8&255]^f[u&255]^e[++m],x=s[l>>>24]^a[d>>>16&255]^o[u>>>8&255]^f[h&255]^e[++m],d=s[d>>>24]^a[u>>>16&255]^o[h>>>8&255]^f[l&255]^e[++m],u=p,h=y,l=x;r[0]=c[u>>>24]<<24^c[h>>>16&255]<<16^c[l>>>8&255]<<8^c[d&255]^e[++m],r[n?3:1]=c[h>>>24]<<24^c[l>>>16&255]<<16^c[d>>>8&255]<<8^c[u&255]^e[++m],r[2]=c[l>>>24]<<24^c[d>>>16&255]<<16^c[u>>>8&255]<<8^c[h&255]^e[++m],r[n?1:3]=c[d>>>24]<<24^c[u>>>16&255]<<16^c[h>>>8&255]<<8^c[l&255]^e[++m]}function Ki(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="AES-"+t,n;e.decrypt?n=mt.cipher.createDecipher(r,e.key):n=mt.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof mt.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}});var Hf=k((pm,Of)=>{var Bt=dt();la();da();Ut();Of.exports=Bt.des=Bt.des||{};Bt.des.startEncrypting=function(e,t,r,n){var i=Mi({key:e,output:r,decrypt:!1,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};Bt.des.createEncryptionCipher=function(e,t){return Mi({key:e,output:null,decrypt:!1,mode:t})};Bt.des.startDecrypting=function(e,t,r,n){var i=Mi({key:e,output:r,decrypt:!0,mode:n||(t===null?"ECB":"CBC")});return i.start(t),i};Bt.des.createDecryptionCipher=function(e,t){return Mi({key:e,output:null,decrypt:!0,mode:t})};Bt.des.Algorithm=function(e,t){var r=this;r.name=e,r.mode=new t({blockSize:8,cipher:{encrypt:function(n,i){return Ff(r._keys,n,i,!1)},decrypt:function(n,i){return Ff(r._keys,n,i,!0)}}}),r._init=!1};Bt.des.Algorithm.prototype.initialize=function(e){if(!this._init){var t=Bt.util.createBuffer(e.key);if(this.name.indexOf("3DES")===0&&t.length()!==24)throw new Error("Invalid Triple-DES key size: "+t.length()*8);this._keys=Ap(t),this._init=!0}};Ne("DES-ECB",Bt.cipher.modes.ecb);Ne("DES-CBC",Bt.cipher.modes.cbc);Ne("DES-CFB",Bt.cipher.modes.cfb);Ne("DES-OFB",Bt.cipher.modes.ofb);Ne("DES-CTR",Bt.cipher.modes.ctr);Ne("3DES-ECB",Bt.cipher.modes.ecb);Ne("3DES-CBC",Bt.cipher.modes.cbc);Ne("3DES-CFB",Bt.cipher.modes.cfb);Ne("3DES-OFB",Bt.cipher.modes.ofb);Ne("3DES-CTR",Bt.cipher.modes.ctr);function Ne(e,t){var r=function(){return new Bt.des.Algorithm(e,t)};Bt.cipher.registerAlgorithm(e,r)}var xp=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],mp=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],vp=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],bp=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],wp=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],Ep=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],Sp=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],Bp=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function Ap(e){for(var t=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],r=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],n=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],i=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],s=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],a=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],o=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],f=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],c=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],u=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],h=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],l=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],d=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],p=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],y=e.length()>8?3:1,x=[],m=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],b=0,w,C=0;C<y;C++){var B=e.getInt32(),A=e.getInt32();w=(B>>>4^A)&252645135,A^=w,B^=w<<4,w=(A>>>-16^B)&65535,B^=w,A^=w<<-16,w=(B>>>2^A)&858993459,A^=w,B^=w<<2,w=(A>>>-16^B)&65535,B^=w,A^=w<<-16,w=(B>>>1^A)&1431655765,A^=w,B^=w<<1,w=(A>>>8^B)&16711935,B^=w,A^=w<<8,w=(B>>>1^A)&1431655765,A^=w,B^=w<<1,w=B<<8|A>>>20&240,B=A<<24|A<<8&16711680|A>>>8&65280|A>>>24&240,A=w;for(var L=0;L<m.length;++L){m[L]?(B=B<<2|B>>>26,A=A<<2|A>>>26):(B=B<<1|B>>>27,A=A<<1|A>>>27),B&=-15,A&=-15;var R=t[B>>>28]|r[B>>>24&15]|n[B>>>20&15]|i[B>>>16&15]|s[B>>>12&15]|a[B>>>8&15]|o[B>>>4&15],D=f[A>>>28]|c[A>>>24&15]|u[A>>>20&15]|h[A>>>16&15]|l[A>>>12&15]|d[A>>>8&15]|p[A>>>4&15];w=(D>>>16^R)&65535,x[b++]=R^w,x[b++]=D^w<<16}}return x}function Ff(e,t,r,n){var i=e.length===32?3:9,s;i===3?s=n?[30,-2,-2]:[0,32,2]:s=n?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var a,o=t[0],f=t[1];a=(o>>>4^f)&252645135,f^=a,o^=a<<4,a=(o>>>16^f)&65535,f^=a,o^=a<<16,a=(f>>>2^o)&858993459,o^=a,f^=a<<2,a=(f>>>8^o)&16711935,o^=a,f^=a<<8,a=(o>>>1^f)&1431655765,f^=a,o^=a<<1,o=o<<1|o>>>31,f=f<<1|f>>>31;for(var c=0;c<i;c+=3){for(var u=s[c+1],h=s[c+2],l=s[c];l!=u;l+=h){var d=f^e[l],p=(f>>>4|f<<28)^e[l+1];a=o,o=f,f=a^(mp[d>>>24&63]|bp[d>>>16&63]|Ep[d>>>8&63]|Bp[d&63]|xp[p>>>24&63]|vp[p>>>16&63]|wp[p>>>8&63]|Sp[p&63])}a=o,o=f,f=a}o=o>>>1|o<<31,f=f>>>1|f<<31,a=(o>>>1^f)&1431655765,f^=a,o^=a<<1,a=(f>>>8^o)&16711935,o^=a,f^=a<<8,a=(f>>>2^o)&858993459,o^=a,f^=a<<2,a=(o>>>16^f)&65535,f^=a,o^=a<<16,a=(o>>>4^f)&252645135,f^=a,o^=a<<4,r[0]=o,r[1]=f}function Mi(e){e=e||{};var t=(e.mode||"CBC").toUpperCase(),r="DES-"+t,n;e.decrypt?n=Bt.cipher.createDecipher(r,e.key):n=Bt.cipher.createCipher(r,e.key);var i=n.start;return n.start=function(s,a){var o=null;a instanceof Bt.util.ByteBuffer&&(o=a,a={}),a=a||{},a.output=o,a.iv=s,i.call(n,a)},n}});var Lr=k((dm,Vf)=>{var Fi=dt();Vf.exports=Fi.md=Fi.md||{};Fi.md.algorithms=Fi.md.algorithms||{}});var zf=k((ym,qf)=>{var Ye=dt();Lr();Ut();var _p=qf.exports=Ye.hmac=Ye.hmac||{};_p.create=function(){var e=null,t=null,r=null,n=null,i={};return i.start=function(s,a){if(s!==null)if(typeof s=="string")if(s=s.toLowerCase(),s in Ye.md.algorithms)t=Ye.md.algorithms[s].create();else throw new Error('Unknown hash algorithm "'+s+'"');else t=s;if(a===null)a=e;else{if(typeof a=="string")a=Ye.util.createBuffer(a);else if(Ye.util.isArray(a)){var o=a;a=Ye.util.createBuffer();for(var f=0;f<o.length;++f)a.putByte(o[f])}var c=a.length();c>t.blockLength&&(t.start(),t.update(a.bytes()),a=t.digest()),r=Ye.util.createBuffer(),n=Ye.util.createBuffer(),c=a.length();for(var f=0;f<c;++f){var o=a.at(f);r.putByte(54^o),n.putByte(92^o)}if(c<t.blockLength)for(var o=t.blockLength-c,f=0;f<o;++f)r.putByte(54),n.putByte(92);e=a,r=r.bytes(),n=n.bytes()}t.start(),t.update(r)},i.update=function(s){t.update(s)},i.getMac=function(){var s=t.digest().bytes();return t.start(),t.update(n),t.update(s),t.digest()},i.digest=i.getMac,i}});var Wf=k((gm,Gf)=>{var re=dt();zf();Lr();Ut();var Cp=re.pkcs5=re.pkcs5||{},$e;re.util.isNodejs&&!re.options.usePureJavaScript&&($e=wr());Gf.exports=re.pbkdf2=Cp.pbkdf2=function(e,t,r,n,i,s){if(typeof i=="function"&&(s=i,i=null),re.util.isNodejs&&!re.options.usePureJavaScript&&$e.pbkdf2&&(i===null||typeof i!="object")&&($e.pbkdf2Sync.length>4||!i||i==="sha1"))return typeof i!="string"&&(i="sha1"),e=Buffer.from(e,"binary"),t=Buffer.from(t,"binary"),s?$e.pbkdf2Sync.length===4?$e.pbkdf2(e,t,r,n,function(w,C){if(w)return s(w);s(null,C.toString("binary"))}):$e.pbkdf2(e,t,r,n,i,function(w,C){if(w)return s(w);s(null,C.toString("binary"))}):$e.pbkdf2Sync.length===4?$e.pbkdf2Sync(e,t,r,n).toString("binary"):$e.pbkdf2Sync(e,t,r,n,i).toString("binary");if((typeof i>"u"||i===null)&&(i="sha1"),typeof i=="string"){if(!(i in re.md.algorithms))throw new Error("Unknown hash algorithm: "+i);i=re.md[i].create()}var a=i.digestLength;if(n>4294967295*a){var o=new Error("Derived key is too long.");if(s)return s(o);throw o}var f=Math.ceil(n/a),c=n-(f-1)*a,u=re.hmac.create();u.start(i,e);var h="",l,d,p;if(!s){for(var y=1;y<=f;++y){u.start(null,null),u.update(t),u.update(re.util.int32ToBytes(y)),l=p=u.digest().getBytes();for(var x=2;x<=r;++x)u.start(null,null),u.update(p),d=u.digest().getBytes(),l=re.util.xorBytes(l,d,a),p=d;h+=y<f?l:l.substr(0,c)}return h}var y=1,x;function m(){if(y>f)return s(null,h);u.start(null,null),u.update(t),u.update(re.util.int32ToBytes(y)),l=p=u.digest().getBytes(),x=2,b()}function b(){if(x<=r)return u.start(null,null),u.update(p),d=u.digest().getBytes(),l=re.util.xorBytes(l,d,a),p=d,++x,re.util.setImmediate(b);h+=y<f?l:l.substr(0,c),++y,m()}m()}});var Xf=k((xm,$f)=>{var Hi=dt();Ut();var Yf=$f.exports=Hi.pem=Hi.pem||{};Yf.encode=function(e,t){t=t||{};var r="-----BEGIN "+e.type+`-----\r
`,n;if(e.procType&&(n={name:"Proc-Type",values:[String(e.procType.version),e.procType.type]},r+=Oi(n)),e.contentDomain&&(n={name:"Content-Domain",values:[e.contentDomain]},r+=Oi(n)),e.dekInfo&&(n={name:"DEK-Info",values:[e.dekInfo.algorithm]},e.dekInfo.parameters&&n.values.push(e.dekInfo.parameters),r+=Oi(n)),e.headers)for(var i=0;i<e.headers.length;++i)r+=Oi(e.headers[i]);return e.procType&&(r+=`\r
`),r+=Hi.util.encode64(e.body,t.maxline||64)+`\r
`,r+="-----END "+e.type+`-----\r
`,r};Yf.decode=function(e){for(var t=[],r=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,n=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,i=/\r?\n/,s;s=r.exec(e),!!s;){var a=s[1];a==="NEW CERTIFICATE REQUEST"&&(a="CERTIFICATE REQUEST");var o={type:a,procType:null,contentDomain:null,dekInfo:null,headers:[],body:Hi.util.decode64(s[3])};if(t.push(o),!!s[2]){for(var f=s[2].split(i),c=0;s&&c<f.length;){for(var u=f[c].replace(/\s+$/,""),h=c+1;h<f.length;++h){var l=f[h];if(!/\s/.test(l[0]))break;u+=l,c=h}if(s=u.match(n),s){for(var d={name:s[1],values:[]},p=s[2].split(","),y=0;y<p.length;++y)d.values.push(Tp(p[y]));if(o.procType)if(!o.contentDomain&&d.name==="Content-Domain")o.contentDomain=p[0]||"";else if(!o.dekInfo&&d.name==="DEK-Info"){if(d.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');o.dekInfo={algorithm:p[0],parameters:p[1]||null}}else o.headers.push(d);else{if(d.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');if(d.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');o.procType={version:p[0],type:p[1]}}}++c}if(o.procType==="ENCRYPTED"&&!o.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}}if(t.length===0)throw new Error("Invalid PEM formatted message.");return t};function Oi(e){for(var t=e.name+": ",r=[],n=function(f,c){return" "+c},i=0;i<e.values.length;++i)r.push(e.values[i].replace(/^(\S+\r\n)/,n));t+=r.join(",")+`\r
`;for(var s=0,a=-1,i=0;i<t.length;++i,++s)if(s>65&&a!==-1){var o=t[a];o===","?(++a,t=t.substr(0,a)+`\r
 `+t.substr(a)):t=t.substr(0,a)+`\r
`+o+t.substr(a+1),s=i-a-1,a=-1,++i}else(t[i]===" "||t[i]==="	"||t[i]===",")&&(a=i);return t}function Tp(e){return e.replace(/^\s+/,"")}});var ec=k((mm,tc)=>{var Pe=dt();Lr();Ut();var Qf=tc.exports=Pe.sha256=Pe.sha256||{};Pe.md.sha256=Pe.md.algorithms.sha256=Qf;Qf.create=function(){Jf||Ip();var e=null,t=Pe.util.createBuffer(),r=new Array(64),n={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=Pe.util.createBuffer(),e={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=Pe.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),Zf(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=Pe.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(va.substr(0,n.blockLength-a));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4,h5:e.h5,h6:e.h6,h7:e.h7};Zf(h,r,i);var l=Pe.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l.putInt32(h.h5),l.putInt32(h.h6),l.putInt32(h.h7),l},n};var va=null,Jf=!1,jf=null;function Ip(){va=String.fromCharCode(128),va+=Pe.util.fillString(String.fromCharCode(0),64),jf=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],Jf=!0}function Zf(e,t,r){for(var n,i,s,a,o,f,c,u,h,l,d,p,y,x,m,b=r.length();b>=64;){for(c=0;c<16;++c)t[c]=r.getInt32();for(;c<64;++c)n=t[c-2],n=(n>>>17|n<<15)^(n>>>19|n<<13)^n>>>10,i=t[c-15],i=(i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3,t[c]=n+t[c-7]+i+t[c-16]|0;for(u=e.h0,h=e.h1,l=e.h2,d=e.h3,p=e.h4,y=e.h5,x=e.h6,m=e.h7,c=0;c<64;++c)a=(p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7),o=x^p&(y^x),s=(u>>>2|u<<30)^(u>>>13|u<<19)^(u>>>22|u<<10),f=u&h|l&(u^h),n=m+a+o+jf[c]+t[c],i=s+f,m=x,x=y,y=p,p=d+n>>>0,d=l,l=h,h=u,u=n+i>>>0;e.h0=e.h0+u|0,e.h1=e.h1+h|0,e.h2=e.h2+l|0,e.h3=e.h3+d|0,e.h4=e.h4+p|0,e.h5=e.h5+y|0,e.h6=e.h6+x|0,e.h7=e.h7+m|0,b-=64}}});var nc=k((vm,rc)=>{var ke=dt();Ut();var Vi=null;ke.util.isNodejs&&!ke.options.usePureJavaScript&&!process.versions["node-webkit"]&&(Vi=wr());var Lp=rc.exports=ke.prng=ke.prng||{};Lp.create=function(e){for(var t={plugin:e,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},r=e.md,n=new Array(32),i=0;i<32;++i)n[i]=r.create();t.pools=n,t.pool=0,t.generate=function(c,u){if(!u)return t.generateSync(c);var h=t.plugin.cipher,l=t.plugin.increment,d=t.plugin.formatKey,p=t.plugin.formatSeed,y=ke.util.createBuffer();t.key=null,x();function x(m){if(m)return u(m);if(y.length()>=c)return u(null,y.getBytes(c));if(t.generated>1048575&&(t.key=null),t.key===null)return ke.util.nextTick(function(){s(x)});var b=h(t.key,t.seed);t.generated+=b.length,y.putBytes(b),t.key=d(h(t.key,l(t.seed))),t.seed=p(h(t.key,t.seed)),ke.util.setImmediate(x)}},t.generateSync=function(c){var u=t.plugin.cipher,h=t.plugin.increment,l=t.plugin.formatKey,d=t.plugin.formatSeed;t.key=null;for(var p=ke.util.createBuffer();p.length()<c;){t.generated>1048575&&(t.key=null),t.key===null&&a();var y=u(t.key,t.seed);t.generated+=y.length,p.putBytes(y),t.key=l(u(t.key,h(t.seed))),t.seed=d(u(t.key,t.seed))}return p.getBytes(c)};function s(c){if(t.pools[0].messageLength>=32)return o(),c();var u=32-t.pools[0].messageLength<<5;t.seedFile(u,function(h,l){if(h)return c(h);t.collect(l),o(),c()})}function a(){if(t.pools[0].messageLength>=32)return o();var c=32-t.pools[0].messageLength<<5;t.collect(t.seedFileSync(c)),o()}function o(){t.reseeds=t.reseeds===4294967295?0:t.reseeds+1;var c=t.plugin.md.create();c.update(t.keyBytes);for(var u=1,h=0;h<32;++h)t.reseeds%u===0&&(c.update(t.pools[h].digest().getBytes()),t.pools[h].start()),u=u<<1;t.keyBytes=c.digest().getBytes(),c.start(),c.update(t.keyBytes);var l=c.digest().getBytes();t.key=t.plugin.formatKey(t.keyBytes),t.seed=t.plugin.formatSeed(l),t.generated=0}function f(c){var u=null,h=ke.util.globalScope,l=h.crypto||h.msCrypto;l&&l.getRandomValues&&(u=function(B){return l.getRandomValues(B)});var d=ke.util.createBuffer();if(u)for(;d.length()<c;){var p=Math.max(1,Math.min(c-d.length(),65536)/4),y=new Uint32Array(Math.floor(p));try{u(y);for(var x=0;x<y.length;++x)d.putInt32(y[x])}catch(B){if(!(typeof QuotaExceededError<"u"&&B instanceof QuotaExceededError))throw B}}if(d.length()<c)for(var m,b,w,C=Math.floor(Math.random()*65536);d.length()<c;){b=16807*(C&65535),m=16807*(C>>16),b+=(m&32767)<<16,b+=m>>15,b=(b&2147483647)+(b>>31),C=b&4294967295;for(var x=0;x<3;++x)w=C>>>(x<<3),w^=Math.floor(Math.random()*256),d.putByte(w&255)}return d.getBytes(c)}return Vi?(t.seedFile=function(c,u){Vi.randomBytes(c,function(h,l){if(h)return u(h);u(null,l.toString())})},t.seedFileSync=function(c){return Vi.randomBytes(c).toString()}):(t.seedFile=function(c,u){try{u(null,f(c))}catch(h){u(h)}},t.seedFileSync=f),t.collect=function(c){for(var u=c.length,h=0;h<u;++h)t.pools[t.pool].update(c.substr(h,1)),t.pool=t.pool===31?0:t.pool+1},t.collectInt=function(c,u){for(var h="",l=0;l<u;l+=8)h+=String.fromCharCode(c>>l&255);t.collect(h)},t.registerWorker=function(c){if(c===self)t.seedFile=function(h,l){function d(p){var y=p.data;y.forge&&y.forge.prng&&(self.removeEventListener("message",d),l(y.forge.prng.err,y.forge.prng.bytes))}self.addEventListener("message",d),self.postMessage({forge:{prng:{needed:h}}})};else{var u=function(h){var l=h.data;l.forge&&l.forge.prng&&t.seedFile(l.forge.prng.needed,function(d,p){c.postMessage({forge:{prng:{err:d,bytes:p}}})})};c.addEventListener("message",u)}},t}});var Kn=k((bm,ba)=>{var Mt=dt();ma();ec();nc();Ut();(function(){if(Mt.random&&Mt.random.getBytes){ba.exports=Mt.random;return}(function(e){var t={},r=new Array(4),n=Mt.util.createBuffer();t.formatKey=function(h){var l=Mt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),Mt.aes._expandKey(h,!1)},t.formatSeed=function(h){var l=Mt.util.createBuffer(h);return h=new Array(4),h[0]=l.getInt32(),h[1]=l.getInt32(),h[2]=l.getInt32(),h[3]=l.getInt32(),h},t.cipher=function(h,l){return Mt.aes._updateBlock(h,l,r,!1),n.putInt32(r[0]),n.putInt32(r[1]),n.putInt32(r[2]),n.putInt32(r[3]),n.getBytes()},t.increment=function(h){return++h[3],h},t.md=Mt.md.sha256;function i(){var h=Mt.prng.create(t);return h.getBytes=function(l,d){return h.generate(l,d)},h.getBytesSync=function(l){return h.generate(l)},h}var s=i(),a=null,o=Mt.util.globalScope,f=o.crypto||o.msCrypto;if(f&&f.getRandomValues&&(a=function(h){return f.getRandomValues(h)}),Mt.options.usePureJavaScript||!Mt.util.isNodejs&&!a){if(typeof window>"u"||window.document,s.collectInt(+new Date,32),typeof navigator<"u"){var c="";for(var u in navigator)try{typeof navigator[u]=="string"&&(c+=navigator[u])}catch{}s.collect(c),c=null}e&&(e().mousemove(function(h){s.collectInt(h.clientX,16),s.collectInt(h.clientY,16)}),e().keypress(function(h){s.collectInt(h.charCode,8)}))}if(!Mt.random)Mt.random=s;else for(var u in s)Mt.random[u]=s[u];Mt.random.createInstance=i,ba.exports=Mt.random})(typeof jQuery<"u"?jQuery:null)})()});var oc=k((wm,ac)=>{var ie=dt();Ut();var wa=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],ic=[1,2,3,5],Rp=function(e,t){return e<<t&65535|(e&65535)>>16-t},Up=function(e,t){return(e&65535)>>t|e<<16-t&65535};ac.exports=ie.rc2=ie.rc2||{};ie.rc2.expandKey=function(e,t){typeof e=="string"&&(e=ie.util.createBuffer(e)),t=t||128;var r=e,n=e.length(),i=t,s=Math.ceil(i/8),a=255>>(i&7),o;for(o=n;o<128;o++)r.putByte(wa[r.at(o-1)+r.at(o-n)&255]);for(r.setAt(128-s,wa[r.at(128-s)&a]),o=127-s;o>=0;o--)r.setAt(o,wa[r.at(o+1)^r.at(o+s)]);return r};var sc=function(e,t,r){var n=!1,i=null,s=null,a=null,o,f,c,u,h=[];for(e=ie.rc2.expandKey(e,t),c=0;c<64;c++)h.push(e.getInt16Le());r?(o=function(p){for(c=0;c<4;c++)p[c]+=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),p[c]=Rp(p[c],ic[c]),u++},f=function(p){for(c=0;c<4;c++)p[c]+=h[p[(c+3)%4]&63]}):(o=function(p){for(c=3;c>=0;c--)p[c]=Up(p[c],ic[c]),p[c]-=h[u]+(p[(c+3)%4]&p[(c+2)%4])+(~p[(c+3)%4]&p[(c+1)%4]),u--},f=function(p){for(c=3;c>=0;c--)p[c]-=h[p[(c+3)%4]&63]});var l=function(p){var y=[];for(c=0;c<4;c++){var x=i.getInt16Le();a!==null&&(r?x^=a.getInt16Le():a.putInt16Le(x)),y.push(x&65535)}u=r?0:63;for(var m=0;m<p.length;m++)for(var b=0;b<p[m][0];b++)p[m][1](y);for(c=0;c<4;c++)a!==null&&(r?a.putInt16Le(y[c]):y[c]^=a.getInt16Le()),s.putInt16Le(y[c])},d=null;return d={start:function(p,y){p&&typeof p=="string"&&(p=ie.util.createBuffer(p)),n=!1,i=ie.util.createBuffer(),s=y||new ie.util.createBuffer,a=p,d.output=s},update:function(p){for(n||i.putBuffer(p);i.length()>=8;)l([[5,o],[1,f],[6,o],[1,f],[5,o]])},finish:function(p){var y=!0;if(r)if(p)y=p(8,i,!r);else{var x=i.length()===8?8:8-i.length();i.fillWithByte(x,x)}if(y&&(n=!0,d.update()),!r&&(y=i.length()===0,y))if(p)y=p(8,s,!r);else{var m=s.length(),b=s.at(m-1);b>m?y=!1:s.truncate(b)}return y}},d};ie.rc2.startEncrypting=function(e,t,r){var n=ie.rc2.createEncryptionCipher(e,128);return n.start(t,r),n};ie.rc2.createEncryptionCipher=function(e,t){return sc(e,t,!0)};ie.rc2.startDecrypting=function(e,t,r){var n=ie.rc2.createDecryptionCipher(e,128);return n.start(t,r),n};ie.rc2.createDecryptionCipher=function(e,t){return sc(e,t,!1)}});var Gi=k((Em,yc)=>{var Ea=dt();yc.exports=Ea.jsbn=Ea.jsbn||{};var Xe,Np=0xdeadbeefcafe,fc=(Np&16777215)==15715070;function _(e,t,r){this.data=[],e!=null&&(typeof e=="number"?this.fromNumber(e,t,r):t==null&&typeof e!="string"?this.fromString(e,256):this.fromString(e,t))}Ea.jsbn.BigInteger=_;function it(){return new _(null)}function Pp(e,t,r,n,i,s){for(;--s>=0;){var a=t*this.data[e++]+r.data[n]+i;i=Math.floor(a/67108864),r.data[n++]=a&67108863}return i}function kp(e,t,r,n,i,s){for(var a=t&32767,o=t>>15;--s>=0;){var f=this.data[e]&32767,c=this.data[e++]>>15,u=o*f+c*a;f=a*f+((u&32767)<<15)+r.data[n]+(i&1073741823),i=(f>>>30)+(u>>>15)+o*c+(i>>>30),r.data[n++]=f&1073741823}return i}function cc(e,t,r,n,i,s){for(var a=t&16383,o=t>>14;--s>=0;){var f=this.data[e]&16383,c=this.data[e++]>>14,u=o*f+c*a;f=a*f+((u&16383)<<14)+r.data[n]+i,i=(f>>28)+(u>>14)+o*c,r.data[n++]=f&268435455}return i}typeof navigator>"u"?(_.prototype.am=cc,Xe=28):fc&&navigator.appName=="Microsoft Internet Explorer"?(_.prototype.am=kp,Xe=30):fc&&navigator.appName!="Netscape"?(_.prototype.am=Pp,Xe=26):(_.prototype.am=cc,Xe=28);_.prototype.DB=Xe;_.prototype.DM=(1<<Xe)-1;_.prototype.DV=1<<Xe;var Sa=52;_.prototype.FV=Math.pow(2,Sa);_.prototype.F1=Sa-Xe;_.prototype.F2=2*Xe-Sa;var Dp="0123456789abcdefghijklmnopqrstuvwxyz",qi=new Array,Zr,pe;Zr="0".charCodeAt(0);for(pe=0;pe<=9;++pe)qi[Zr++]=pe;Zr="a".charCodeAt(0);for(pe=10;pe<36;++pe)qi[Zr++]=pe;Zr="A".charCodeAt(0);for(pe=10;pe<36;++pe)qi[Zr++]=pe;function uc(e){return Dp.charAt(e)}function hc(e,t){var r=qi[e.charCodeAt(t)];return r??-1}function Kp(e){for(var t=this.t-1;t>=0;--t)e.data[t]=this.data[t];e.t=this.t,e.s=this.s}function Mp(e){this.t=1,this.s=e<0?-1:0,e>0?this.data[0]=e:e<-1?this.data[0]=e+this.DV:this.t=0}function sr(e){var t=it();return t.fromInt(e),t}function Fp(e,t){var r;if(t==16)r=4;else if(t==8)r=3;else if(t==256)r=8;else if(t==2)r=1;else if(t==32)r=5;else if(t==4)r=2;else{this.fromRadix(e,t);return}this.t=0,this.s=0;for(var n=e.length,i=!1,s=0;--n>=0;){var a=r==8?e[n]&255:hc(e,n);if(a<0){e.charAt(n)=="-"&&(i=!0);continue}i=!1,s==0?this.data[this.t++]=a:s+r>this.DB?(this.data[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this.data[this.t++]=a>>this.DB-s):this.data[this.t-1]|=a<<s,s+=r,s>=this.DB&&(s-=this.DB)}r==8&&e[0]&128&&(this.s=-1,s>0&&(this.data[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),i&&_.ZERO.subTo(this,this)}function Op(){for(var e=this.s&this.DM;this.t>0&&this.data[this.t-1]==e;)--this.t}function Hp(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(e==16)t=4;else if(e==8)t=3;else if(e==2)t=1;else if(e==32)t=5;else if(e==4)t=2;else return this.toRadix(e);var r=(1<<t)-1,n,i=!1,s="",a=this.t,o=this.DB-a*this.DB%t;if(a-- >0)for(o<this.DB&&(n=this.data[a]>>o)>0&&(i=!0,s=uc(n));a>=0;)o<t?(n=(this.data[a]&(1<<o)-1)<<t-o,n|=this.data[--a]>>(o+=this.DB-t)):(n=this.data[a]>>(o-=t)&r,o<=0&&(o+=this.DB,--a)),n>0&&(i=!0),i&&(s+=uc(n));return i?s:"0"}function Vp(){var e=it();return _.ZERO.subTo(this,e),e}function qp(){return this.s<0?this.negate():this}function zp(e){var t=this.s-e.s;if(t!=0)return t;var r=this.t;if(t=r-e.t,t!=0)return this.s<0?-t:t;for(;--r>=0;)if((t=this.data[r]-e.data[r])!=0)return t;return 0}function zi(e){var t=1,r;return(r=e>>>16)!=0&&(e=r,t+=16),(r=e>>8)!=0&&(e=r,t+=8),(r=e>>4)!=0&&(e=r,t+=4),(r=e>>2)!=0&&(e=r,t+=2),(r=e>>1)!=0&&(e=r,t+=1),t}function Gp(){return this.t<=0?0:this.DB*(this.t-1)+zi(this.data[this.t-1]^this.s&this.DM)}function Wp(e,t){var r;for(r=this.t-1;r>=0;--r)t.data[r+e]=this.data[r];for(r=e-1;r>=0;--r)t.data[r]=0;t.t=this.t+e,t.s=this.s}function Yp(e,t){for(var r=e;r<this.t;++r)t.data[r-e]=this.data[r];t.t=Math.max(this.t-e,0),t.s=this.s}function $p(e,t){var r=e%this.DB,n=this.DB-r,i=(1<<n)-1,s=Math.floor(e/this.DB),a=this.s<<r&this.DM,o;for(o=this.t-1;o>=0;--o)t.data[o+s+1]=this.data[o]>>n|a,a=(this.data[o]&i)<<r;for(o=s-1;o>=0;--o)t.data[o]=0;t.data[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()}function Xp(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t){t.t=0;return}var n=e%this.DB,i=this.DB-n,s=(1<<n)-1;t.data[0]=this.data[r]>>n;for(var a=r+1;a<this.t;++a)t.data[a-r-1]|=(this.data[a]&s)<<i,t.data[a-r]=this.data[a]>>n;n>0&&(t.data[this.t-r-1]|=(this.s&s)<<i),t.t=this.t-r,t.clamp()}function Zp(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]-e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n-=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n-=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n-=e.s}t.s=n<0?-1:0,n<-1?t.data[r++]=this.DV+n:n>0&&(t.data[r++]=n),t.t=r,t.clamp()}function Qp(e,t){var r=this.abs(),n=e.abs(),i=r.t;for(t.t=i+n.t;--i>=0;)t.data[i]=0;for(i=0;i<n.t;++i)t.data[i+r.t]=r.am(0,n.data[i],t,i,0,r.t);t.s=0,t.clamp(),this.s!=e.s&&_.ZERO.subTo(t,t)}function Jp(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e.data[r]=0;for(r=0;r<t.t-1;++r){var n=t.am(r,t.data[r],e,2*r,0,1);(e.data[r+t.t]+=t.am(r+1,2*t.data[r],e,2*r+1,n,t.t-r-1))>=t.DV&&(e.data[r+t.t]-=t.DV,e.data[r+t.t+1]=1)}e.t>0&&(e.data[e.t-1]+=t.am(r,t.data[r],e,2*r,0,1)),e.s=0,e.clamp()}function jp(e,t,r){var n=e.abs();if(!(n.t<=0)){var i=this.abs();if(i.t<n.t){t?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=it());var s=it(),a=this.s,o=e.s,f=this.DB-zi(n.data[n.t-1]);f>0?(n.lShiftTo(f,s),i.lShiftTo(f,r)):(n.copyTo(s),i.copyTo(r));var c=s.t,u=s.data[c-1];if(u!=0){var h=u*(1<<this.F1)+(c>1?s.data[c-2]>>this.F2:0),l=this.FV/h,d=(1<<this.F1)/h,p=1<<this.F2,y=r.t,x=y-c,m=t??it();for(s.dlShiftTo(x,m),r.compareTo(m)>=0&&(r.data[r.t++]=1,r.subTo(m,r)),_.ONE.dlShiftTo(c,m),m.subTo(s,s);s.t<c;)s.data[s.t++]=0;for(;--x>=0;){var b=r.data[--y]==u?this.DM:Math.floor(r.data[y]*l+(r.data[y-1]+p)*d);if((r.data[y]+=s.am(0,b,r,x,0,c))<b)for(s.dlShiftTo(x,m),r.subTo(m,r);r.data[y]<--b;)r.subTo(m,r)}t!=null&&(r.drShiftTo(c,t),a!=o&&_.ZERO.subTo(t,t)),r.t=c,r.clamp(),f>0&&r.rShiftTo(f,r),a<0&&_.ZERO.subTo(r,r)}}}function td(e){var t=it();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(_.ZERO)>0&&e.subTo(t,t),t}function Rr(e){this.m=e}function ed(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e}function rd(e){return e}function nd(e){e.divRemTo(this.m,null,e)}function id(e,t,r){e.multiplyTo(t,r),this.reduce(r)}function sd(e,t){e.squareTo(t),this.reduce(t)}Rr.prototype.convert=ed;Rr.prototype.revert=rd;Rr.prototype.reduce=nd;Rr.prototype.mulTo=id;Rr.prototype.sqrTo=sd;function ad(){if(this.t<1)return 0;var e=this.data[0];if(!(e&1))return 0;var t=e&3;return t=t*(2-(e&15)*t)&15,t=t*(2-(e&255)*t)&255,t=t*(2-((e&65535)*t&65535))&65535,t=t*(2-e*t%this.DV)%this.DV,t>0?this.DV-t:-t}function Ur(e){this.m=e,this.mp=e.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function od(e){var t=it();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(_.ZERO)>0&&this.m.subTo(t,t),t}function fd(e){var t=it();return e.copyTo(t),this.reduce(t),t}function cd(e){for(;e.t<=this.mt2;)e.data[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=e.data[t]&32767,n=r*this.mpl+((r*this.mph+(e.data[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(r=t+this.m.t,e.data[r]+=this.m.am(0,n,e,t,0,this.m.t);e.data[r]>=e.DV;)e.data[r]-=e.DV,e.data[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)}function ud(e,t){e.squareTo(t),this.reduce(t)}function hd(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Ur.prototype.convert=od;Ur.prototype.revert=fd;Ur.prototype.reduce=cd;Ur.prototype.mulTo=hd;Ur.prototype.sqrTo=ud;function ld(){return(this.t>0?this.data[0]&1:this.s)==0}function pd(e,t){if(e>4294967295||e<1)return _.ONE;var r=it(),n=it(),i=t.convert(this),s=zi(e)-1;for(i.copyTo(r);--s>=0;)if(t.sqrTo(r,n),(e&1<<s)>0)t.mulTo(n,i,r);else{var a=r;r=n,n=a}return t.revert(r)}function dd(e,t){var r;return e<256||t.isEven()?r=new Rr(t):r=new Ur(t),this.exp(e,r)}_.prototype.copyTo=Kp;_.prototype.fromInt=Mp;_.prototype.fromString=Fp;_.prototype.clamp=Op;_.prototype.dlShiftTo=Wp;_.prototype.drShiftTo=Yp;_.prototype.lShiftTo=$p;_.prototype.rShiftTo=Xp;_.prototype.subTo=Zp;_.prototype.multiplyTo=Qp;_.prototype.squareTo=Jp;_.prototype.divRemTo=jp;_.prototype.invDigit=ad;_.prototype.isEven=ld;_.prototype.exp=pd;_.prototype.toString=Hp;_.prototype.negate=Vp;_.prototype.abs=qp;_.prototype.compareTo=zp;_.prototype.bitLength=Gp;_.prototype.mod=td;_.prototype.modPowInt=dd;_.ZERO=sr(0);_.ONE=sr(1);function yd(){var e=it();return this.copyTo(e),e}function gd(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this.data[0];if(this.t==0)return 0}return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function xd(){return this.t==0?this.s:this.data[0]<<24>>24}function md(){return this.t==0?this.s:this.data[0]<<16>>16}function vd(e){return Math.floor(Math.LN2*this.DB/Math.log(e))}function bd(){return this.s<0?-1:this.t<=0||this.t==1&&this.data[0]<=0?0:1}function wd(e){if(e==null&&(e=10),this.signum()==0||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=sr(r),i=it(),s=it(),a="";for(this.divRemTo(n,i,s);i.signum()>0;)a=(r+s.intValue()).toString(e).substr(1)+a,i.divRemTo(n,i,s);return s.intValue().toString(e)+a}function Ed(e,t){this.fromInt(0),t==null&&(t=10);for(var r=this.chunkSize(t),n=Math.pow(t,r),i=!1,s=0,a=0,o=0;o<e.length;++o){var f=hc(e,o);if(f<0){e.charAt(o)=="-"&&this.signum()==0&&(i=!0);continue}a=t*a+f,++s>=r&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0)}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),i&&_.ZERO.subTo(this,this)}function Sd(e,t,r){if(typeof t=="number")if(e<2)this.fromInt(1);else for(this.fromNumber(e,r),this.testBit(e-1)||this.bitwiseTo(_.ONE.shiftLeft(e-1),Ba,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(_.ONE.shiftLeft(e-1),this);else{var n=new Array,i=e&7;n.length=(e>>3)+1,t.nextBytes(n),i>0?n[0]&=(1<<i)-1:n[0]=0,this.fromString(n,256)}}function Bd(){var e=this.t,t=new Array;t[0]=this.s;var r=this.DB-e*this.DB%8,n,i=0;if(e-- >0)for(r<this.DB&&(n=this.data[e]>>r)!=(this.s&this.DM)>>r&&(t[i++]=n|this.s<<this.DB-r);e>=0;)r<8?(n=(this.data[e]&(1<<r)-1)<<8-r,n|=this.data[--e]>>(r+=this.DB-8)):(n=this.data[e]>>(r-=8)&255,r<=0&&(r+=this.DB,--e)),n&128&&(n|=-256),i==0&&(this.s&128)!=(n&128)&&++i,(i>0||n!=this.s)&&(t[i++]=n);return t}function Ad(e){return this.compareTo(e)==0}function _d(e){return this.compareTo(e)<0?this:e}function Cd(e){return this.compareTo(e)>0?this:e}function Td(e,t,r){var n,i,s=Math.min(e.t,this.t);for(n=0;n<s;++n)r.data[n]=t(this.data[n],e.data[n]);if(e.t<this.t){for(i=e.s&this.DM,n=s;n<this.t;++n)r.data[n]=t(this.data[n],i);r.t=this.t}else{for(i=this.s&this.DM,n=s;n<e.t;++n)r.data[n]=t(i,e.data[n]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()}function Id(e,t){return e&t}function Ld(e){var t=it();return this.bitwiseTo(e,Id,t),t}function Ba(e,t){return e|t}function Rd(e){var t=it();return this.bitwiseTo(e,Ba,t),t}function lc(e,t){return e^t}function Ud(e){var t=it();return this.bitwiseTo(e,lc,t),t}function pc(e,t){return e&~t}function Nd(e){var t=it();return this.bitwiseTo(e,pc,t),t}function Pd(){for(var e=it(),t=0;t<this.t;++t)e.data[t]=this.DM&~this.data[t];return e.t=this.t,e.s=~this.s,e}function kd(e){var t=it();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t}function Dd(e){var t=it();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t}function Kd(e){if(e==0)return-1;var t=0;return e&65535||(e>>=16,t+=16),e&255||(e>>=8,t+=8),e&15||(e>>=4,t+=4),e&3||(e>>=2,t+=2),e&1||++t,t}function Md(){for(var e=0;e<this.t;++e)if(this.data[e]!=0)return e*this.DB+Kd(this.data[e]);return this.s<0?this.t*this.DB:-1}function Fd(e){for(var t=0;e!=0;)e&=e-1,++t;return t}function Od(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=Fd(this.data[r]^t);return e}function Hd(e){var t=Math.floor(e/this.DB);return t>=this.t?this.s!=0:(this.data[t]&1<<e%this.DB)!=0}function Vd(e,t){var r=_.ONE.shiftLeft(e);return this.bitwiseTo(r,t,r),r}function qd(e){return this.changeBit(e,Ba)}function zd(e){return this.changeBit(e,pc)}function Gd(e){return this.changeBit(e,lc)}function Wd(e,t){for(var r=0,n=0,i=Math.min(e.t,this.t);r<i;)n+=this.data[r]+e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;if(e.t<this.t){for(n+=e.s;r<this.t;)n+=this.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=this.s}else{for(n+=this.s;r<e.t;)n+=e.data[r],t.data[r++]=n&this.DM,n>>=this.DB;n+=e.s}t.s=n<0?-1:0,n>0?t.data[r++]=n:n<-1&&(t.data[r++]=this.DV+n),t.t=r,t.clamp()}function Yd(e){var t=it();return this.addTo(e,t),t}function $d(e){var t=it();return this.subTo(e,t),t}function Xd(e){var t=it();return this.multiplyTo(e,t),t}function Zd(e){var t=it();return this.divRemTo(e,t,null),t}function Qd(e){var t=it();return this.divRemTo(e,null,t),t}function Jd(e){var t=it(),r=it();return this.divRemTo(e,t,r),new Array(t,r)}function jd(e){this.data[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()}function ty(e,t){if(e!=0){for(;this.t<=t;)this.data[this.t++]=0;for(this.data[t]+=e;this.data[t]>=this.DV;)this.data[t]-=this.DV,++t>=this.t&&(this.data[this.t++]=0),++this.data[t]}}function Mn(){}function dc(e){return e}function ey(e,t,r){e.multiplyTo(t,r)}function ry(e,t){e.squareTo(t)}Mn.prototype.convert=dc;Mn.prototype.revert=dc;Mn.prototype.mulTo=ey;Mn.prototype.sqrTo=ry;function ny(e){return this.exp(e,new Mn)}function iy(e,t,r){var n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r.data[--n]=0;var i;for(i=r.t-this.t;n<i;++n)r.data[n+this.t]=this.am(0,e.data[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e.data[n],r,n,0,t-n);r.clamp()}function sy(e,t,r){--t;var n=r.t=this.t+e.t-t;for(r.s=0;--n>=0;)r.data[n]=0;for(n=Math.max(t-this.t,0);n<e.t;++n)r.data[this.t+n-t]=this.am(t-n,e.data[n],r,0,0,this.t+n-t);r.clamp(),r.drShiftTo(1,r)}function Qr(e){this.r2=it(),this.q3=it(),_.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}function ay(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=it();return e.copyTo(t),this.reduce(t),t}function oy(e){return e}function fy(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)}function cy(e,t){e.squareTo(t),this.reduce(t)}function uy(e,t,r){e.multiplyTo(t,r),this.reduce(r)}Qr.prototype.convert=ay;Qr.prototype.revert=oy;Qr.prototype.reduce=fy;Qr.prototype.mulTo=uy;Qr.prototype.sqrTo=cy;function hy(e,t){var r=e.bitLength(),n,i=sr(1),s;if(r<=0)return i;r<18?n=1:r<48?n=3:r<144?n=4:r<768?n=5:n=6,r<8?s=new Rr(t):t.isEven()?s=new Qr(t):s=new Ur(t);var a=new Array,o=3,f=n-1,c=(1<<n)-1;if(a[1]=s.convert(this),n>1){var u=it();for(s.sqrTo(a[1],u);o<=c;)a[o]=it(),s.mulTo(u,a[o-2],a[o]),o+=2}var h=e.t-1,l,d=!0,p=it(),y;for(r=zi(e.data[h])-1;h>=0;){for(r>=f?l=e.data[h]>>r-f&c:(l=(e.data[h]&(1<<r+1)-1)<<f-r,h>0&&(l|=e.data[h-1]>>this.DB+r-f)),o=n;!(l&1);)l>>=1,--o;if((r-=o)<0&&(r+=this.DB,--h),d)a[l].copyTo(i),d=!1;else{for(;o>1;)s.sqrTo(i,p),s.sqrTo(p,i),o-=2;o>0?s.sqrTo(i,p):(y=i,i=p,p=y),s.mulTo(p,a[l],i)}for(;h>=0&&!(e.data[h]&1<<r);)s.sqrTo(i,p),y=i,i=p,p=y,--r<0&&(r=this.DB-1,--h)}return s.revert(i)}function ly(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var n=t;t=r,r=n}var i=t.getLowestSetBit(),s=r.getLowestSetBit();if(s<0)return t;for(i<s&&(s=i),s>0&&(t.rShiftTo(s,t),r.rShiftTo(s,r));t.signum()>0;)(i=t.getLowestSetBit())>0&&t.rShiftTo(i,t),(i=r.getLowestSetBit())>0&&r.rShiftTo(i,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return s>0&&r.lShiftTo(s,r),r}function py(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(t==0)r=this.data[0]%e;else for(var n=this.t-1;n>=0;--n)r=(t*r+this.data[n])%e;return r}function dy(e){var t=e.isEven();if(this.isEven()&&t||e.signum()==0)return _.ZERO;for(var r=e.clone(),n=this.clone(),i=sr(1),s=sr(0),a=sr(0),o=sr(1);r.signum()!=0;){for(;r.isEven();)r.rShiftTo(1,r),t?((!i.isEven()||!s.isEven())&&(i.addTo(this,i),s.subTo(e,s)),i.rShiftTo(1,i)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?((!a.isEven()||!o.isEven())&&(a.addTo(this,a),o.subTo(e,o)),a.rShiftTo(1,a)):o.isEven()||o.subTo(e,o),o.rShiftTo(1,o);r.compareTo(n)>=0?(r.subTo(n,r),t&&i.subTo(a,i),s.subTo(o,s)):(n.subTo(r,n),t&&a.subTo(i,a),o.subTo(s,o))}if(n.compareTo(_.ONE)!=0)return _.ZERO;if(o.compareTo(e)>=0)return o.subtract(e);if(o.signum()<0)o.addTo(e,o);else return o;return o.signum()<0?o.add(e):o}var we=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],yy=(1<<26)/we[we.length-1];function gy(e){var t,r=this.abs();if(r.t==1&&r.data[0]<=we[we.length-1]){for(t=0;t<we.length;++t)if(r.data[0]==we[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<we.length;){for(var n=we[t],i=t+1;i<we.length&&n<yy;)n*=we[i++];for(n=r.modInt(n);t<i;)if(n%we[t++]==0)return!1}return r.millerRabin(e)}function xy(e){var t=this.subtract(_.ONE),r=t.getLowestSetBit();if(r<=0)return!1;for(var n=t.shiftRight(r),i=my(),s,a=0;a<e;++a){do s=new _(this.bitLength(),i);while(s.compareTo(_.ONE)<=0||s.compareTo(t)>=0);var o=s.modPow(n,this);if(o.compareTo(_.ONE)!=0&&o.compareTo(t)!=0){for(var f=1;f++<r&&o.compareTo(t)!=0;)if(o=o.modPowInt(2,this),o.compareTo(_.ONE)==0)return!1;if(o.compareTo(t)!=0)return!1}}return!0}function my(){return{nextBytes:function(e){for(var t=0;t<e.length;++t)e[t]=Math.floor(Math.random()*256)}}}_.prototype.chunkSize=vd;_.prototype.toRadix=wd;_.prototype.fromRadix=Ed;_.prototype.fromNumber=Sd;_.prototype.bitwiseTo=Td;_.prototype.changeBit=Vd;_.prototype.addTo=Wd;_.prototype.dMultiply=jd;_.prototype.dAddOffset=ty;_.prototype.multiplyLowerTo=iy;_.prototype.multiplyUpperTo=sy;_.prototype.modInt=py;_.prototype.millerRabin=xy;_.prototype.clone=yd;_.prototype.intValue=gd;_.prototype.byteValue=xd;_.prototype.shortValue=md;_.prototype.signum=bd;_.prototype.toByteArray=Bd;_.prototype.equals=Ad;_.prototype.min=_d;_.prototype.max=Cd;_.prototype.and=Ld;_.prototype.or=Rd;_.prototype.xor=Ud;_.prototype.andNot=Nd;_.prototype.not=Pd;_.prototype.shiftLeft=kd;_.prototype.shiftRight=Dd;_.prototype.getLowestSetBit=Md;_.prototype.bitCount=Od;_.prototype.testBit=Hd;_.prototype.setBit=qd;_.prototype.clearBit=zd;_.prototype.flipBit=Gd;_.prototype.add=Yd;_.prototype.subtract=$d;_.prototype.multiply=Xd;_.prototype.divide=Zd;_.prototype.remainder=Qd;_.prototype.divideAndRemainder=Jd;_.prototype.modPow=hy;_.prototype.modInverse=dy;_.prototype.pow=ny;_.prototype.gcd=ly;_.prototype.isProbablePrime=gy});var bc=k((Sm,vc)=>{var De=dt();Lr();Ut();var xc=vc.exports=De.sha1=De.sha1||{};De.md.sha1=De.md.algorithms.sha1=xc;xc.create=function(){mc||vy();var e=null,t=De.util.createBuffer(),r=new Array(80),n={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return n.start=function(){n.messageLength=0,n.fullMessageLength=n.messageLength64=[];for(var i=n.messageLengthSize/4,s=0;s<i;++s)n.fullMessageLength.push(0);return t=De.util.createBuffer(),e={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},n},n.start(),n.update=function(i,s){s==="utf8"&&(i=De.util.encodeUtf8(i));var a=i.length;n.messageLength+=a,a=[a/4294967296>>>0,a>>>0];for(var o=n.fullMessageLength.length-1;o>=0;--o)n.fullMessageLength[o]+=a[1],a[1]=a[0]+(n.fullMessageLength[o]/4294967296>>>0),n.fullMessageLength[o]=n.fullMessageLength[o]>>>0,a[0]=a[1]/4294967296>>>0;return t.putBytes(i),gc(e,r,t),(t.read>2048||t.length()===0)&&t.compact(),n},n.digest=function(){var i=De.util.createBuffer();i.putBytes(t.bytes());var s=n.fullMessageLength[n.fullMessageLength.length-1]+n.messageLengthSize,a=s&n.blockLength-1;i.putBytes(Aa.substr(0,n.blockLength-a));for(var o,f,c=n.fullMessageLength[0]*8,u=0;u<n.fullMessageLength.length-1;++u)o=n.fullMessageLength[u+1]*8,f=o/4294967296>>>0,c+=f,i.putInt32(c>>>0),c=o>>>0;i.putInt32(c);var h={h0:e.h0,h1:e.h1,h2:e.h2,h3:e.h3,h4:e.h4};gc(h,r,i);var l=De.util.createBuffer();return l.putInt32(h.h0),l.putInt32(h.h1),l.putInt32(h.h2),l.putInt32(h.h3),l.putInt32(h.h4),l},n};var Aa=null,mc=!1;function vy(){Aa=String.fromCharCode(128),Aa+=De.util.fillString(String.fromCharCode(0),64),mc=!0}function gc(e,t,r){for(var n,i,s,a,o,f,c,u,h=r.length();h>=64;){for(i=e.h0,s=e.h1,a=e.h2,o=e.h3,f=e.h4,u=0;u<16;++u)n=r.getInt32(),t[u]=n,c=o^s&(a^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<20;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,c=o^s&(a^o),n=(i<<5|i>>>27)+c+f+1518500249+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<32;++u)n=t[u-3]^t[u-8]^t[u-14]^t[u-16],n=n<<1|n>>>31,t[u]=n,c=s^a^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<40;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,c=s^a^o,n=(i<<5|i>>>27)+c+f+1859775393+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<60;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,c=s&a|o&(s^a),n=(i<<5|i>>>27)+c+f+2400959708+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;for(;u<80;++u)n=t[u-6]^t[u-16]^t[u-28]^t[u-32],n=n<<2|n>>>30,t[u]=n,c=s^a^o,n=(i<<5|i>>>27)+c+f+3395469782+n,f=o,o=a,a=(s<<30|s>>>2)>>>0,s=i,i=n;e.h0=e.h0+i|0,e.h1=e.h1+s|0,e.h2=e.h2+a|0,e.h3=e.h3+o|0,e.h4=e.h4+f|0,h-=64}}});var Sc=k((Bm,Ec)=>{var Ke=dt();Ut();Kn();bc();var wc=Ec.exports=Ke.pkcs1=Ke.pkcs1||{};wc.encode_rsa_oaep=function(e,t,r){var n,i,s,a;typeof r=="string"?(n=r,i=arguments[3]||void 0,s=arguments[4]||void 0):r&&(n=r.label||void 0,i=r.seed||void 0,s=r.md||void 0,r.mgf1&&r.mgf1.md&&(a=r.mgf1.md)),s?s.start():s=Ke.md.sha1.create(),a||(a=s);var o=Math.ceil(e.n.bitLength()/8),f=o-2*s.digestLength-2;if(t.length>f){var c=new Error("RSAES-OAEP input message length is too long.");throw c.length=t.length,c.maxLength=f,c}n||(n=""),s.update(n,"raw");for(var u=s.digest(),h="",l=f-t.length,d=0;d<l;d++)h+="\0";var p=u.getBytes()+h+""+t;if(!i)i=Ke.random.getBytes(s.digestLength);else if(i.length!==s.digestLength){var c=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw c.seedLength=i.length,c.digestLength=s.digestLength,c}var y=Wi(i,o-s.digestLength-1,a),x=Ke.util.xorBytes(p,y,p.length),m=Wi(x,s.digestLength,a),b=Ke.util.xorBytes(i,m,i.length);return"\0"+b+x};wc.decode_rsa_oaep=function(e,t,r){var n,i,s;typeof r=="string"?(n=r,i=arguments[3]||void 0):r&&(n=r.label||void 0,i=r.md||void 0,r.mgf1&&r.mgf1.md&&(s=r.mgf1.md));var a=Math.ceil(e.n.bitLength()/8);if(t.length!==a){var x=new Error("RSAES-OAEP encoded message length is invalid.");throw x.length=t.length,x.expectedLength=a,x}if(i===void 0?i=Ke.md.sha1.create():i.start(),s||(s=i),a<2*i.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");n||(n=""),i.update(n,"raw");for(var o=i.digest().getBytes(),f=t.charAt(0),c=t.substring(1,i.digestLength+1),u=t.substring(1+i.digestLength),h=Wi(u,i.digestLength,s),l=Ke.util.xorBytes(c,h,c.length),d=Wi(l,a-i.digestLength-1,s),p=Ke.util.xorBytes(u,d,u.length),y=p.substring(0,i.digestLength),x=f!=="\0",m=0;m<i.digestLength;++m)x|=o.charAt(m)!==y.charAt(m);for(var b=1,w=i.digestLength,C=i.digestLength;C<p.length;C++){var B=p.charCodeAt(C),A=B&1^1,L=b?65534:0;x|=B&L,b=b&A,w+=b}if(x||p.charCodeAt(w)!==1)throw new Error("Invalid RSAES-OAEP padding.");return p.substring(w+1)};function Wi(e,t,r){r||(r=Ke.md.sha1.create());for(var n="",i=Math.ceil(t/r.digestLength),s=0;s<i;++s){var a=String.fromCharCode(s>>24&255,s>>16&255,s>>8&255,s&255);r.start(),r.update(e+a),n+=r.digest().getBytes()}return n.substring(0,t)}});var Bc=k((Am,_a)=>{var ar=dt();Ut();Gi();Kn();(function(){if(ar.prime){_a.exports=ar.prime;return}var e=_a.exports=ar.prime=ar.prime||{},t=ar.jsbn.BigInteger,r=[6,4,2,4,2,4,6,2],n=new t(null);n.fromInt(30);var i=function(h,l){return h|l};e.generateProbablePrime=function(h,l,d){typeof l=="function"&&(d=l,l={}),l=l||{};var p=l.algorithm||"PRIMEINC";typeof p=="string"&&(p={name:p}),p.options=p.options||{};var y=l.prng||ar.random,x={nextBytes:function(m){for(var b=y.getBytesSync(m.length),w=0;w<m.length;++w)m[w]=b.charCodeAt(w)}};if(p.name==="PRIMEINC")return s(h,x,p.options,d);throw new Error("Invalid prime generation algorithm: "+p.name)};function s(h,l,d,p){return"workers"in d?f(h,l,d,p):a(h,l,d,p)}function a(h,l,d,p){var y=c(h,l),x=0,m=u(y.bitLength());"millerRabinTests"in d&&(m=d.millerRabinTests);var b=10;"maxBlockTime"in d&&(b=d.maxBlockTime),o(y,h,l,x,m,b,p)}function o(h,l,d,p,y,x,m){var b=+new Date;do{if(h.bitLength()>l&&(h=c(l,d)),h.isProbablePrime(y))return m(null,h);h.dAddOffset(r[p++%8],0)}while(x<0||+new Date-b<x);ar.util.setImmediate(function(){o(h,l,d,p,y,x,m)})}function f(h,l,d,p){if(typeof Worker>"u")return a(h,l,d,p);var y=c(h,l),x=d.workers,m=d.workLoad||100,b=m*30/8,w=d.workerScript||"forge/prime.worker.js";if(x===-1)return ar.util.estimateCores(function(B,A){B&&(A=2),x=A-1,C()});C();function C(){x=Math.max(1,x);for(var B=[],A=0;A<x;++A)B[A]=new Worker(w);for(var L=x,A=0;A<x;++A)B[A].addEventListener("message",D);var R=!1;function D(O){if(!R){--L;var G=O.data;if(G.found){for(var z=0;z<B.length;++z)B[z].terminate();return R=!0,p(null,new t(G.prime,16))}y.bitLength()>h&&(y=c(h,l));var rt=y.toString(16);O.target.postMessage({hex:rt,workLoad:m}),y.dAddOffset(b,0)}}}}function c(h,l){var d=new t(h,l),p=h-1;return d.testBit(p)||d.bitwiseTo(t.ONE.shiftLeft(p),i,d),d.dAddOffset(31-d.mod(n).byteValue(),0),d}function u(h){return h<=100?27:h<=150?18:h<=200?15:h<=250?12:h<=300?9:h<=350?8:h<=400?7:h<=500?6:h<=600?5:h<=800?4:h<=1250?3:2}})()});var $i=k((_m,Rc)=>{var M=dt();Dn();Gi();Ni();Sc();Bc();Kn();Ut();typeof j>"u"&&(j=M.jsbn.BigInteger);var j,Ca=M.util.isNodejs?wr():null,v=M.asn1,de=M.util;M.pki=M.pki||{};Rc.exports=M.pki.rsa=M.rsa=M.rsa||{};var q=M.pki,by=[6,4,2,4,2,4,6,2],wy={name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},Ey={name:"RSAPrivateKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},Sy={name:"RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:v.Class.UNIVERSAL,type:v.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},By=M.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},Ay={name:"DigestInfo",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:v.Class.UNIVERSAL,type:v.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:v.Class.UNIVERSAL,type:v.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:v.Class.UNIVERSAL,type:v.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:v.Class.UNIVERSAL,type:v.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},_y=function(e){var t;if(e.algorithm in q.oids)t=q.oids[e.algorithm];else{var r=new Error("Unknown message digest algorithm.");throw r.algorithm=e.algorithm,r}var n=v.oidToDer(t).getBytes(),i=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]),s=v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[]);s.value.push(v.create(v.Class.UNIVERSAL,v.Type.OID,!1,n)),s.value.push(v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,""));var a=v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,e.digest().getBytes());return i.value.push(s),i.value.push(a),v.toDer(i).getBytes()},Ic=function(e,t,r){if(r)return e.modPow(t.e,t.n);if(!t.p||!t.q)return e.modPow(t.d,t.n);t.dP||(t.dP=t.d.mod(t.p.subtract(j.ONE))),t.dQ||(t.dQ=t.d.mod(t.q.subtract(j.ONE))),t.qInv||(t.qInv=t.q.modInverse(t.p));var n;do n=new j(M.util.bytesToHex(M.random.getBytes(t.n.bitLength()/8)),16);while(n.compareTo(t.n)>=0||!n.gcd(t.n).equals(j.ONE));e=e.multiply(n.modPow(t.e,t.n)).mod(t.n);for(var i=e.mod(t.p).modPow(t.dP,t.p),s=e.mod(t.q).modPow(t.dQ,t.q);i.compareTo(s)<0;)i=i.add(t.p);var a=i.subtract(s).multiply(t.qInv).mod(t.p).multiply(t.q).add(s);return a=a.multiply(n.modInverse(t.n)).mod(t.n),a};q.rsa.encrypt=function(e,t,r){var n=r,i,s=Math.ceil(t.n.bitLength()/8);r!==!1&&r!==!0?(n=r===2,i=Lc(e,t,r)):(i=M.util.createBuffer(),i.putBytes(e));for(var a=new j(i.toHex(),16),o=Ic(a,t,n),f=o.toString(16),c=M.util.createBuffer(),u=s-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(M.util.hexToBytes(f)),c.getBytes()};q.rsa.decrypt=function(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8);if(e.length!==i){var s=new Error("Encrypted message length is invalid.");throw s.length=e.length,s.expected=i,s}var a=new j(M.util.createBuffer(e).toHex(),16);if(a.compareTo(t.n)>=0)throw new Error("Encrypted message is invalid.");for(var o=Ic(a,t,r),f=o.toString(16),c=M.util.createBuffer(),u=i-Math.ceil(f.length/2);u>0;)c.putByte(0),--u;return c.putBytes(M.util.hexToBytes(f)),n!==!1?Yi(c.getBytes(),t,r):c.getBytes()};q.rsa.createKeyPairGenerationState=function(e,t,r){typeof e=="string"&&(e=parseInt(e,10)),e=e||2048,r=r||{};var n=r.prng||M.random,i={nextBytes:function(o){for(var f=n.getBytesSync(o.length),c=0;c<o.length;++c)o[c]=f.charCodeAt(c)}},s=r.algorithm||"PRIMEINC",a;if(s==="PRIMEINC")a={algorithm:s,state:0,bits:e,rng:i,eInt:t||65537,e:new j(null),p:null,q:null,qBits:e>>1,pBits:e-(e>>1),pqState:0,num:null,keys:null},a.e.fromInt(a.eInt);else throw new Error("Invalid key generation algorithm: "+s);return a};q.rsa.stepKeyPairGenerationState=function(e,t){"algorithm"in e||(e.algorithm="PRIMEINC");var r=new j(null);r.fromInt(30);for(var n=0,i=function(h,l){return h|l},s=+new Date,a,o=0;e.keys===null&&(t<=0||o<t);){if(e.state===0){var f=e.p===null?e.pBits:e.qBits,c=f-1;e.pqState===0?(e.num=new j(f,e.rng),e.num.testBit(c)||e.num.bitwiseTo(j.ONE.shiftLeft(c),i,e.num),e.num.dAddOffset(31-e.num.mod(r).byteValue(),0),n=0,++e.pqState):e.pqState===1?e.num.bitLength()>f?e.pqState=0:e.num.isProbablePrime(Ty(e.num.bitLength()))?++e.pqState:e.num.dAddOffset(by[n++%8],0):e.pqState===2?e.pqState=e.num.subtract(j.ONE).gcd(e.e).compareTo(j.ONE)===0?3:0:e.pqState===3&&(e.pqState=0,e.p===null?e.p=e.num:e.q=e.num,e.p!==null&&e.q!==null&&++e.state,e.num=null)}else if(e.state===1)e.p.compareTo(e.q)<0&&(e.num=e.p,e.p=e.q,e.q=e.num),++e.state;else if(e.state===2)e.p1=e.p.subtract(j.ONE),e.q1=e.q.subtract(j.ONE),e.phi=e.p1.multiply(e.q1),++e.state;else if(e.state===3)e.phi.gcd(e.e).compareTo(j.ONE)===0?++e.state:(e.p=null,e.q=null,e.state=0);else if(e.state===4)e.n=e.p.multiply(e.q),e.n.bitLength()===e.bits?++e.state:(e.q=null,e.state=0);else if(e.state===5){var u=e.e.modInverse(e.phi);e.keys={privateKey:q.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:q.rsa.setPublicKey(e.n,e.e)}}a=+new Date,o+=a-s,s=a}return e.keys!==null};q.rsa.generateKeyPair=function(e,t,r,n){if(arguments.length===1?typeof e=="object"?(r=e,e=void 0):typeof e=="function"&&(n=e,e=void 0):arguments.length===2?typeof e=="number"?typeof t=="function"?(n=t,t=void 0):typeof t!="number"&&(r=t,t=void 0):(r=e,n=t,e=void 0,t=void 0):arguments.length===3&&(typeof t=="number"?typeof r=="function"&&(n=r,r=void 0):(n=r,r=t,t=void 0)),r=r||{},e===void 0&&(e=r.bits||2048),t===void 0&&(t=r.e||65537),!M.options.usePureJavaScript&&!r.prng&&e>=256&&e<=16384&&(t===65537||t===3)){if(n){if(Ac("generateKeyPair"))return Ca.generateKeyPair("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(o,f,c){if(o)return n(o);n(null,{privateKey:q.privateKeyFromPem(c),publicKey:q.publicKeyFromPem(f)})});if(_c("generateKey")&&_c("exportKey"))return de.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Tc(t),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(o){return de.globalScope.crypto.subtle.exportKey("pkcs8",o.privateKey)}).then(void 0,function(o){n(o)}).then(function(o){if(o){var f=q.privateKeyFromAsn1(v.fromDer(M.util.createBuffer(o)));n(null,{privateKey:f,publicKey:q.setRsaPublicKey(f.n,f.e)})}});if(Cc("generateKey")&&Cc("exportKey")){var i=de.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:Tc(t),hash:{name:"SHA-256"}},!0,["sign","verify"]);i.oncomplete=function(o){var f=o.target.result,c=de.globalScope.msCrypto.subtle.exportKey("pkcs8",f.privateKey);c.oncomplete=function(u){var h=u.target.result,l=q.privateKeyFromAsn1(v.fromDer(M.util.createBuffer(h)));n(null,{privateKey:l,publicKey:q.setRsaPublicKey(l.n,l.e)})},c.onerror=function(u){n(u)}},i.onerror=function(o){n(o)};return}}else if(Ac("generateKeyPairSync")){var s=Ca.generateKeyPairSync("rsa",{modulusLength:e,publicExponent:t,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:q.privateKeyFromPem(s.privateKey),publicKey:q.publicKeyFromPem(s.publicKey)}}}var a=q.rsa.createKeyPairGenerationState(e,t,r);if(!n)return q.rsa.stepKeyPairGenerationState(a,0),a.keys;Cy(a,r,n)};q.setRsaPublicKey=q.rsa.setPublicKey=function(e,t){var r={n:e,e:t};return r.encrypt=function(n,i,s){if(typeof i=="string"?i=i.toUpperCase():i===void 0&&(i="RSAES-PKCS1-V1_5"),i==="RSAES-PKCS1-V1_5")i={encode:function(o,f,c){return Lc(o,f,2).getBytes()}};else if(i==="RSA-OAEP"||i==="RSAES-OAEP")i={encode:function(o,f){return M.pkcs1.encode_rsa_oaep(f,o,s)}};else if(["RAW","NONE","NULL",null].indexOf(i)!==-1)i={encode:function(o){return o}};else if(typeof i=="string")throw new Error('Unsupported encryption scheme: "'+i+'".');var a=i.encode(n,r,!0);return q.rsa.encrypt(a,r,!0)},r.verify=function(n,i,s,a){typeof s=="string"?s=s.toUpperCase():s===void 0&&(s="RSASSA-PKCS1-V1_5"),a===void 0&&(a={_parseAllDigestBytes:!0}),"_parseAllDigestBytes"in a||(a._parseAllDigestBytes=!0),s==="RSASSA-PKCS1-V1_5"?s={verify:function(f,c){c=Yi(c,r,!0);var u=v.fromDer(c,{parseAllBytes:a._parseAllDigestBytes}),h={},l=[];if(!v.validate(u,Ay,h,l)){var d=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw d.errors=l,d}var p=v.derToOid(h.algorithmIdentifier);if(!(p===M.oids.md2||p===M.oids.md5||p===M.oids.sha1||p===M.oids.sha224||p===M.oids.sha256||p===M.oids.sha384||p===M.oids.sha512||p===M.oids["sha512-224"]||p===M.oids["sha512-256"])){var d=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw d.oid=p,d}if((p===M.oids.md2||p===M.oids.md5)&&!("parameters"in h))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.");return f===h.digest}}:(s==="NONE"||s==="NULL"||s===null)&&(s={verify:function(f,c){return c=Yi(c,r,!0),f===c}});var o=q.rsa.decrypt(i,r,!0,!1);return s.verify(n,o,r.n.bitLength())},r};q.setRsaPrivateKey=q.rsa.setPrivateKey=function(e,t,r,n,i,s,a,o){var f={n:e,e:t,d:r,p:n,q:i,dP:s,dQ:a,qInv:o};return f.decrypt=function(c,u,h){typeof u=="string"?u=u.toUpperCase():u===void 0&&(u="RSAES-PKCS1-V1_5");var l=q.rsa.decrypt(c,f,!1,!1);if(u==="RSAES-PKCS1-V1_5")u={decode:Yi};else if(u==="RSA-OAEP"||u==="RSAES-OAEP")u={decode:function(d,p){return M.pkcs1.decode_rsa_oaep(p,d,h)}};else if(["RAW","NONE","NULL",null].indexOf(u)!==-1)u={decode:function(d){return d}};else throw new Error('Unsupported encryption scheme: "'+u+'".');return u.decode(l,f,!1)},f.sign=function(c,u){var h=!1;typeof u=="string"&&(u=u.toUpperCase()),u===void 0||u==="RSASSA-PKCS1-V1_5"?(u={encode:_y},h=1):(u==="NONE"||u==="NULL"||u===null)&&(u={encode:function(){return c}},h=1);var l=u.encode(c,f.n.bitLength());return q.rsa.encrypt(l,f,h)},f};q.wrapRsaPrivateKey=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(q.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.OCTETSTRING,!1,v.toDer(e).getBytes())])};q.privateKeyFromAsn1=function(e){var t={},r=[];if(v.validate(e,wy,t,r)&&(e=v.fromDer(M.util.createBuffer(t.privateKey))),t={},r=[],!v.validate(e,Ey,t,r)){var n=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw n.errors=r,n}var i,s,a,o,f,c,u,h;return i=M.util.createBuffer(t.privateKeyModulus).toHex(),s=M.util.createBuffer(t.privateKeyPublicExponent).toHex(),a=M.util.createBuffer(t.privateKeyPrivateExponent).toHex(),o=M.util.createBuffer(t.privateKeyPrime1).toHex(),f=M.util.createBuffer(t.privateKeyPrime2).toHex(),c=M.util.createBuffer(t.privateKeyExponent1).toHex(),u=M.util.createBuffer(t.privateKeyExponent2).toHex(),h=M.util.createBuffer(t.privateKeyCoefficient).toHex(),q.setRsaPrivateKey(new j(i,16),new j(s,16),new j(a,16),new j(o,16),new j(f,16),new j(c,16),new j(u,16),new j(h,16))};q.privateKeyToAsn1=q.privateKeyToRSAPrivateKey=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,v.integerToDer(0).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Me(e.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Me(e.e)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Me(e.d)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Me(e.p)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Me(e.q)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Me(e.dP)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Me(e.dQ)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Me(e.qInv))])};q.publicKeyFromAsn1=function(e){var t={},r=[];if(v.validate(e,By,t,r)){var n=v.derToOid(t.publicKeyOid);if(n!==q.oids.rsaEncryption){var i=new Error("Cannot read public key. Unknown OID.");throw i.oid=n,i}e=t.rsaPublicKey}if(r=[],!v.validate(e,Sy,t,r)){var i=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw i.errors=r,i}var s=M.util.createBuffer(t.publicKeyModulus).toHex(),a=M.util.createBuffer(t.publicKeyExponent).toHex();return q.setRsaPublicKey(new j(s,16),new j(a,16))};q.publicKeyToAsn1=q.publicKeyToSubjectPublicKeyInfo=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.OID,!1,v.oidToDer(q.oids.rsaEncryption).getBytes()),v.create(v.Class.UNIVERSAL,v.Type.NULL,!1,"")]),v.create(v.Class.UNIVERSAL,v.Type.BITSTRING,!1,[q.publicKeyToRSAPublicKey(e)])])};q.publicKeyToRSAPublicKey=function(e){return v.create(v.Class.UNIVERSAL,v.Type.SEQUENCE,!0,[v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Me(e.n)),v.create(v.Class.UNIVERSAL,v.Type.INTEGER,!1,Me(e.e))])};function Lc(e,t,r){var n=M.util.createBuffer(),i=Math.ceil(t.n.bitLength()/8);if(e.length>i-11){var s=new Error("Message is too long for PKCS#1 v1.5 padding.");throw s.length=e.length,s.max=i-11,s}n.putByte(0),n.putByte(r);var a=i-3-e.length,o;if(r===0||r===1){o=r===0?0:255;for(var f=0;f<a;++f)n.putByte(o)}else for(;a>0;){for(var c=0,u=M.random.getBytes(a),f=0;f<a;++f)o=u.charCodeAt(f),o===0?++c:n.putByte(o);a=c}return n.putByte(0),n.putBytes(e),n}function Yi(e,t,r,n){var i=Math.ceil(t.n.bitLength()/8),s=M.util.createBuffer(e),a=s.getByte(),o=s.getByte();if(a!==0||r&&o!==0&&o!==1||!r&&o!=2||r&&o===0&&typeof n>"u")throw new Error("Encryption block is invalid.");var f=0;if(o===0){f=i-3-n;for(var c=0;c<f;++c)if(s.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(o===1)for(f=0;s.length()>1;){if(s.getByte()!==255){--s.read;break}++f}else if(o===2)for(f=0;s.length()>1;){if(s.getByte()===0){--s.read;break}++f}var u=s.getByte();if(u!==0||f!==i-3-s.length())throw new Error("Encryption block is invalid.");return s.getBytes()}function Cy(e,t,r){typeof t=="function"&&(r=t,t={}),t=t||{};var n={algorithm:{name:t.algorithm||"PRIMEINC",options:{workers:t.workers||2,workLoad:t.workLoad||100,workerScript:t.workerScript}}};"prng"in t&&(n.prng=t.prng),i();function i(){s(e.pBits,function(o,f){if(o)return r(o);if(e.p=f,e.q!==null)return a(o,e.q);s(e.qBits,a)})}function s(o,f){M.prime.generateProbablePrime(o,n,f)}function a(o,f){if(o)return r(o);if(e.q=f,e.p.compareTo(e.q)<0){var c=e.p;e.p=e.q,e.q=c}if(e.p.subtract(j.ONE).gcd(e.e).compareTo(j.ONE)!==0){e.p=null,i();return}if(e.q.subtract(j.ONE).gcd(e.e).compareTo(j.ONE)!==0){e.q=null,s(e.qBits,a);return}if(e.p1=e.p.subtract(j.ONE),e.q1=e.q.subtract(j.ONE),e.phi=e.p1.multiply(e.q1),e.phi.gcd(e.e).compareTo(j.ONE)!==0){e.p=e.q=null,i();return}if(e.n=e.p.multiply(e.q),e.n.bitLength()!==e.bits){e.q=null,s(e.qBits,a);return}var u=e.e.modInverse(e.phi);e.keys={privateKey:q.rsa.setPrivateKey(e.n,e.e,u,e.p,e.q,u.mod(e.p1),u.mod(e.q1),e.q.modInverse(e.p)),publicKey:q.rsa.setPublicKey(e.n,e.e)},r(null,e.keys)}}function Me(e){var t=e.toString(16);t[0]>="8"&&(t="00"+t);var r=M.util.hexToBytes(t);return r.length>1&&(r.charCodeAt(0)===0&&!(r.charCodeAt(1)&128)||r.charCodeAt(0)===255&&(r.charCodeAt(1)&128)===128)?r.substr(1):r}function Ty(e){return e<=100?27:e<=150?18:e<=200?15:e<=250?12:e<=300?9:e<=350?8:e<=400?7:e<=500?6:e<=600?5:e<=800?4:e<=1250?3:2}function Ac(e){return M.util.isNodejs&&typeof Ca[e]=="function"}function _c(e){return typeof de.globalScope<"u"&&typeof de.globalScope.crypto=="object"&&typeof de.globalScope.crypto.subtle=="object"&&typeof de.globalScope.crypto.subtle[e]=="function"}function Cc(e){return typeof de.globalScope<"u"&&typeof de.globalScope.msCrypto=="object"&&typeof de.globalScope.msCrypto.subtle=="object"&&typeof de.globalScope.msCrypto.subtle[e]=="function"}function Tc(e){for(var t=M.util.hexToBytes(e.toString(16)),r=new Uint8Array(t.length),n=0;n<t.length;++n)r[n]=t.charCodeAt(n);return r}});var Kc=k((Cm,Dc)=>{var N=dt();ma();Dn();Hf();Lr();Ni();Wf();Xf();Kn();oc();$i();Ut();typeof Uc>"u"&&(Uc=N.jsbn.BigInteger);var Uc,E=N.asn1,W=N.pki=N.pki||{};Dc.exports=W.pbe=N.pbe=N.pbe||{};var Nr=W.oids,Iy={name:"EncryptedPrivateKeyInfo",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},Ly={name:"PBES2Algorithms",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:E.Class.UNIVERSAL,type:E.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},Ry={name:"pkcs-12PbeParams",tagClass:E.Class.UNIVERSAL,type:E.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:E.Class.UNIVERSAL,type:E.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:E.Class.UNIVERSAL,type:E.Type.INTEGER,constructed:!1,capture:"iterations"}]};W.encryptPrivateKeyInfo=function(e,t,r){r=r||{},r.saltSize=r.saltSize||8,r.count=r.count||2048,r.algorithm=r.algorithm||"aes128",r.prfAlgorithm=r.prfAlgorithm||"sha1";var n=N.random.getBytesSync(r.saltSize),i=r.count,s=E.integerToDer(i),a,o,f;if(r.algorithm.indexOf("aes")===0||r.algorithm==="des"){var c,u,h;switch(r.algorithm){case"aes128":a=16,c=16,u=Nr["aes128-CBC"],h=N.aes.createEncryptionCipher;break;case"aes192":a=24,c=16,u=Nr["aes192-CBC"],h=N.aes.createEncryptionCipher;break;case"aes256":a=32,c=16,u=Nr["aes256-CBC"],h=N.aes.createEncryptionCipher;break;case"des":a=8,c=8,u=Nr.desCBC,h=N.des.createEncryptionCipher;break;default:var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var d="hmacWith"+r.prfAlgorithm.toUpperCase(),p=kc(d),y=N.pkcs5.pbkdf2(t,n,i,a,p),x=N.random.getBytesSync(c),m=h(y);m.start(x),m.update(E.toDer(e)),m.finish(),f=m.output.getBytes();var b=Uy(n,s,a,d);o=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Nr.pkcs5PBES2).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Nr.pkcs5PBKDF2).getBytes()),b]),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(u).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,x)])])])}else if(r.algorithm==="3des"){a=24;var w=new N.util.ByteBuffer(n),y=W.pbe.generatePkcs12Key(t,w,1,i,a),x=W.pbe.generatePkcs12Key(t,w,2,i,a),m=N.des.createEncryptionCipher(y);m.start(x),m.update(E.toDer(e)),m.finish(),f=m.output.getBytes(),o=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(Nr["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,n),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,s.getBytes())])])}else{var l=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw l.algorithm=r.algorithm,l}var C=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[o,E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,f)]);return C};W.decryptPrivateKeyInfo=function(e,t){var r=null,n={},i=[];if(!E.validate(e,Iy,n,i)){var s=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=E.derToOid(n.encryptionOid),o=W.pbe.getCipher(a,n.encryptionParams,t),f=N.util.createBuffer(n.encryptedData);return o.update(f),o.finish()&&(r=E.fromDer(o.output)),r};W.encryptedPrivateKeyToPem=function(e,t){var r={type:"ENCRYPTED PRIVATE KEY",body:E.toDer(e).getBytes()};return N.pem.encode(r,{maxline:t})};W.encryptedPrivateKeyFromPem=function(e){var t=N.pem.decode(e)[0];if(t.type!=="ENCRYPTED PRIVATE KEY"){var r=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw r.headerType=t.type,r}if(t.procType&&t.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return E.fromDer(t.body)};W.encryptRsaPrivateKey=function(e,t,r){if(r=r||{},!r.legacy){var n=W.wrapRsaPrivateKey(W.privateKeyToAsn1(e));return n=W.encryptPrivateKeyInfo(n,t,r),W.encryptedPrivateKeyToPem(n)}var i,s,a,o;switch(r.algorithm){case"aes128":i="AES-128-CBC",a=16,s=N.random.getBytesSync(16),o=N.aes.createEncryptionCipher;break;case"aes192":i="AES-192-CBC",a=24,s=N.random.getBytesSync(16),o=N.aes.createEncryptionCipher;break;case"aes256":i="AES-256-CBC",a=32,s=N.random.getBytesSync(16),o=N.aes.createEncryptionCipher;break;case"3des":i="DES-EDE3-CBC",a=24,s=N.random.getBytesSync(8),o=N.des.createEncryptionCipher;break;case"des":i="DES-CBC",a=8,s=N.random.getBytesSync(8),o=N.des.createEncryptionCipher;break;default:var f=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+r.algorithm+'".');throw f.algorithm=r.algorithm,f}var c=N.pbe.opensslDeriveBytes(t,s.substr(0,8),a),u=o(c);u.start(s),u.update(E.toDer(W.privateKeyToAsn1(e))),u.finish();var h={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:i,parameters:N.util.bytesToHex(s).toUpperCase()},body:u.output.getBytes()};return N.pem.encode(h)};W.decryptRsaPrivateKey=function(e,t){var r=null,n=N.pem.decode(e)[0];if(n.type!=="ENCRYPTED PRIVATE KEY"&&n.type!=="PRIVATE KEY"&&n.type!=="RSA PRIVATE KEY"){var i=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw i.headerType=i,i}if(n.procType&&n.procType.type==="ENCRYPTED"){var s,a;switch(n.dekInfo.algorithm){case"DES-CBC":s=8,a=N.des.createDecryptionCipher;break;case"DES-EDE3-CBC":s=24,a=N.des.createDecryptionCipher;break;case"AES-128-CBC":s=16,a=N.aes.createDecryptionCipher;break;case"AES-192-CBC":s=24,a=N.aes.createDecryptionCipher;break;case"AES-256-CBC":s=32,a=N.aes.createDecryptionCipher;break;case"RC2-40-CBC":s=5,a=function(h){return N.rc2.createDecryptionCipher(h,40)};break;case"RC2-64-CBC":s=8,a=function(h){return N.rc2.createDecryptionCipher(h,64)};break;case"RC2-128-CBC":s=16,a=function(h){return N.rc2.createDecryptionCipher(h,128)};break;default:var i=new Error('Could not decrypt private key; unsupported encryption algorithm "'+n.dekInfo.algorithm+'".');throw i.algorithm=n.dekInfo.algorithm,i}var o=N.util.hexToBytes(n.dekInfo.parameters),f=N.pbe.opensslDeriveBytes(t,o.substr(0,8),s),c=a(f);if(c.start(o),c.update(N.util.createBuffer(n.body)),c.finish())r=c.output.getBytes();else return r}else r=n.body;return n.type==="ENCRYPTED PRIVATE KEY"?r=W.decryptPrivateKeyInfo(E.fromDer(r),t):r=E.fromDer(r),r!==null&&(r=W.privateKeyFromAsn1(r)),r};W.pbe.generatePkcs12Key=function(e,t,r,n,i,s){var a,o;if(typeof s>"u"||s===null){if(!("sha1"in N.md))throw new Error('"sha1" hash algorithm unavailable.');s=N.md.sha1.create()}var f=s.digestLength,c=s.blockLength,u=new N.util.ByteBuffer,h=new N.util.ByteBuffer;if(e!=null){for(o=0;o<e.length;o++)h.putInt16(e.charCodeAt(o));h.putInt16(0)}var l=h.length(),d=t.length(),p=new N.util.ByteBuffer;p.fillWithByte(r,c);var y=c*Math.ceil(d/c),x=new N.util.ByteBuffer;for(o=0;o<y;o++)x.putByte(t.at(o%d));var m=c*Math.ceil(l/c),b=new N.util.ByteBuffer;for(o=0;o<m;o++)b.putByte(h.at(o%l));var w=x;w.putBuffer(b);for(var C=Math.ceil(i/f),B=1;B<=C;B++){var A=new N.util.ByteBuffer;A.putBytes(p.bytes()),A.putBytes(w.bytes());for(var L=0;L<n;L++)s.start(),s.update(A.getBytes()),A=s.digest();var R=new N.util.ByteBuffer;for(o=0;o<c;o++)R.putByte(A.at(o%f));var D=Math.ceil(d/c)+Math.ceil(l/c),O=new N.util.ByteBuffer;for(a=0;a<D;a++){var G=new N.util.ByteBuffer(w.getBytes(c)),z=511;for(o=R.length()-1;o>=0;o--)z=z>>8,z+=R.at(o)+G.at(o),G.setAt(o,z&255);O.putBuffer(G)}w=O,u.putBuffer(A)}return u.truncate(u.length()-i),u};W.pbe.getCipher=function(e,t,r){switch(e){case W.oids.pkcs5PBES2:return W.pbe.getCipherForPBES2(e,t,r);case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case W.oids["pbewithSHAAnd40BitRC2-CBC"]:return W.pbe.getCipherForPKCS12PBE(e,t,r);default:var n=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw n.oid=e,n.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],n}};W.pbe.getCipherForPBES2=function(e,t,r){var n={},i=[];if(!E.validate(t,Ly,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}if(e=E.derToOid(n.kdfOid),e!==W.oids.pkcs5PBKDF2){var s=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw s.oid=e,s.supportedOids=["pkcs5PBKDF2"],s}if(e=E.derToOid(n.encOid),e!==W.oids["aes128-CBC"]&&e!==W.oids["aes192-CBC"]&&e!==W.oids["aes256-CBC"]&&e!==W.oids["des-EDE3-CBC"]&&e!==W.oids.desCBC){var s=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw s.oid=e,s.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],s}var a=n.kdfSalt,o=N.util.createBuffer(n.kdfIterationCount);o=o.getInt(o.length()<<3);var f,c;switch(W.oids[e]){case"aes128-CBC":f=16,c=N.aes.createDecryptionCipher;break;case"aes192-CBC":f=24,c=N.aes.createDecryptionCipher;break;case"aes256-CBC":f=32,c=N.aes.createDecryptionCipher;break;case"des-EDE3-CBC":f=24,c=N.des.createDecryptionCipher;break;case"desCBC":f=8,c=N.des.createDecryptionCipher;break}var u=Pc(n.prfOid),h=N.pkcs5.pbkdf2(r,a,o,f,u),l=n.encIv,d=c(h);return d.start(l),d};W.pbe.getCipherForPKCS12PBE=function(e,t,r){var n={},i=[];if(!E.validate(t,Ry,n,i)){var s=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw s.errors=i,s}var a=N.util.createBuffer(n.salt),o=N.util.createBuffer(n.iterations);o=o.getInt(o.length()<<3);var f,c,u;switch(e){case W.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:f=24,c=8,u=N.des.startDecrypting;break;case W.oids["pbewithSHAAnd40BitRC2-CBC"]:f=5,c=8,u=function(y,x){var m=N.rc2.createDecryptionCipher(y,40);return m.start(x,null),m};break;default:var s=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw s.oid=e,s}var h=Pc(n.prfOid),l=W.pbe.generatePkcs12Key(r,a,1,o,f,h);h.start();var d=W.pbe.generatePkcs12Key(r,a,2,o,c,h);return u(l,d)};W.pbe.opensslDeriveBytes=function(e,t,r,n){if(typeof n>"u"||n===null){if(!("md5"in N.md))throw new Error('"md5" hash algorithm unavailable.');n=N.md.md5.create()}t===null&&(t="");for(var i=[Nc(n,e+t)],s=16,a=1;s<r;++a,s+=16)i.push(Nc(n,i[a-1]+e+t));return i.join("").substr(0,r)};function Nc(e,t){return e.start().update(t).digest().getBytes()}function Pc(e){var t;if(!e)t="hmacWithSHA1";else if(t=W.oids[E.derToOid(e)],!t){var r=new Error("Unsupported PRF OID.");throw r.oid=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}return kc(t)}function kc(e){var t=N.md;switch(e){case"hmacWithSHA224":t=N.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":e=e.substr(8).toLowerCase();break;default:var r=new Error("Unsupported PRF algorithm.");throw r.algorithm=e,r.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],r}if(!t||!(e in t))throw new Error("Unknown hash algorithm: "+e);return t[e].create()}function Uy(e,t,r,n){var i=E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OCTETSTRING,!1,e),E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,t.getBytes())]);return n!=="hmacWithSHA1"&&i.value.push(E.create(E.Class.UNIVERSAL,E.Type.INTEGER,!1,N.util.hexToBytes(r.toString(16))),E.create(E.Class.UNIVERSAL,E.Type.SEQUENCE,!0,[E.create(E.Class.UNIVERSAL,E.Type.OID,!1,E.oidToDer(W.oids[n]).getBytes()),E.create(E.Class.UNIVERSAL,E.Type.NULL,!1,"")])),i}});var hu=k((Zv,uu)=>{var bt=dt();Lr();Ut();var qn=uu.exports=bt.sha512=bt.sha512||{};bt.md.sha512=bt.md.algorithms.sha512=qn;var fu=bt.sha384=bt.sha512.sha384=bt.sha512.sha384||{};fu.create=function(){return qn.create("SHA-384")};bt.md.sha384=bt.md.algorithms.sha384=fu;bt.sha512.sha256=bt.sha512.sha256||{create:function(){return qn.create("SHA-512/256")}};bt.md["sha512/256"]=bt.md.algorithms["sha512/256"]=bt.sha512.sha256;bt.sha512.sha224=bt.sha512.sha224||{create:function(){return qn.create("SHA-512/224")}};bt.md["sha512/224"]=bt.md.algorithms["sha512/224"]=bt.sha512.sha224;qn.create=function(e){if(cu||H1(),typeof e>"u"&&(e="SHA-512"),!(e in Pr))throw new Error("Invalid SHA-512 algorithm: "+e);for(var t=Pr[e],r=null,n=bt.util.createBuffer(),i=new Array(80),s=0;s<80;++s)i[s]=new Array(2);var a=64;switch(e){case"SHA-384":a=48;break;case"SHA-512/256":a=32;break;case"SHA-512/224":a=28;break}var o={algorithm:e.replace("-","").toLowerCase(),blockLength:128,digestLength:a,messageLength:0,fullMessageLength:null,messageLengthSize:16};return o.start=function(){o.messageLength=0,o.fullMessageLength=o.messageLength128=[];for(var f=o.messageLengthSize/4,c=0;c<f;++c)o.fullMessageLength.push(0);n=bt.util.createBuffer(),r=new Array(t.length);for(var c=0;c<t.length;++c)r[c]=t[c].slice(0);return o},o.start(),o.update=function(f,c){c==="utf8"&&(f=bt.util.encodeUtf8(f));var u=f.length;o.messageLength+=u,u=[u/4294967296>>>0,u>>>0];for(var h=o.fullMessageLength.length-1;h>=0;--h)o.fullMessageLength[h]+=u[1],u[1]=u[0]+(o.fullMessageLength[h]/4294967296>>>0),o.fullMessageLength[h]=o.fullMessageLength[h]>>>0,u[0]=u[1]/4294967296>>>0;return n.putBytes(f),ou(r,i,n),(n.read>2048||n.length()===0)&&n.compact(),o},o.digest=function(){var f=bt.util.createBuffer();f.putBytes(n.bytes());var c=o.fullMessageLength[o.fullMessageLength.length-1]+o.messageLengthSize,u=c&o.blockLength-1;f.putBytes(Za.substr(0,o.blockLength-u));for(var h,l,d=o.fullMessageLength[0]*8,p=0;p<o.fullMessageLength.length-1;++p)h=o.fullMessageLength[p+1]*8,l=h/4294967296>>>0,d+=l,f.putInt32(d>>>0),d=h>>>0;f.putInt32(d);for(var y=new Array(r.length),p=0;p<r.length;++p)y[p]=r[p].slice(0);ou(y,i,f);var x=bt.util.createBuffer(),m;e==="SHA-512"?m=y.length:e==="SHA-384"?m=y.length-2:m=y.length-4;for(var p=0;p<m;++p)x.putInt32(y[p][0]),(p!==m-1||e!=="SHA-512/224")&&x.putInt32(y[p][1]);return x},o};var Za=null,cu=!1,Qa=null,Pr=null;function H1(){Za=String.fromCharCode(128),Za+=bt.util.fillString(String.fromCharCode(0),128),Qa=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],Pr={},Pr["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],Pr["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],Pr["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],Pr["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],cu=!0}function ou(e,t,r){for(var n,i,s,a,o,f,c,u,h,l,d,p,y,x,m,b,w,C,B,A,L,R,D,O,G,z,rt,pt,F,V,S,H,xt,X,Z,Q=r.length();Q>=128;){for(F=0;F<16;++F)t[F][0]=r.getInt32()>>>0,t[F][1]=r.getInt32()>>>0;for(;F<80;++F)H=t[F-2],V=H[0],S=H[1],n=((V>>>19|S<<13)^(S>>>29|V<<3)^V>>>6)>>>0,i=((V<<13|S>>>19)^(S<<3|V>>>29)^(V<<26|S>>>6))>>>0,X=t[F-15],V=X[0],S=X[1],s=((V>>>1|S<<31)^(V>>>8|S<<24)^V>>>7)>>>0,a=((V<<31|S>>>1)^(V<<24|S>>>8)^(V<<25|S>>>7))>>>0,xt=t[F-7],Z=t[F-16],S=i+xt[1]+a+Z[1],t[F][0]=n+xt[0]+s+Z[0]+(S/4294967296>>>0)>>>0,t[F][1]=S>>>0;for(y=e[0][0],x=e[0][1],m=e[1][0],b=e[1][1],w=e[2][0],C=e[2][1],B=e[3][0],A=e[3][1],L=e[4][0],R=e[4][1],D=e[5][0],O=e[5][1],G=e[6][0],z=e[6][1],rt=e[7][0],pt=e[7][1],F=0;F<80;++F)c=((L>>>14|R<<18)^(L>>>18|R<<14)^(R>>>9|L<<23))>>>0,u=((L<<18|R>>>14)^(L<<14|R>>>18)^(R<<23|L>>>9))>>>0,h=(G^L&(D^G))>>>0,l=(z^R&(O^z))>>>0,o=((y>>>28|x<<4)^(x>>>2|y<<30)^(x>>>7|y<<25))>>>0,f=((y<<4|x>>>28)^(x<<30|y>>>2)^(x<<25|y>>>7))>>>0,d=(y&m|w&(y^m))>>>0,p=(x&b|C&(x^b))>>>0,S=pt+u+l+Qa[F][1]+t[F][1],n=rt+c+h+Qa[F][0]+t[F][0]+(S/4294967296>>>0)>>>0,i=S>>>0,S=f+p,s=o+d+(S/4294967296>>>0)>>>0,a=S>>>0,rt=G,pt=z,G=D,z=O,D=L,O=R,S=A+i,L=B+n+(S/4294967296>>>0)>>>0,R=S>>>0,B=w,A=C,w=m,C=b,m=y,b=x,S=i+a,y=n+s+(S/4294967296>>>0)>>>0,x=S>>>0;S=e[0][1]+x,e[0][0]=e[0][0]+y+(S/4294967296>>>0)>>>0,e[0][1]=S>>>0,S=e[1][1]+b,e[1][0]=e[1][0]+m+(S/4294967296>>>0)>>>0,e[1][1]=S>>>0,S=e[2][1]+C,e[2][0]=e[2][0]+w+(S/4294967296>>>0)>>>0,e[2][1]=S>>>0,S=e[3][1]+A,e[3][0]=e[3][0]+B+(S/4294967296>>>0)>>>0,e[3][1]=S>>>0,S=e[4][1]+R,e[4][0]=e[4][0]+L+(S/4294967296>>>0)>>>0,e[4][1]=S>>>0,S=e[5][1]+O,e[5][0]=e[5][0]+D+(S/4294967296>>>0)>>>0,e[5][1]=S>>>0,S=e[6][1]+z,e[6][0]=e[6][0]+G+(S/4294967296>>>0)>>>0,e[6][1]=S>>>0,S=e[7][1]+pt,e[7][0]=e[7][0]+rt+(S/4294967296>>>0)>>>0,e[7][1]=S>>>0,Q-=128}}});var lh=k((Aw,hh)=>{var vn=1e3,bn=vn*60,wn=bn*60,Or=wn*24,G2=Or*7,W2=Or*365.25;hh.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0)return Y2(e);if(r==="number"&&isFinite(e))return t.long?X2(e):$2(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function Y2(e){if(e=String(e),!(e.length>100)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var r=parseFloat(t[1]),n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*W2;case"weeks":case"week":case"w":return r*G2;case"days":case"day":case"d":return r*Or;case"hours":case"hour":case"hrs":case"hr":case"h":return r*wn;case"minutes":case"minute":case"mins":case"min":case"m":return r*bn;case"seconds":case"second":case"secs":case"sec":case"s":return r*vn;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function $2(e){var t=Math.abs(e);return t>=Or?Math.round(e/Or)+"d":t>=wn?Math.round(e/wn)+"h":t>=bn?Math.round(e/bn)+"m":t>=vn?Math.round(e/vn)+"s":e+"ms"}function X2(e){var t=Math.abs(e);return t>=Or?hs(e,t,Or,"day"):t>=wn?hs(e,t,wn,"hour"):t>=bn?hs(e,t,bn,"minute"):t>=vn?hs(e,t,vn,"second"):e+" ms"}function hs(e,t,r,n){var i=t>=r*1.5;return Math.round(e/r)+" "+n+(i?"s":"")}});var dh=k((_w,ph)=>{function Z2(e){r.debug=r,r.default=r,r.coerce=f,r.disable=s,r.enable=i,r.enabled=a,r.humanize=lh(),r.destroy=c,Object.keys(e).forEach(u=>{r[u]=e[u]}),r.names=[],r.skips=[],r.formatters={};function t(u){let h=0;for(let l=0;l<u.length;l++)h=(h<<5)-h+u.charCodeAt(l),h|=0;return r.colors[Math.abs(h)%r.colors.length]}r.selectColor=t;function r(u){let h,l=null,d,p;function y(...x){if(!y.enabled)return;let m=y,b=Number(new Date),w=b-(h||b);m.diff=w,m.prev=h,m.curr=b,h=b,x[0]=r.coerce(x[0]),typeof x[0]!="string"&&x.unshift("%O");let C=0;x[0]=x[0].replace(/%([a-zA-Z%])/g,(A,L)=>{if(A==="%%")return"%";C++;let R=r.formatters[L];if(typeof R=="function"){let D=x[C];A=R.call(m,D),x.splice(C,1),C--}return A}),r.formatArgs.call(m,x),(m.log||r.log).apply(m,x)}return y.namespace=u,y.useColors=r.useColors(),y.color=r.selectColor(u),y.extend=n,y.destroy=r.destroy,Object.defineProperty(y,"enabled",{enumerable:!0,configurable:!1,get:()=>l!==null?l:(d!==r.namespaces&&(d=r.namespaces,p=r.enabled(u)),p),set:x=>{l=x}}),typeof r.init=="function"&&r.init(y),y}function n(u,h){let l=r(this.namespace+(typeof h>"u"?":":h)+u);return l.log=this.log,l}function i(u){r.save(u),r.namespaces=u,r.names=[],r.skips=[];let h,l=(typeof u=="string"?u:"").split(/[\s,]+/),d=l.length;for(h=0;h<d;h++)l[h]&&(u=l[h].replace(/\*/g,".*?"),u[0]==="-"?r.skips.push(new RegExp("^"+u.slice(1)+"$")):r.names.push(new RegExp("^"+u+"$")))}function s(){let u=[...r.names.map(o),...r.skips.map(o).map(h=>"-"+h)].join(",");return r.enable(""),u}function a(u){if(u[u.length-1]==="*")return!0;let h,l;for(h=0,l=r.skips.length;h<l;h++)if(r.skips[h].test(u))return!1;for(h=0,l=r.names.length;h<l;h++)if(r.names[h].test(u))return!0;return!1}function o(u){return u.toString().substring(2,u.toString().length-2).replace(/\.\*\?$/,"*")}function f(u){return u instanceof Error?u.stack||u.message:u}function c(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")}return r.enable(r.load()),r}ph.exports=Z2});var yh=k((he,ls)=>{he.formatArgs=J2;he.save=j2;he.load=tg;he.useColors=Q2;he.storage=eg();he.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})();he.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function Q2(){return typeof window<"u"&&window.process&&(window.process.type==="renderer"||window.process.__nwjs)?!0:typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)?!1:typeof document<"u"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window<"u"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}function J2(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+ls.exports.humanize(this.diff),!this.useColors)return;let t="color: "+this.color;e.splice(1,0,t,"color: inherit");let r=0,n=0;e[0].replace(/%[a-zA-Z%]/g,i=>{i!=="%%"&&(r++,i==="%c"&&(n=r))}),e.splice(n,0,t)}he.log=console.debug||console.log||(()=>{});function j2(e){try{e?he.storage.setItem("debug",e):he.storage.removeItem("debug")}catch{}}function tg(){let e;try{e=he.storage.getItem("debug")}catch{}return!e&&typeof process<"u"&&"env"in process&&(e=process.env.DEBUG),e}function eg(){try{return localStorage}catch{}}ls.exports=dh()(he);var{formatters:rg}=ls.exports;rg.j=function(e){try{return JSON.stringify(e)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}});var ag={};Ht(ag,{noise:()=>sg,stablelib:()=>Os});function je(e){return globalThis.Buffer!=null?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function Ve(e=0){return globalThis.Buffer?.alloc!=null?je(globalThis.Buffer.alloc(e)):new Uint8Array(e)}function Ae(e=0){return globalThis.Buffer?.allocUnsafe!=null?je(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function Nt(e,t){t==null&&(t=e.reduce((i,s)=>i+s.length,0));let r=Ae(t),n=0;for(let i of e)r.set(i,n),n+=i.length;return je(r)}function Pt(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}var Lo=Symbol.for("@achingbrain/uint8arraylist");function Io(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let i=r+n.byteLength;if(t<i)return{buf:n,index:t-r};r=i}throw new RangeError("index is out of bounds")}function oi(e){return!!e?.[Lo]}var ne=class{constructor(...t){Object.defineProperty(this,Lo,{value:!0}),this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(oi(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(oi(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=Io(this.bufs,t);return r.buf[r.index]}set(t,r){let n=Io(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(oi(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:i}=this._subList(t,r);return Nt(n,i)}subarray(t,r){let{bufs:n,length:i}=this._subList(t,r);return n.length===1?n[0]:Nt(n,i)}sublist(t,r){let{bufs:n,length:i}=this._subList(t,r),s=new ne;return s.length=i,s.bufs=n,s}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:[...this.bufs],length:this.length};let n=[],i=0;for(let s=0;s<this.bufs.length;s++){let a=this.bufs[s],o=i,f=o+a.byteLength;if(i=f,t>=f)continue;let c=t>=o&&t<f,u=r>o&&r<=f;if(c&&u){if(t===o&&r===f){n.push(a);break}let h=t-o;n.push(a.subarray(h,h+(r-t)));break}if(c){if(t===0){n.push(a);continue}n.push(a.subarray(t-o));continue}if(u){if(r===f){n.push(a);break}n.push(a.subarray(0,r-o));break}n.push(a)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!oi(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let s=256,a=new Int32Array(s);for(let h=0;h<s;h++)a[h]=-1;for(let h=0;h<i;h++)a[n[h]]=h;let o=a,f=this.byteLength-n.byteLength,c=n.byteLength-1,u;for(let h=r;h<=f;h+=u){u=0;for(let l=c;l>=0;l--){let d=this.get(h+l);if(n[l]!==d){u=Math.max(1,l-o[d]);break}}if(u===0)return h}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=Ae(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let i=Ve(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let i=Ve(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let i=Ve(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=Ae(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let i=Ve(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let i=Ve(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let i=Ve(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let i=Ve(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let i=Ve(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,t)}equals(t){if(t==null||!(t instanceof ne)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!Pt(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new ne;return n.bufs=t,r==null&&(r=t.reduce((i,s)=>i+s.byteLength,0)),n.length=r,n}};function Ro(e){let t=async function*(){let r=yield,n=new ne;for await(let i of e){if(r==null){n.append(i),r=yield n,n=new ne;continue}for(n.append(i);n.length>=r;){let s=n.sublist(0,r);if(n.consume(r),r=yield s,r==null){n.length>0&&(r=yield n,n=new ne);break}}}if(r!=null)throw Object.assign(new Error(`stream ended before ${r} bytes became available`),{code:"ERR_UNDER_READ",buffer:n})}();return t.next(),t}var fi=class{constructor(t){if(!(t>0)||t-1&t)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(t),this.mask=t-1,this.top=0,this.btm=0,this.next=null}push(t){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=t,this.top=this.top+1&this.mask,!0)}shift(){let t=this.buffer[this.btm];if(t!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,t}isEmpty(){return this.buffer[this.btm]===void 0}},Hr=class{constructor(t={}){this.hwm=t.splitLimit??16,this.head=new fi(this.hwm),this.tail=this.head,this.size=0}calculateSize(t){return t?.byteLength!=null?t.byteLength:1}push(t){if(t?.value!=null&&(this.size+=this.calculateSize(t.value)),!this.head.push(t)){let r=this.head;this.head=r.next=new fi(2*this.head.buffer.length),this.head.push(t)}}shift(){let t=this.tail.shift();if(t===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,t=this.tail.shift()}return t?.value!=null&&(this.size-=this.calculateSize(t.value)),t}isEmpty(){return this.head.isEmpty()}};function Vr(e={}){return Ch(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},e)}function Ch(e,t){t=t??{};let r=t.onEnd,n=new Hr,i,s,a,o=async()=>n.isEmpty()?a?{done:!0}:await new Promise((y,x)=>{s=m=>{s=null,n.push(m);try{y(e(n))}catch(b){x(b)}return i}}):e(n),f=y=>s!=null?s(y):(n.push(y),i),c=y=>(n=new Hr,s!=null?s({error:y}):(n.push({error:y}),i)),u=y=>{if(a)return i;if(t?.objectMode!==!0&&y?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return f({done:!1,value:y})},h=y=>a?i:(a=!0,y!=null?c(y):f({done:!0})),l=()=>(n=new Hr,h(),{done:!0}),d=y=>(h(y),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:o,return:l,throw:d,push:u,end:h,get readableLength(){return n.size}},r==null)return i;let p=i;return i={[Symbol.asyncIterator](){return this},next(){return p.next()},throw(y){return p.throw(y),r!=null&&(r(y),r=void 0),{done:!0}},return(){return p.return(),r!=null&&(r(),r=void 0),{done:!0}},push:u,end(y){return p.end(y),r!=null&&(r(y),r=void 0),i},get readableLength(){return p.readableLength}},i}function En(){let e={};return e.promise=new Promise((t,r)=>{e.resolve=t,e.reject=r}),e}function Uo(e){let t=Vr(),r=Ro(e.source),n=En(),i,s=e.sink(async function*(){yield*t,yield*await n.promise}());return s.catch(o=>{i=o}),{reader:r,writer:t,stream:{sink:async o=>i!=null?await Promise.reject(i):(n.resolve(o),await s),source:r},rest:()=>t.end(),write:t.push,read:async()=>{let o=await r.next();if(o.value!=null)return o.value}}}function ci(e){return e instanceof Uint8Array?{get(t){return e[t]},set(t,r){e[t]=r}}:{get(t){return e.get(t)},set(t,r){e.set(t,r)}}}var No=4294967296,oe=class{constructor(t=0,r=0){this.hi=t,this.lo=r}toBigInt(t){if(t===!0)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toNumber(t){return Number(this.toBigInt(t))}zzDecode(){let t=-(this.lo&1),r=((this.lo>>>1|this.hi<<31)^t)>>>0,n=(this.hi>>>1^t)>>>0;return new oe(n,r)}zzEncode(){let t=this.hi>>31,r=((this.hi<<1|this.lo>>>31)^t)>>>0,n=(this.lo<<1^t)>>>0;return new oe(r,n)}toBytes(t,r=0){let n=ci(t);for(;this.hi>0;)n.set(r++,this.lo&127|128),this.lo=(this.lo>>>7|this.hi<<25)>>>0,this.hi>>>=7;for(;this.lo>127;)n.set(r++,this.lo&127|128),this.lo=this.lo>>>7;n.set(r++,this.lo)}static fromBigInt(t){if(t===0n)return new oe;let r=t<0;r&&(t=-t);let n=Number(t>>32n)|0,i=Number(t-(BigInt(n)<<32n))|0;return r&&(n=~n>>>0,i=~i>>>0,++i>No&&(i=0,++n>No&&(n=0))),new oe(n,i)}static fromNumber(t){if(t===0)return new oe;let r=t<0;r&&(t=-t);let n=t>>>0,i=(t-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new oe(i,n)}static fromBytes(t,r=0){let n=ci(t),i=new oe,s=0;if(t.length-r>4){for(;s<4;++s)if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i;if(i.lo=(i.lo|(n.get(r)&127)<<28)>>>0,i.hi=(i.hi|(n.get(r)&127)>>4)>>>0,n.get(r++)<128)return i;s=0}else for(;s<4;++s){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.lo=(i.lo|(n.get(r)&127)<<s*7)>>>0,n.get(r++)<128)return i}if(t.length-r>4){for(;s<5;++s)if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}else if(r<t.byteLength)for(;s<5;++s){if(r>=t.length)throw RangeError(`index out of range: ${r} > ${t.length}`);if(i.hi=(i.hi|(n.get(r)&127)<<s*7+3)>>>0,n.get(r++)<128)return i}throw RangeError("invalid varint encoding")}};var Th=Math.pow(2,7),Ih=Math.pow(2,14),Lh=Math.pow(2,21),Rh=Math.pow(2,28),Uh=Math.pow(2,35),Nh=Math.pow(2,42),Ph=Math.pow(2,49),kh=Math.pow(2,56),Dh=Math.pow(2,63),mr={encodingLength(e){return e<Th?1:e<Ih?2:e<Lh?3:e<Rh?4:e<Uh?5:e<Nh?6:e<Ph?7:e<kh?8:e<Dh?9:10},encode(e,t,r=0){if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return t==null&&(t=Ae(mr.encodingLength(e))),oe.fromNumber(e).toBytes(t,r),t},decode(e,t=0){return oe.fromBytes(e,t).toNumber(!0)}};function Po(e){return globalThis?.Buffer?.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}var ui=e=>{let t=mr.encodingLength(e),r=Po(t);return mr.encode(e,r),ui.bytes=t,r};ui.bytes=0;function hi(e){e=e??{};let t=e.lengthEncoder??ui;return async function*(n){for await(let i of n){let s=t(i.byteLength);s instanceof Uint8Array?yield s:yield*s,i instanceof Uint8Array?yield i:yield*i}}}hi.single=(e,t)=>{t=t??{};let r=t.lengthEncoder??ui;return new ne(r(e.byteLength),e)};var Sn=gt(Ko(),1),Mh=8,Fh=1024*1024*4,vr;(function(e){e[e.LENGTH=0]="LENGTH",e[e.DATA=1]="DATA"})(vr||(vr={}));var ms=e=>{let t=mr.decode(e);return ms.bytes=mr.encodingLength(t),t};ms.bytes=0;function br(e){return async function*(r){let n=new ne,i=vr.LENGTH,s=-1,a=e?.lengthDecoder??ms,o=e?.maxLengthLength??Mh,f=e?.maxDataLength??Fh;for await(let c of r)for(n.append(c);n.byteLength>0;){if(i===vr.LENGTH)try{if(s=a(n),s<0)throw(0,Sn.default)(new Error("invalid message length"),"ERR_INVALID_MSG_LENGTH");if(s>f)throw(0,Sn.default)(new Error("message length too long"),"ERR_MSG_DATA_TOO_LONG");let u=a.bytes;n.consume(u),e?.onLength!=null&&e.onLength(s),i=vr.DATA}catch(u){if(u instanceof RangeError){if(n.byteLength>o)throw(0,Sn.default)(new Error("message length length too long"),"ERR_MSG_LENGTH_TOO_LONG");break}throw u}if(i===vr.DATA){if(n.byteLength<s)break;let u=n.sublist(0,s);n.consume(s),e?.onData!=null&&e.onData(u),yield u,i=vr.LENGTH}}if(n.byteLength>0)throw(0,Sn.default)(new Error("unexpected end of input"),"ERR_UNEXPECTED_EOF")}}br.fromReader=(e,t)=>{let r=1,n=async function*(){for(;;)try{let{done:s,value:a}=await e.next(r);if(s===!0)return;a!=null&&(yield a)}catch(s){if(s.code==="ERR_UNDER_READ")return{done:!0,value:null};throw s}finally{r=1}}();return br({...t??{},onLength:s=>{r=s}})(n)};function vs(e,t={}){let r=Uo(e),n=br.fromReader(r.reader,t),i={read:async s=>{let{value:a}=await r.reader.next(s);if(a==null)throw new Error("Value is null");return a},readLP:async()=>{let{value:s}=await n.next();if(s==null)throw new Error("Value is null");return s},readPB:async s=>{let a=await i.readLP();if(a==null)throw new Error("Value is null");let o=a instanceof Uint8Array?a:a.subarray();return s.decode(o)},write:s=>{s instanceof Uint8Array?r.writer.push(s):r.writer.push(s.subarray())},writeLP:s=>{i.write(hi.single(s,t))},writePB:(s,a)=>{i.writeLP(a.encode(s))},pb:s=>({read:async()=>await i.readPB(s),write:a=>{i.writePB(a,s)},unwrap:()=>i}),unwrap:()=>(r.rest(),e.source=r.stream.source,e.sink=r.stream.sink,e)};return i}function bs(){let e=En(),t=!1;return{sink:async r=>{if(t)throw new Error("already piped");t=!0,e.resolve(r)},source:async function*(){yield*await e.promise}()}}function Mo(){let e=bs(),t=bs();return[{source:e.source,sink:t.sink},{source:t.source,sink:e.sink}]}async function*ws(...e){let t=Vr({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(e.map(async r=>{for await(let n of r)t.push(n)})),t.end()}catch(r){t.end(r)}}),yield*t}var Hh=(...e)=>{let t;for(;e.length>0;)t=e.shift()(t);return t},Fo=e=>e!=null&&(typeof e[Symbol.asyncIterator]=="function"||typeof e[Symbol.iterator]=="function"||typeof e.next=="function"),Es=e=>e!=null&&typeof e.sink=="function"&&Fo(e.source),Vh=e=>t=>{let r=e.sink(t);if(r.then!=null){let n=Vr({objectMode:!0});return r.then(()=>{n.end()},s=>{n.end(s)}),ws(n,async function*(){yield*e.source,n.end()}())}return e.source};function Oo(e,...t){if(Es(e)){let n=e;e=()=>n.source}else if(Fo(e)){let n=e;e=()=>n}let r=[e,...t];if(r.length>1&&Es(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)Es(r[n])&&(r[n]=Vh(r[n]));return Hh(...r)}var Ho=!!globalThis.process?.env?.DUMP_SESSION_KEYS;var w0=gt($o(),1),zr=gt(l0(),1),Ai=gt(d0(),1),Fs=gt(Ms(),1),Os={hashSHA256(e){return(0,Ai.hash)(e)},getHKDF(e,t){let i=new w0.HKDF(Ai.SHA256,t,e).expand(96),s=i.subarray(0,32),a=i.subarray(32,64),o=i.subarray(64,96);return[s,a,o]},generateX25519KeyPair(){let e=zr.generateKeyPair();return{publicKey:e.publicKey,privateKey:e.secretKey}},generateX25519KeyPairFromSeed(e){let t=zr.generateKeyPairFromSeed(e);return{publicKey:t.publicKey,privateKey:t.secretKey}},generateX25519SharedKey(e,t){return zr.sharedKey(e,t)},chaCha20Poly1305Encrypt(e,t,r,n){return new Fs.ChaCha20Poly1305(n).seal(t,e,r)},chaCha20Poly1305Decrypt(e,t,r,n,i){return new Fs.ChaCha20Poly1305(n).open(t,e,r,i)}};var Hs=gt(Ms(),1);var Ql=e=>globalThis.Buffer?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e),Gr=e=>{let t=Ql(2);return new DataView(t.buffer,t.byteOffset,t.byteLength).setUint16(0,e,!1),t};Gr.bytes=2;var In=e=>{if(e.length<2)throw RangeError("Could not decode int16BE");return e instanceof Uint8Array?new DataView(e.buffer,e.byteOffset,e.byteLength).getUint16(0,!1):e.getUint16(0)};In.bytes=2;function E0(e){return Nt([e.ne,e.ciphertext],e.ne.length+e.ciphertext.length)}function S0(e){return Nt([e.ne,e.ns,e.ciphertext],e.ne.length+e.ns.length+e.ciphertext.length)}function B0(e){return Nt([e.ns,e.ciphertext],e.ns.length+e.ciphertext.length)}function A0(e){if(e.length<32)throw new Error("Cannot decode stage 0 MessageBuffer: length less than 32 bytes.");return{ne:e.subarray(0,32),ciphertext:e.subarray(32,e.length),ns:new Uint8Array(0)}}function _0(e){if(e.length<80)throw new Error("Cannot decode stage 1 MessageBuffer: length less than 80 bytes.");return{ne:e.subarray(0,32),ns:e.subarray(32,80),ciphertext:e.subarray(80,e.length)}}function C0(e){if(e.length<48)throw new Error("Cannot decode stage 2 MessageBuffer: length less than 48 bytes.");return{ne:new Uint8Array(0),ns:e.subarray(0,48),ciphertext:e.subarray(48,e.length)}}function I0(e,t){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65519){let s=i+65519;s>n.length&&(s=n.length);let a=e.encrypt(n.subarray(i,s),e.session);t?.encryptedPackets.increment(),yield Gr(a.byteLength),yield a}}}function L0(e,t){return async function*(r){for await(let n of r)for(let i=0;i<n.length;i+=65535){let s=i+65535;if(s>n.length&&(s=n.length),s-Hs.TAG_LENGTH<i)throw new Error("Invalid chunk");let a=n.subarray(i,s),o=n.subarray(i,s-Hs.TAG_LENGTH),{plaintext:f,valid:c}=e.decrypt(a,e.session,o);if(!c)throw t?.decryptErrors.increment(),new Error("Failed to validate decrypted chunk");t?.decryptedPackets.increment(),yield f}}}var Er=class extends Error{constructor(t="Unexpected Peer"){super(t),this.code=Er.code}static get code(){return"ERR_UNEXPECTED_PEER"}},We=class extends Error{constructor(t="Invalid crypto exchange"){super(t),this.code=We.code}static get code(){return"ERR_INVALID_CRYPTO_EXCHANGE"}};var ta=gt(Ws(),1),mf=gt(uf(),1),vf=gt(Br(),1),ea=gt(js(),1),bf=gt(xf(),1);function ap(){vf.default._configure(),ta.default._configure(mf.default),ea.default._configure(bf.default)}ap();var wf=["uint64","int64","sint64","fixed64","sfixed64"];function op(e){for(let t of wf){if(e[t]==null)continue;let r=e[t];e[t]=function(){return BigInt(r.call(this).toString())}}return e}function ra(e){return op(new ta.default(e))}function fp(e){for(let t of wf){if(e[t]==null)continue;let r=e[t];e[t]=function(n){return r.call(this,n.toString())}}return e}function na(){return fp(ea.default.create())}function _r(e,t){let r=ra(e instanceof Uint8Array?e:e.subarray());return t.decode(r)}function Cr(e,t){let r=na();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var Yr;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(Yr||(Yr={}));function Li(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function ia(e){function t(i){if(e[i.toString()]==null)throw new Error("Invalid enum value");return e[i]}let r=function(s,a){let o=t(s);a.int32(o)},n=function(s){let a=s.int32();return t(a)};return Li("enum",Yr.VARINT,r,n)}function Tr(e,t){return Li("message",Yr.LENGTH_DELIMITED,e,t)}var St;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.Secp256k1="Secp256k1"})(St||(St={}));var sa;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.Secp256k1=2]="Secp256k1"})(sa||(sa={}));(function(e){e.codec=()=>ia(sa)})(St||(St={}));var Re;(function(e){let t;e.codec=()=>(t==null&&(t=Tr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),St.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.Type=St.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>Cr(r,e.codec()),e.decode=r=>_r(r,e.codec())})(Re||(Re={}));var Ue;(function(e){let t;e.codec=()=>(t==null&&(t=Tr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),St.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.Type=St.codec().decode(r);break;case 2:i.Data=r.bytes();break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>Cr(r,e.codec()),e.decode=r=>_r(r,e.codec())})(Ue||(Ue={}));var Ob=gt(Dn(),1),Hb=gt(Kc(),1),M2=gt(dt(),1);var yt=class extends Error{constructor(t,r,n){super(t),this.code=r,this.name=n?.name??"CodeError",this.props=n??{}}};var Ua={};Ht(Ua,{identity:()=>My});function Ny(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var o=e.length,f=e.charAt(0),c=Math.log(o)/Math.log(256),u=Math.log(256)/Math.log(o);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var y=0,x=0,m=0,b=p.length;m!==b&&p[m]===0;)m++,y++;for(var w=(b-m)*u+1>>>0,C=new Uint8Array(w);m!==b;){for(var B=p[m],A=0,L=w-1;(B!==0||A<x)&&L!==-1;L--,A++)B+=256*C[L]>>>0,C[L]=B%o>>>0,B=B/o>>>0;if(B!==0)throw new Error("Non-zero carry");x=A,m++}for(var R=w-x;R!==w&&C[R]===0;)R++;for(var D=f.repeat(y);R<w;++R)D+=e.charAt(C[R]);return D}function l(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var y=0;if(p[y]!==" "){for(var x=0,m=0;p[y]===f;)x++,y++;for(var b=(p.length-y)*c+1>>>0,w=new Uint8Array(b);p[y];){var C=r[p.charCodeAt(y)];if(C===255)return;for(var B=0,A=b-1;(C!==0||B<m)&&A!==-1;A--,B++)C+=o*w[A]>>>0,w[A]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");m=B,y++}if(p[y]!==" "){for(var L=b-m;L!==b&&w[L]===0;)L++;for(var R=new Uint8Array(x+(b-L)),D=x;L!==b;)R[D++]=w[L++];return R}}}function d(p){var y=l(p);if(y)return y;throw new Error(`Non-${t} character`)}return{encode:h,decodeUnsafe:l,decode:d}}var Py=Ny,ky=Py,Mc=ky;var Lm=new Uint8Array(0);var Fc=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},Ze=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")};var Oc=e=>new TextEncoder().encode(e),Hc=e=>new TextDecoder().decode(e);var Ta=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},Ia=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return qc(this,t)}},La=class{constructor(t){this.decoders=t}or(t){return qc(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},qc=(e,t)=>new La({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}}),Ra=class{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Ta(t,r,n),this.decoder=new Ia(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}},Jr=({name:e,prefix:t,encode:r,decode:n})=>new Ra(e,t,r,n),or=({prefix:e,name:t,alphabet:r})=>{let{encode:n,decode:i}=Mc(r,t);return Jr({prefix:e,name:t,encode:n,decode:s=>Ze(i(s))})},Dy=(e,t,r,n)=>{let i={};for(let u=0;u<t.length;++u)i[t[u]]=u;let s=e.length;for(;e[s-1]==="=";)--s;let a=new Uint8Array(s*r/8|0),o=0,f=0,c=0;for(let u=0;u<s;++u){let h=i[e[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);f=f<<r|h,o+=r,o>=8&&(o-=8,a[c++]=255&f>>o)}if(o>=r||255&f<<8-o)throw new SyntaxError("Unexpected end of data");return a},Ky=(e,t,r)=>{let n=t[t.length-1]==="=",i=(1<<r)-1,s="",a=0,o=0;for(let f=0;f<e.length;++f)for(o=o<<8|e[f],a+=8;a>r;)a-=r,s+=t[i&o>>a];if(a&&(s+=t[i&o<<r-a]),n)for(;s.length*r&7;)s+="=";return s},It=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>Jr({prefix:t,name:e,encode(i){return Ky(i,n,r)},decode(i){return Dy(i,n,r,e)}});var My=Jr({prefix:"\0",name:"identity",encode:e=>Hc(e),decode:e=>Oc(e)});var Na={};Ht(Na,{base2:()=>Fy});var Fy=It({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Pa={};Ht(Pa,{base8:()=>Oy});var Oy=It({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ka={};Ht(ka,{base10:()=>Hy});var Hy=or({prefix:"9",name:"base10",alphabet:"0123456789"});var Da={};Ht(Da,{base16:()=>Vy,base16upper:()=>qy});var Vy=It({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),qy=It({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Ka={};Ht(Ka,{base32:()=>fr,base32hex:()=>Yy,base32hexpad:()=>Xy,base32hexpadupper:()=>Zy,base32hexupper:()=>$y,base32pad:()=>Gy,base32padupper:()=>Wy,base32upper:()=>zy,base32z:()=>Qy});var fr=It({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),zy=It({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Gy=It({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Wy=It({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Yy=It({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),$y=It({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Xy=It({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Zy=It({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Qy=It({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Ma={};Ht(Ma,{base36:()=>Jy,base36upper:()=>jy});var Jy=or({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),jy=or({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Fa={};Ht(Fa,{base58btc:()=>Vt,base58flickr:()=>t1});var Vt=or({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),t1=or({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Oa={};Ht(Oa,{base64:()=>jr,base64pad:()=>e1,base64url:()=>r1,base64urlpad:()=>n1});var jr=It({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),e1=It({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),r1=It({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),n1=It({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Ha={};Ht(Ha,{base256emoji:()=>f1});var zc=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),i1=zc.reduce((e,t,r)=>(e[r]=t,e),[]),s1=zc.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function a1(e){return e.reduce((t,r)=>(t+=i1[r],t),"")}function o1(e){let t=[];for(let r of e){let n=s1[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}var f1=Jr({prefix:"\u{1F680}",name:"base256emoji",encode:a1,decode:o1});var Ga={};Ht(Ga,{sha256:()=>qt,sha512:()=>C1});var c1=Yc,Gc=128,u1=127,h1=~u1,l1=Math.pow(2,31);function Yc(e,t,r){t=t||[],r=r||0;for(var n=r;e>=l1;)t[r++]=e&255|Gc,e/=128;for(;e&h1;)t[r++]=e&255|Gc,e>>>=7;return t[r]=e|0,Yc.bytes=r-n+1,t}var p1=Va,d1=128,Wc=127;function Va(e,n){var r=0,n=n||0,i=0,s=n,a,o=e.length;do{if(s>=o)throw Va.bytes=0,new RangeError("Could not decode varint");a=e[s++],r+=i<28?(a&Wc)<<i:(a&Wc)*Math.pow(2,i),i+=7}while(a>=d1);return Va.bytes=s-n,r}var y1=Math.pow(2,7),g1=Math.pow(2,14),x1=Math.pow(2,21),m1=Math.pow(2,28),v1=Math.pow(2,35),b1=Math.pow(2,42),w1=Math.pow(2,49),E1=Math.pow(2,56),S1=Math.pow(2,63),B1=function(e){return e<y1?1:e<g1?2:e<x1?3:e<m1?4:e<v1?5:e<b1?6:e<w1?7:e<E1?8:e<S1?9:10},A1={encode:c1,decode:p1,encodingLength:B1},_1=A1,Fn=_1;var On=(e,t=0)=>[Fn.decode(e,t),Fn.decode.bytes],tn=(e,t,r=0)=>(Fn.encode(e,t,r),t),en=e=>Fn.encodingLength(e);var Fe=(e,t)=>{let r=t.byteLength,n=en(e),i=n+en(r),s=new Uint8Array(i+r);return tn(e,s,0),tn(r,s,n),s.set(t,i),new rn(e,r,t,s)},Hn=e=>{let t=Ze(e),[r,n]=On(t),[i,s]=On(t.subarray(n)),a=t.subarray(n+s);if(a.byteLength!==i)throw new Error("Incorrect length");return new rn(r,i,a,t)},$c=(e,t)=>{if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&Fc(e.bytes,r.bytes)}},rn=class{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}};var za=({name:e,code:t,encode:r})=>new qa(e,t,r),qa=class{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){let r=this.encode(t);return r instanceof Uint8Array?Fe(this.code,r):r.then(n=>Fe(this.code,n))}else throw Error("Unknown type, must be binary type")}};var Zc=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),qt=za({name:"sha2-256",code:18,encode:Zc("SHA-256")}),C1=za({name:"sha2-512",code:19,encode:Zc("SHA-512")});var Wa={};Ht(Wa,{identity:()=>cr});var Qc=0,T1="identity",Jc=Ze,I1=e=>Fe(Qc,Jc(e)),cr={code:Qc,name:T1,encode:Jc,digest:I1};var Qm=new TextEncoder,Jm=new TextDecoder;var jc=(e,t)=>{let{bytes:r,version:n}=e;switch(n){case 0:return N1(r,Ya(e),t||Vt.encoder);default:return P1(r,Ya(e),t||fr.encoder)}};var tu=new WeakMap,Ya=e=>{let t=tu.get(e);if(t==null){let r=new Map;return tu.set(e,r),r}return t},_t=class{constructor(t,r,n,i){this.code=r,this.version=t,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==Vn)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==k1)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return _t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=Fe(t,r);return _t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return _t.equals(this,t)}static equals(t,r){let n=r;return n&&t.code===n.code&&t.version===n.version&&$c(t.multihash,n.multihash)}toString(t){return jc(this,t)}toJSON(){return{"/":jc(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof _t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:s,bytes:a}=r;return new _t(n,i,s,a||eu(n,i,s.bytes))}else if(r[D1]===!0){let{version:n,multihash:i,code:s}=r,a=Hn(i);return _t.create(n,s,a)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==Vn)throw new Error(`Version 0 CID must use dag-pb (code: ${Vn}) block encoding`);return new _t(t,r,n,n.bytes)}case 1:{let i=eu(t,r,n.bytes);return new _t(t,r,n,i)}default:throw new Error("Invalid version")}}static createV0(t){return _t.create(0,Vn,t)}static createV1(t,r){return _t.create(1,t,r)}static decode(t){let[r,n]=_t.decodeFirst(t);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=_t.inspectBytes(t),n=r.size-r.multihashSize,i=Ze(t.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=i.subarray(r.multihashSize-r.digestSize),a=new rn(r.multihashCode,r.digestSize,s,i);return[r.version===0?_t.createV0(a):_t.createV1(r.codec,a),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[h,l]=On(t.subarray(r));return r+=l,h},i=n(),s=Vn;if(i===18?(i=0,r=0):s=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let a=r,o=n(),f=n(),c=r+f,u=c-a;return{version:i,codec:s,multihashCode:o,digestSize:f,multihashSize:u,size:c}}static parse(t,r){let[n,i]=U1(t,r),s=_t.decode(i);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Ya(s).set(n,t),s}},U1=(e,t)=>{switch(e[0]){case"Q":{let r=t||Vt;return[Vt.prefix,r.decode(`${Vt.prefix}${e}`)]}case Vt.prefix:{let r=t||Vt;return[Vt.prefix,r.decode(e)]}case fr.prefix:{let r=t||fr;return[fr.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}},N1=(e,t,r)=>{let{prefix:n}=r;if(n!==Vt.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=t.get(n);if(i==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return i},P1=(e,t,r)=>{let{prefix:n}=r,i=t.get(n);if(i==null){let s=r.encode(e);return t.set(n,s),s}else return i},Vn=112,k1=18,eu=(e,t,r)=>{let n=en(e),i=n+en(t),s=new Uint8Array(i+r.byteLength);return tn(e,s,0),tn(t,s,n),s.set(r,i),s},D1=Symbol.for("@ipld/js-cid/CID");var sn={...Ua,...Na,...Pa,...ka,...Da,...Ka,...Ma,...Fa,...Oa,...Ha},fv={...Ga,...Wa};function nu(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var ru=nu("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),$a=nu("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=Ae(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),K1={utf8:ru,"utf-8":ru,hex:sn.base16,latin1:$a,ascii:$a,binary:$a,...sn},Zi=K1;function zt(e,t="utf8"){let r=Zi[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?je(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}var se={get(e=globalThis){let t=e.crypto;if(t==null||t.subtle==null)throw Object.assign(new Error("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p-crypto/blob/master/README.md#web-crypto-api"),{code:"ERR_MISSING_WEB_CRYPTO"});return t}};var Tv=gt(Ut(),1),Iv=gt(Gi(),1),iu=gt(dt(),1);function Ct(e,t="utf8"){let r=Zi[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function Ee(e,t){let r=Uint8Array.from(e.abs().toByteArray());if(r=r[0]===0?r.subarray(1):r,t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Nt([new Uint8Array(t-r.length),r])}return Ct(r,"base64url")}function ce(e){let t=su(e);return new iu.default.jsbn.BigInteger(Ct(t,"base16"),16)}function su(e,t){let r=zt(e,"base64urlpad");if(t!=null){if(r.length>t)throw new Error("byte array longer than desired length");r=Nt([new Uint8Array(t-r.length),r])}return r}var F1={"P-256":256,"P-384":384,"P-521":521},O1=Object.keys(F1),Ov=O1.join(" / ");function Xa(e){let t=e?.algorithm??"AES-GCM",r=e?.keyLength??16,n=e?.nonceLength??12,i=e?.digest??"SHA-256",s=e?.saltLength??16,a=e?.iterations??32767,o=se.get();r*=8;async function f(h,l){let d=o.getRandomValues(new Uint8Array(s)),p=o.getRandomValues(new Uint8Array(n)),y={name:t,iv:p};typeof l=="string"&&(l=zt(l));let x={name:"PBKDF2",salt:d,iterations:a,hash:{name:i}},m=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),b=await o.subtle.deriveKey(x,m,{name:t,length:r},!0,["encrypt"]),w=await o.subtle.encrypt(y,b,h);return Nt([d,y.iv,new Uint8Array(w)])}async function c(h,l){let d=h.subarray(0,s),p=h.subarray(s,s+n),y=h.subarray(s+n),x={name:t,iv:p};typeof l=="string"&&(l=zt(l));let m={name:"PBKDF2",salt:d,iterations:a,hash:{name:i}},b=await o.subtle.importKey("raw",l,{name:"PBKDF2"},!1,["deriveKey","deriveBits"]),w=await o.subtle.deriveKey(m,b,{name:t,length:r},!0,["decrypt"]),C=await o.subtle.decrypt(x,w,y);return new Uint8Array(C)}return{encrypt:f,decrypt:c}}var ao={};Ht(ao,{RsaPrivateKey:()=>pn,RsaPublicKey:()=>Xn,fromJwk:()=>h2,generateKeyPair:()=>l2,unmarshalRsaPrivateKey:()=>c2,unmarshalRsaPublicKey:()=>u2});var wb=gt(hu(),1),$n=gt(dt(),1);var V1=gt(wr(),1);var tt=BigInt(0),wt=BigInt(1),hr=BigInt(2),Gn=BigInt(3),lu=BigInt(8),Lt=Object.freeze({a:tt,b:BigInt(7),P:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:wt,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee")}),pu=(e,t)=>(e+t/hr)/t,Qi={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar(e){let{n:t}=Lt,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-wt*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),s=r,a=BigInt("0x100000000000000000000000000000000"),o=pu(s*e,t),f=pu(-n*e,t),c=P(e-o*r-f*i,t),u=P(-o*n-f*s,t),h=c>a,l=u>a;if(h&&(c=t-c),l&&(u=t-u),c>a||u>a)throw new Error("splitScalarEndo: Endomorphism failed, k="+e);return{k1neg:h,k1:c,k2neg:l,k2:u}}},Se=32,fn=32,q1=32,du=Se+1,yu=2*Se+1;function gu(e){let{a:t,b:r}=Lt,n=P(e*e),i=P(n*e);return P(i+t*e+r)}var Ji=Lt.a===tt,es=class extends Error{constructor(t){super(t)}};function xu(e){if(!(e instanceof st))throw new TypeError("JacobianPoint expected")}var st=class{constructor(t,r,n){this.x=t,this.y=r,this.z=n}static fromAffine(t){if(!(t instanceof ht))throw new TypeError("JacobianPoint#fromAffine: expected Point");return t.equals(ht.ZERO)?st.ZERO:new st(t.x,t.y,wt)}static toAffineBatch(t){let r=$1(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return st.toAffineBatch(t).map(st.fromAffine)}equals(t){xu(t);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=t,f=P(i*i),c=P(o*o),u=P(r*c),h=P(s*f),l=P(P(n*o)*c),d=P(P(a*i)*f);return u===h&&l===d}negate(){return new st(this.x,P(-this.y),this.z)}double(){let{x:t,y:r,z:n}=this,i=P(t*t),s=P(r*r),a=P(s*s),o=t+s,f=P(hr*(P(o*o)-i-a)),c=P(Gn*i),u=P(c*c),h=P(u-hr*f),l=P(c*(f-h)-lu*a),d=P(hr*r*n);return new st(h,l,d)}add(t){xu(t);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=t;if(s===tt||a===tt)return this;if(r===tt||n===tt)return t;let f=P(i*i),c=P(o*o),u=P(r*c),h=P(s*f),l=P(P(n*o)*c),d=P(P(a*i)*f),p=P(h-u),y=P(d-l);if(p===tt)return y===tt?this.double():st.ZERO;let x=P(p*p),m=P(p*x),b=P(u*x),w=P(y*y-m-hr*b),C=P(y*(b-w)-l*m),B=P(i*o*p);return new st(w,C,B)}subtract(t){return this.add(t.negate())}multiplyUnsafe(t){let r=st.ZERO;if(typeof t=="bigint"&&t===tt)return r;let n=bu(t);if(n===wt)return this;if(!Ji){let h=r,l=this;for(;n>tt;)n&wt&&(h=h.add(l)),l=l.double(),n>>=wt;return h}let{k1neg:i,k1:s,k2neg:a,k2:o}=Qi.splitScalar(n),f=r,c=r,u=this;for(;s>tt||o>tt;)s&wt&&(f=f.add(u)),o&wt&&(c=c.add(u)),u=u.double(),s>>=wt,o>>=wt;return i&&(f=f.negate()),a&&(c=c.negate()),c=new st(P(c.x*Qi.beta),c.y,c.z),f.add(c)}precomputeWindow(t){let r=Ji?128/t+1:256/t+1,n=[],i=this,s=i;for(let a=0;a<r;a++){s=i,n.push(s);for(let o=1;o<2**(t-1);o++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(t,r){!r&&this.equals(st.BASE)&&(r=ht.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&ja.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=st.normalizeZ(i),ja.set(r,i)));let s=st.ZERO,a=st.BASE,o=1+(Ji?128/n:256/n),f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(t&c);t>>=h,p>f&&(p-=u,t+=wt);let y=d,x=d+Math.abs(p)-1,m=l%2!==0,b=p<0;p===0?a=a.add(ji(m,i[y])):s=s.add(ji(b,i[x]))}return{p:s,f:a}}multiply(t,r){let n=bu(t),i,s;if(Ji){let{k1neg:a,k1:o,k2neg:f,k2:c}=Qi.splitScalar(n),{p:u,f:h}=this.wNAF(o,r),{p:l,f:d}=this.wNAF(c,r);u=ji(a,u),l=ji(f,l),l=new st(P(l.x*Qi.beta),l.y,l.z),i=u.add(l),s=h.add(d)}else{let{p:a,f:o}=this.wNAF(n,r);i=a,s=o}return st.normalizeZ([i,s])[0]}toAffine(t){let{x:r,y:n,z:i}=this,s=this.equals(st.ZERO);t==null&&(t=s?lu:hn(i));let a=t,o=P(a*a),f=P(o*a),c=P(r*o),u=P(n*f),h=P(i*a);if(s)return ht.ZERO;if(h!==wt)throw new Error("invZ was invalid");return new ht(c,u)}};st.BASE=new st(Lt.Gx,Lt.Gy,wt);st.ZERO=new st(tt,wt,tt);function ji(e,t){let r=t.negate();return e?r:t}var ja=new WeakMap,ht=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,ja.delete(this)}hasEvenY(){return this.y%hr===tt}static fromCompressedHex(t){let r=t.length===32,n=lr(r?t:t.subarray(1));if(!Ja(n))throw new Error("Point is not on curve");let i=gu(n),s=Y1(i),a=(s&wt)===wt;r?a&&(s=P(-s)):(t[0]&1)===1!==a&&(s=P(-s));let o=new ht(n,s);return o.assertValidity(),o}static fromUncompressedHex(t){let r=lr(t.subarray(1,Se+1)),n=lr(t.subarray(Se+1,Se*2+1)),i=new ht(r,n);return i.assertValidity(),i}static fromHex(t){let r=un(t),n=r.length,i=r[0];if(n===Se)return this.fromCompressedHex(r);if(n===du&&(i===2||i===3))return this.fromCompressedHex(r);if(n===yu&&i===4)return this.fromUncompressedHex(r);throw new Error(`Point.fromHex: received invalid point. Expected 32-${du} compressed bytes or ${yu} uncompressed bytes, not ${n}`)}static fromPrivateKey(t){return ht.BASE.multiply(ns(t))}static fromSignature(t,r,n){let{r:i,s}=wu(r);if(![0,1,2,3].includes(n))throw new Error("Cannot recover: invalid recovery bit");let a=ro(un(t)),{n:o}=Lt,f=n===2||n===3?i+o:i,c=hn(f,o),u=P(-a*c,o),h=P(s*c,o),l=n&1?"03":"02",d=ht.fromHex(l+an(f)),p=ht.BASE.multiplyAndAddUnsafe(d,u,h);if(!p)throw new Error("Cannot recover signature: point at infinify");return p.assertValidity(),p}toRawBytes(t=!1){return kr(this.toHex(t))}toHex(t=!1){let r=an(this.x);return t?`${this.hasEvenY()?"02":"03"}${r}`:`04${r}${an(this.y)}`}toHexX(){return this.toHex(!0).slice(2)}toRawX(){return this.toRawBytes(!0).slice(1)}assertValidity(){let t="Point is not on elliptic curve",{x:r,y:n}=this;if(!Ja(r)||!Ja(n))throw new Error(t);let i=P(n*n),s=gu(r);if(P(i-s)!==tt)throw new Error(t)}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new ht(this.x,P(-this.y))}double(){return st.fromAffine(this).double().toAffine()}add(t){return st.fromAffine(this).add(st.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return st.fromAffine(this).multiply(t,this).toAffine()}multiplyAndAddUnsafe(t,r,n){let i=st.fromAffine(this),s=r===tt||r===wt||this!==ht.BASE?i.multiplyUnsafe(r):i.multiply(r),a=st.fromAffine(t).multiplyUnsafe(n),o=s.add(a);return o.equals(st.ZERO)?void 0:o.toAffine()}};ht.BASE=new ht(Lt.Gx,Lt.Gy);ht.ZERO=new ht(tt,tt);function mu(e){return Number.parseInt(e[0],16)>=8?"00"+e:e}function vu(e){if(e.length<2||e[0]!==2)throw new Error(`Invalid signature integer tag: ${cn(e)}`);let t=e[1],r=e.subarray(2,t+2);if(!t||r.length!==t)throw new Error("Invalid signature integer: wrong length");if(r[0]===0&&r[1]<=127)throw new Error("Invalid signature integer: trailing length");return{data:lr(r),left:e.subarray(t+2)}}function z1(e){if(e.length<2||e[0]!=48)throw new Error(`Invalid signature tag: ${cn(e)}`);if(e[1]!==e.length-2)throw new Error("Invalid signature: incorrect length");let{data:t,left:r}=vu(e.subarray(2)),{data:n,left:i}=vu(r);if(i.length)throw new Error(`Invalid signature: left bytes after parsing: ${cn(i)}`);return{r:t,s:n}}var Oe=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromCompact(t){let r=t instanceof Uint8Array,n="Signature.fromCompact";if(typeof t!="string"&&!r)throw new TypeError(`${n}: Expected string or Uint8Array`);let i=r?cn(t):t;if(i.length!==128)throw new Error(`${n}: Expected 64-byte hex`);return new Oe(rs(i.slice(0,64)),rs(i.slice(64,128)))}static fromDER(t){let r=t instanceof Uint8Array;if(typeof t!="string"&&!r)throw new TypeError("Signature.fromDER: Expected string or Uint8Array");let{r:n,s:i}=z1(r?t:kr(t));return new Oe(n,i)}static fromHex(t){return this.fromDER(t)}assertValidity(){let{r:t,s:r}=this;if(!Yn(t))throw new Error("Invalid Signature: r must be 0 < r < n");if(!Yn(r))throw new Error("Invalid Signature: s must be 0 < s < n")}hasHighS(){let t=Lt.n>>wt;return this.s>t}normalizeS(){return this.hasHighS()?new Oe(this.r,P(-this.s,Lt.n)):this}toDERRawBytes(){return kr(this.toDERHex())}toDERHex(){let t=mu(zn(this.s)),r=mu(zn(this.r)),n=t.length/2,i=r.length/2,s=zn(n),a=zn(i);return`30${zn(i+n+4)}02${a}${r}02${s}${t}`}toRawBytes(){return this.toDERRawBytes()}toHex(){return this.toDERHex()}toCompactRawBytes(){return kr(this.toCompactHex())}toCompactHex(){return an(this.r)+an(this.s)}};function ur(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Uint8Array list expected");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var G1=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function cn(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");let t="";for(let r=0;r<e.length;r++)t+=G1[e[r]];return t}var W1=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000");function an(e){if(typeof e!="bigint")throw new Error("Expected bigint");if(!(tt<=e&&e<W1))throw new Error("Expected number 0 <= n < 2^256");return e.toString(16).padStart(64,"0")}function to(e){let t=kr(an(e));if(t.length!==32)throw new Error("Error: expected 32 bytes");return t}function zn(e){let t=e.toString(16);return t.length&1?`0${t}`:t}function rs(e){if(typeof e!="string")throw new TypeError("hexToNumber: expected string, got "+typeof e);return BigInt(`0x${e}`)}function kr(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex"+e.length);let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function lr(e){return rs(cn(e))}function un(e){return e instanceof Uint8Array?Uint8Array.from(e):kr(e)}function bu(e){if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)return BigInt(e);if(typeof e=="bigint"&&Yn(e))return e;throw new TypeError("Expected valid private scalar: 0 < scalar < curve.n")}function P(e,t=Lt.P){let r=e%t;return r>=tt?r:t+r}function ye(e,t){let{P:r}=Lt,n=e;for(;t-- >tt;)n*=n,n%=r;return n}function Y1(e){let{P:t}=Lt,r=BigInt(6),n=BigInt(11),i=BigInt(22),s=BigInt(23),a=BigInt(44),o=BigInt(88),f=e*e*e%t,c=f*f*e%t,u=ye(c,Gn)*c%t,h=ye(u,Gn)*c%t,l=ye(h,hr)*f%t,d=ye(l,n)*l%t,p=ye(d,i)*d%t,y=ye(p,a)*p%t,x=ye(y,o)*y%t,m=ye(x,a)*p%t,b=ye(m,Gn)*c%t,w=ye(b,s)*d%t,C=ye(w,r)*f%t,B=ye(C,hr);if(B*B%t!==e)throw new Error("Cannot find square root");return B}function hn(e,t=Lt.P){if(e===tt||t<=tt)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=P(e,t),n=t,i=tt,s=wt,a=wt,o=tt;for(;r!==tt;){let c=n/r,u=n%r,h=i-a*c,l=s-o*c;n=r,r=u,i=a,s=o,a=h,o=l}if(n!==wt)throw new Error("invert: does not exist");return P(i,t)}function $1(e,t=Lt.P){let r=new Array(e.length),n=e.reduce((s,a,o)=>a===tt?s:(r[o]=s,P(s*a,t)),wt),i=hn(n,t);return e.reduceRight((s,a,o)=>a===tt?s:(r[o]=P(s*r[o],t),P(s*a,t)),i),r}function X1(e){let t=e.length*8-fn*8,r=lr(e);return t>0?r>>BigInt(t):r}function ro(e,t=!1){let r=X1(e);if(t)return r;let{n}=Lt;return r>=n?r-n:r}var on,Wn,eo=class{constructor(t,r){if(this.hashLen=t,this.qByteLen=r,typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof r!="number"||r<2)throw new Error("qByteLen must be a number");this.v=new Uint8Array(t).fill(1),this.k=new Uint8Array(t).fill(0),this.counter=0}hmac(...t){return Be.hmacSha256(this.k,...t)}hmacSync(...t){return Wn(this.k,...t)}checkSync(){if(typeof Wn!="function")throw new es("hmacSha256Sync needs to be set")}incr(){if(this.counter>=1e3)throw new Error("Tried 1,000 k values for sign(), all were invalid");this.counter+=1}async reseed(t=new Uint8Array){this.k=await this.hmac(this.v,Uint8Array.from([0]),t),this.v=await this.hmac(this.v),t.length!==0&&(this.k=await this.hmac(this.v,Uint8Array.from([1]),t),this.v=await this.hmac(this.v))}reseedSync(t=new Uint8Array){this.checkSync(),this.k=this.hmacSync(this.v,Uint8Array.from([0]),t),this.v=this.hmacSync(this.v),t.length!==0&&(this.k=this.hmacSync(this.v,Uint8Array.from([1]),t),this.v=this.hmacSync(this.v))}async generate(){this.incr();let t=0,r=[];for(;t<this.qByteLen;){this.v=await this.hmac(this.v);let n=this.v.slice();r.push(n),t+=this.v.length}return ur(...r)}generateSync(){this.checkSync(),this.incr();let t=0,r=[];for(;t<this.qByteLen;){this.v=this.hmacSync(this.v);let n=this.v.slice();r.push(n),t+=this.v.length}return ur(...r)}};function Yn(e){return tt<e&&e<Lt.n}function Ja(e){return tt<e&&e<Lt.P}function Z1(e,t,r,n=!0){let{n:i}=Lt,s=ro(e,!0);if(!Yn(s))return;let a=hn(s,i),o=ht.BASE.multiply(s),f=P(o.x,i);if(f===tt)return;let c=P(a*P(t+r*f,i),i);if(c===tt)return;let u=new Oe(f,c),h=(o.x===u.r?0:2)|Number(o.y&wt);return n&&u.hasHighS()&&(u=u.normalizeS(),h^=1),{sig:u,recovery:h}}function ns(e){let t;if(typeof e=="bigint")t=e;else if(typeof e=="number"&&Number.isSafeInteger(e)&&e>0)t=BigInt(e);else if(typeof e=="string"){if(e.length!==2*fn)throw new Error("Expected 32 bytes of private key");t=rs(e)}else if(e instanceof Uint8Array){if(e.length!==fn)throw new Error("Expected 32 bytes of private key");t=lr(e)}else throw new TypeError("Expected valid private key");if(!Yn(t))throw new Error("Expected private key: 0 < key < n");return t}function Q1(e){return e instanceof ht?(e.assertValidity(),e):ht.fromHex(e)}function wu(e){if(e instanceof Oe)return e.assertValidity(),e;try{return Oe.fromDER(e)}catch{return Oe.fromCompact(e)}}function no(e,t=!1){return ht.fromPrivateKey(e).toRawBytes(t)}function Eu(e){let t=e.length>Se?e.slice(0,Se):e;return lr(t)}function J1(e){let t=Eu(e),r=P(t,Lt.n);return Su(r<tt?t:r)}function Su(e){return to(e)}function j1(e,t,r){if(e==null)throw new Error(`sign: expected valid message hash, not "${e}"`);let n=un(e),i=ns(t),s=[Su(i),J1(n)];if(r!=null){r===!0&&(r=Be.randomBytes(Se));let f=un(r);if(f.length!==Se)throw new Error(`sign: Expected ${Se} bytes of extra data`);s.push(f)}let a=ur(...s),o=Eu(n);return{seed:a,m:o,d:i}}function t2(e,t){let{sig:r,recovery:n}=e,{der:i,recovered:s}=Object.assign({canonical:!0,der:!0},t),a=i?r.toDERRawBytes():r.toCompactRawBytes();return s?[a,n]:a}async function Bu(e,t,r={}){let{seed:n,m:i,d:s}=j1(e,t,r.extraEntropy),a=new eo(q1,fn);await a.reseed(n);let o;for(;!(o=Z1(await a.generate(),i,s,r.canonical));)await a.reseed();return t2(o,r)}var e2={strict:!0};function Au(e,t,r,n=e2){let i;try{i=wu(e),t=un(t)}catch{return!1}let{r:s,s:a}=i;if(n.strict&&i.hasHighS())return!1;let o=ro(t),f;try{f=Q1(r)}catch{return!1}let{n:c}=Lt,u=hn(a,c),h=P(o*u,c),l=P(s*u,c),d=ht.BASE.multiplyAndAddUnsafe(f,h,l);return d?P(d.x,c)===s:!1}ht.BASE._setWindowSize(8);var ue={node:V1,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0};var ts={},Be={bytesToHex:cn,hexToBytes:kr,concatBytes:ur,mod:P,invert:hn,isValidPrivateKey(e){try{return ns(e),!0}catch{return!1}},_bigintTo32Bytes:to,_normalizePrivateKey:ns,hashToPrivateKey:e=>{e=un(e);let t=fn+8;if(e.length<t||e.length>1024)throw new Error("Expected valid bytes of private key as per FIPS 186");let r=P(lr(e),Lt.n-wt)+wt;return to(r)},randomBytes:(e=32)=>{if(ue.web)return ue.web.getRandomValues(new Uint8Array(e));if(ue.node){let{randomBytes:t}=ue.node;return Uint8Array.from(t(e))}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>Be.hashToPrivateKey(Be.randomBytes(fn+8)),precompute(e=8,t=ht.BASE){let r=t===ht.BASE?t:new ht(t.x,t.y);return r._setWindowSize(e),r.multiply(Gn),r},sha256:async(...e)=>{if(ue.web){let t=await ue.web.subtle.digest("SHA-256",ur(...e));return new Uint8Array(t)}else if(ue.node){let{createHash:t}=ue.node,r=t("sha256");return e.forEach(n=>r.update(n)),Uint8Array.from(r.digest())}else throw new Error("The environment doesn't have sha256 function")},hmacSha256:async(e,...t)=>{if(ue.web){let r=await ue.web.subtle.importKey("raw",e,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),n=ur(...t),i=await ue.web.subtle.sign("HMAC",r,n);return new Uint8Array(i)}else if(ue.node){let{createHmac:r}=ue.node,n=r("sha256",e);return t.forEach(i=>n.update(i)),Uint8Array.from(n.digest())}else throw new Error("The environment doesn't have hmac-sha256 function")},sha256Sync:void 0,hmacSha256Sync:void 0,taggedHash:async(e,...t)=>{let r=ts[e];if(r===void 0){let n=await Be.sha256(Uint8Array.from(e,i=>i.charCodeAt(0)));r=ur(n,n),ts[e]=r}return Be.sha256(r,...t)},taggedHashSync:(e,...t)=>{if(typeof on!="function")throw new es("sha256Sync is undefined, you need to set it");let r=ts[e];if(r===void 0){let n=on(Uint8Array.from(e,i=>i.charCodeAt(0)));r=ur(n,n),ts[e]=r}return on(r,...t)},_JacobianPoint:st};Object.defineProperties(Be,{sha256Sync:{configurable:!1,get(){return on},set(e){on||(on=e)}},hmacSha256Sync:{configurable:!1,get(){return Wn},set(e){Wn||(Wn=e)}}});function is(e){if(isNaN(e)||e<=0)throw new yt("random bytes length must be a Number bigger than 0","ERR_INVALID_LENGTH");return Be.randomBytes(e)}var Dr={};Ht(Dr,{jwkToPkcs1:()=>i2,jwkToPkix:()=>a2,pkcs1ToJwk:()=>n2,pkixToJwk:()=>s2});var tb=gt(Dn(),1),eb=gt($i(),1),Qe=gt(dt(),1);function n2(e){let t=Qe.default.asn1.fromDer(Ct(e,"ascii")),r=Qe.default.pki.privateKeyFromAsn1(t);return{kty:"RSA",n:Ee(r.n),e:Ee(r.e),d:Ee(r.d),p:Ee(r.p),q:Ee(r.q),dp:Ee(r.dP),dq:Ee(r.dQ),qi:Ee(r.qInv),alg:"RS256"}}function i2(e){if(e.n==null||e.e==null||e.d==null||e.p==null||e.q==null||e.dp==null||e.dq==null||e.qi==null)throw new yt("JWK was missing components","ERR_INVALID_PARAMETERS");let t=Qe.default.pki.privateKeyToAsn1({n:ce(e.n),e:ce(e.e),d:ce(e.d),p:ce(e.p),q:ce(e.q),dP:ce(e.dp),dQ:ce(e.dq),qInv:ce(e.qi)});return zt(Qe.default.asn1.toDer(t).getBytes(),"ascii")}function s2(e){let t=Qe.default.asn1.fromDer(Ct(e,"ascii")),r=Qe.default.pki.publicKeyFromAsn1(t);return{kty:"RSA",n:Ee(r.n),e:Ee(r.e)}}function a2(e){if(e.n==null||e.e==null)throw new yt("JWK was missing components","ERR_INVALID_PARAMETERS");let t=Qe.default.pki.publicKeyToAsn1({n:ce(e.n),e:ce(e.e)});return zt(Qe.default.asn1.toDer(t).getBytes(),"ascii")}var ab=gt($i(),1),io=gt(dt(),1);function _u(e,t){return t.map(r=>ce(e[r]))}function Cu(e){return io.default.pki.setRsaPrivateKey(..._u(e,["n","e","d","p","q","dp","dq","qi"]))}function Tu(e){return io.default.pki.setRsaPublicKey(..._u(e,["n","e"]))}async function Iu(e){let t=await se.get().subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:e,publicExponent:new Uint8Array([1,0,1]),hash:{name:"SHA-256"}},!0,["sign","verify"]),r=await Uu(t);return{privateKey:r[0],publicKey:r[1]}}async function so(e){let r=[await se.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["sign"]),await o2(e)],n=await Uu({privateKey:r[0],publicKey:r[1]});return{privateKey:n[0],publicKey:n[1]}}async function Lu(e,t){let r=await se.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["sign"]),n=await se.get().subtle.sign({name:"RSASSA-PKCS1-v1_5"},r,Uint8Array.from(t));return new Uint8Array(n,0,n.byteLength)}async function Ru(e,t,r){let n=await se.get().subtle.importKey("jwk",e,{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!1,["verify"]);return await se.get().subtle.verify({name:"RSASSA-PKCS1-v1_5"},n,t,r)}async function Uu(e){if(e.privateKey==null||e.publicKey==null)throw new yt("Private and public key are required","ERR_INVALID_PARAMETERS");return await Promise.all([se.get().subtle.exportKey("jwk",e.privateKey),se.get().subtle.exportKey("jwk",e.publicKey)])}async function o2(e){return await se.get().subtle.importKey("jwk",{kty:e.kty,n:e.n,e:e.e},{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}},!0,["verify"])}function Nu(e,t,r,n){let i=t?Tu(e):Cu(e),s=Ct(Uint8Array.from(r),"ascii"),a=n(s,i);return zt(a,"ascii")}function Pu(e,t){return Nu(e,!0,t,(r,n)=>n.encrypt(r))}function ku(e,t){return Nu(e,!1,t,(r,n)=>n.decrypt(r))}async function ln(e,t){let n=await Xa().encrypt(e,t);return jr.encode(n)}var Xn=class{constructor(t){this._key=t}async verify(t,r){return await Ru(this._key,r,t)}marshal(){return Dr.jwkToPkix(this._key)}get bytes(){return Re.encode({Type:St.RSA,Data:this.marshal()}).subarray()}encrypt(t){return Pu(this._key,t)}equals(t){return Pt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await qt.digest(this.bytes);return t}},pn=class{constructor(t,r){this._key=t,this._publicKey=r}genSecret(){return is(16)}async sign(t){return await Lu(this._key,t)}get public(){if(this._publicKey==null)throw new yt("public key not provided","ERR_PUBKEY_NOT_PROVIDED");return new Xn(this._publicKey)}decrypt(t){return ku(this._key,t)}marshal(){return Dr.jwkToPkcs1(this._key)}get bytes(){return Ue.encode({Type:St.RSA,Data:this.marshal()}).subarray()}equals(t){return Pt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await qt.digest(this.bytes);return t}async id(){let t=await this.public.hash();return Ct(t,"base58btc")}async export(t,r="pkcs-8"){if(r==="pkcs-8"){let n=new $n.default.util.ByteBuffer(this.marshal()),i=$n.default.asn1.fromDer(n),s=$n.default.pki.privateKeyFromAsn1(i),a={algorithm:"aes256",count:1e4,saltSize:128/8,prfAlgorithm:"sha512"};return $n.default.pki.encryptRsaPrivateKey(s,t,a)}else{if(r==="libp2p-key")return await ln(this.bytes,t);throw new yt(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}}};async function c2(e){let t=Dr.pkcs1ToJwk(e),r=await so(t);return new pn(r.privateKey,r.publicKey)}function u2(e){let t=Dr.pkixToJwk(e);return new Xn(t)}async function h2(e){let t=await so(e);return new pn(t.privateKey,t.publicKey)}async function l2(e){let t=await Iu(e);return new pn(t.privateKey,t.publicKey)}var go={};Ht(go,{Ed25519PrivateKey:()=>Mr,Ed25519PublicKey:()=>ti,generateKeyPair:()=>N2,generateKeyPairFromSeed:()=>Zu,unmarshalEd25519PrivateKey:()=>R2,unmarshalEd25519PublicKey:()=>U2});var p2=gt(wr(),1);var Ft=BigInt(0),et=BigInt(1),yr=BigInt(2),d2=BigInt(8),Du=BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),Et=Object.freeze({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),P:BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),l:Du,n:Du,h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960")});var Hu=BigInt("0x10000000000000000000000000000000000000000000000000000000000000000"),Zn=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),Sb=BigInt("6853475219497561581579357271197624642482790079785650197046958215289687604742"),y2=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),g2=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),x2=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),m2=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),J=class{constructor(t,r,n,i){this.x=t,this.y=r,this.z=n,this.t=i}static fromAffine(t){if(!(t instanceof At))throw new TypeError("ExtendedPoint#fromAffine: expected Point");return t.equals(At.ZERO)?J.ZERO:new J(t.x,t.y,et,T(t.x*t.y))}static toAffineBatch(t){let r=w2(t.map(n=>n.z));return t.map((n,i)=>n.toAffine(r[i]))}static normalizeZ(t){return this.toAffineBatch(t).map(this.fromAffine)}equals(t){Mu(t);let{x:r,y:n,z:i}=this,{x:s,y:a,z:o}=t,f=T(r*o),c=T(s*i),u=T(n*o),h=T(a*i);return f===c&&u===h}negate(){return new J(T(-this.x),this.y,this.z,T(-this.t))}double(){let{x:t,y:r,z:n}=this,{a:i}=Et,s=T(t*t),a=T(r*r),o=T(yr*T(n*n)),f=T(i*s),c=t+r,u=T(T(c*c)-s-a),h=f+a,l=h-o,d=f-a,p=T(u*l),y=T(h*d),x=T(u*d),m=T(l*h);return new J(p,y,m,x)}add(t){Mu(t);let{x:r,y:n,z:i,t:s}=this,{x:a,y:o,z:f,t:c}=t,u=T((n-r)*(o+a)),h=T((n+r)*(o-a)),l=T(h-u);if(l===Ft)return this.double();let d=T(i*yr*c),p=T(s*yr*f),y=p+d,x=h+u,m=p-d,b=T(y*l),w=T(x*m),C=T(y*m),B=T(l*x);return new J(b,w,B,C)}subtract(t){return this.add(t.negate())}precomputeWindow(t){let r=1+256/t,n=[],i=this,s=i;for(let a=0;a<r;a++){s=i,n.push(s);for(let o=1;o<2**(t-1);o++)s=s.add(i),n.push(s);i=s.double()}return n}wNAF(t,r){!r&&this.equals(J.BASE)&&(r=At.BASE);let n=r&&r._WINDOW_SIZE||1;if(256%n)throw new Error("Point#wNAF: Invalid precomputation window, must be power of 2");let i=r&&ho.get(r);i||(i=this.precomputeWindow(n),r&&n!==1&&(i=J.normalizeZ(i),ho.set(r,i)));let s=J.ZERO,a=J.BASE,o=1+256/n,f=2**(n-1),c=BigInt(2**n-1),u=2**n,h=BigInt(n);for(let l=0;l<o;l++){let d=l*f,p=Number(t&c);t>>=h,p>f&&(p-=u,t+=et);let y=d,x=d+Math.abs(p)-1,m=l%2!==0,b=p<0;p===0?a=a.add(Ku(m,i[y])):s=s.add(Ku(b,i[x]))}return J.normalizeZ([s,a])[0]}multiply(t,r){return this.wNAF(as(t,Et.l),r)}multiplyUnsafe(t){let r=as(t,Et.l,!1),n=J.BASE,i=J.ZERO;if(r===Ft)return i;if(this.equals(i)||r===et)return this;if(this.equals(n))return this.wNAF(r);let s=i,a=this;for(;r>Ft;)r&et&&(s=s.add(a)),a=a.double(),r>>=et;return s}isSmallOrder(){return this.multiplyUnsafe(Et.h).equals(J.ZERO)}isTorsionFree(){let t=this.multiplyUnsafe(Et.l/yr).double();return Et.l%yr&&(t=t.add(this)),t.equals(J.ZERO)}toAffine(t){let{x:r,y:n,z:i}=this,s=this.equals(J.ZERO);t==null&&(t=s?d2:os(i));let a=T(r*t),o=T(n*t),f=T(i*t);if(s)return At.ZERO;if(f!==et)throw new Error("invZ was invalid");return new At(a,o)}fromRistrettoBytes(){fo()}toRistrettoBytes(){fo()}fromRistrettoHash(){fo()}};J.BASE=new J(Et.Gx,Et.Gy,et,T(Et.Gx*Et.Gy));J.ZERO=new J(Ft,et,et,Ft);function Ku(e,t){let r=t.negate();return e?r:t}function Mu(e){if(!(e instanceof J))throw new TypeError("ExtendedPoint expected")}function oo(e){if(!(e instanceof ae))throw new TypeError("RistrettoPoint expected")}function fo(){throw new Error("Legacy method: switch to RistrettoPoint")}var ae=class{constructor(t){this.ep=t}static calcElligatorRistrettoMap(t){let{d:r}=Et,n=T(Zn*t*t),i=T((n+et)*x2),s=BigInt(-1),a=T((s-r*n)*T(n+r)),{isValid:o,value:f}=po(i,a),c=T(f*t);dr(c)||(c=T(-c)),o||(f=c),o||(s=n);let u=T(s*(n-et)*m2-a),h=f*f,l=T((f+f)*a),d=T(u*y2),p=T(et-h),y=T(et+h);return new J(T(l*y),T(p*d),T(d*y),T(l*p))}static hashToCurve(t){t=gr(t,64);let r=co(t.slice(0,32)),n=this.calcElligatorRistrettoMap(r),i=co(t.slice(32,64)),s=this.calcElligatorRistrettoMap(i);return new ae(n.add(s))}static fromHex(t){t=gr(t,32);let{a:r,d:n}=Et,i="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",s=co(t);if(!S2(Qn(s),t)||dr(s))throw new Error(i);let a=T(s*s),o=T(et+r*a),f=T(et-r*a),c=T(o*o),u=T(f*f),h=T(r*n*c-u),{isValid:l,value:d}=Ou(T(h*u)),p=T(d*f),y=T(d*p*h),x=T((s+s)*p);dr(x)&&(x=T(-x));let m=T(o*y),b=T(x*m);if(!l||dr(b)||m===Ft)throw new Error(i);return new ae(new J(x,m,et,b))}toRawBytes(){let{x:t,y:r,z:n,t:i}=this.ep,s=T(T(n+r)*T(n-r)),a=T(t*r),o=T(a*a),{value:f}=Ou(T(s*o)),c=T(f*s),u=T(f*a),h=T(c*u*i),l;if(dr(i*h)){let p=T(r*Zn),y=T(t*Zn);t=p,r=y,l=T(c*g2)}else l=u;dr(t*h)&&(r=T(-r));let d=T((n-r)*l);return dr(d)&&(d=T(-d)),Qn(d)}toHex(){return Jn(this.toRawBytes())}toString(){return this.toHex()}equals(t){oo(t);let r=this.ep,n=t.ep,i=T(r.x*n.y)===T(r.y*n.x),s=T(r.y*n.y)===T(r.x*n.x);return i||s}add(t){return oo(t),new ae(this.ep.add(t.ep))}subtract(t){return oo(t),new ae(this.ep.subtract(t.ep))}multiply(t){return new ae(this.ep.multiply(t))}multiplyUnsafe(t){return new ae(this.ep.multiplyUnsafe(t))}};ae.BASE=new ae(J.BASE);ae.ZERO=new ae(J.ZERO);var ho=new WeakMap,At=class{constructor(t,r){this.x=t,this.y=r}_setWindowSize(t){this._WINDOW_SIZE=t,ho.delete(this)}static fromHex(t,r=!0){let{d:n,P:i}=Et;t=gr(t,32);let s=t.slice();s[31]=t[31]&-129;let a=jn(s);if(r&&a>=i)throw new Error("Expected 0 < hex < P");if(!r&&a>=Hu)throw new Error("Expected 0 < hex < 2**256");let o=T(a*a),f=T(o-et),c=T(n*o+et),{isValid:u,value:h}=po(f,c);if(!u)throw new Error("Point.fromHex: invalid y coordinate");let l=(h&et)===et;return(t[31]&128)!==0!==l&&(h=T(-h)),new At(h,a)}static async fromPrivateKey(t){return(await fs(t)).point}toRawBytes(){let t=Qn(this.y);return t[31]|=this.x&et?128:0,t}toHex(){return Jn(this.toRawBytes())}toX25519(){let{y:t}=this,r=T((et+t)*os(et-t));return Qn(r)}isTorsionFree(){return J.fromAffine(this).isTorsionFree()}equals(t){return this.x===t.x&&this.y===t.y}negate(){return new At(T(-this.x),this.y)}add(t){return J.fromAffine(this).add(J.fromAffine(t)).toAffine()}subtract(t){return this.add(t.negate())}multiply(t){return J.fromAffine(this).multiply(t,this).toAffine()}};At.BASE=new At(Et.Gx,Et.Gy);At.ZERO=new At(Ft,et);var Kr=class{constructor(t,r){this.r=t,this.s=r,this.assertValidity()}static fromHex(t){let r=gr(t,64),n=At.fromHex(r.slice(0,32),!1),i=jn(r.slice(32,64));return new Kr(n,i)}assertValidity(){let{r:t,s:r}=this;if(!(t instanceof At))throw new Error("Expected Point instance");return as(r,Et.l,!1),this}toRawBytes(){let t=new Uint8Array(64);return t.set(this.r.toRawBytes()),t.set(Qn(this.s),32),t}toHex(){return Jn(this.toRawBytes())}};function Fu(...e){if(!e.every(n=>n instanceof Uint8Array))throw new Error("Expected Uint8Array list");if(e.length===1)return e[0];let t=e.reduce((n,i)=>n+i.length,0),r=new Uint8Array(t);for(let n=0,i=0;n<e.length;n++){let s=e[n];r.set(s,i),i+=s.length}return r}var v2=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function Jn(e){if(!(e instanceof Uint8Array))throw new Error("Uint8Array expected");let t="";for(let r=0;r<e.length;r++)t+=v2[e[r]];return t}function lo(e){if(typeof e!="string")throw new TypeError("hexToBytes: expected string, got "+typeof e);if(e.length%2)throw new Error("hexToBytes: received invalid unpadded hex");let t=new Uint8Array(e.length/2);for(let r=0;r<t.length;r++){let n=r*2,i=e.slice(n,n+2),s=Number.parseInt(i,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");t[r]=s}return t}function Vu(e){let r=e.toString(16).padStart(64,"0");return lo(r)}function Qn(e){return Vu(e).reverse()}function dr(e){return(T(e)&et)===et}function jn(e){if(!(e instanceof Uint8Array))throw new Error("Expected Uint8Array");return BigInt("0x"+Jn(Uint8Array.from(e).reverse()))}var b2=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");function co(e){return T(jn(e)&b2)}function T(e,t=Et.P){let r=e%t;return r>=Ft?r:t+r}function os(e,t=Et.P){if(e===Ft||t<=Ft)throw new Error(`invert: expected positive integers, got n=${e} mod=${t}`);let r=T(e,t),n=t,i=Ft,s=et,a=et,o=Ft;for(;r!==Ft;){let c=n/r,u=n%r,h=i-a*c,l=s-o*c;n=r,r=u,i=a,s=o,a=h,o=l}if(n!==et)throw new Error("invert: does not exist");return T(i,t)}function w2(e,t=Et.P){let r=new Array(e.length),n=e.reduce((s,a,o)=>a===Ft?s:(r[o]=s,T(s*a,t)),et),i=os(n,t);return e.reduceRight((s,a,o)=>a===Ft?s:(r[o]=T(s*r[o],t),T(s*a,t)),i),r}function He(e,t){let{P:r}=Et,n=e;for(;t-- >Ft;)n*=n,n%=r;return n}function E2(e){let{P:t}=Et,r=BigInt(5),n=BigInt(10),i=BigInt(20),s=BigInt(40),a=BigInt(80),f=e*e%t*e%t,c=He(f,yr)*f%t,u=He(c,et)*e%t,h=He(u,r)*u%t,l=He(h,n)*h%t,d=He(l,i)*l%t,p=He(d,s)*d%t,y=He(p,a)*p%t,x=He(y,a)*p%t,m=He(x,n)*h%t;return{pow_p_5_8:He(m,yr)*e%t,b2:f}}function po(e,t){let r=T(t*t*t),n=T(r*r*t),i=E2(e*n).pow_p_5_8,s=T(e*r*i),a=T(t*s*s),o=s,f=T(s*Zn),c=a===e,u=a===T(-e),h=a===T(-e*Zn);return c&&(s=o),(u||h)&&(s=f),dr(s)&&(s=T(-s)),{isValid:c||u,value:s}}function Ou(e){return po(et,e)}function ss(e){return T(jn(e),Et.l)}function S2(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++)if(e[r]!==t[r])return!1;return!0}function gr(e,t){let r=e instanceof Uint8Array?Uint8Array.from(e):lo(e);if(typeof t=="number"&&r.length!==t)throw new Error(`Expected ${t} bytes`);return r}function as(e,t,r=!0){if(!t)throw new TypeError("Specify max value");if(typeof e=="number"&&Number.isSafeInteger(e)&&(e=BigInt(e)),typeof e=="bigint"&&e<t){if(r){if(Ft<e)return e}else if(Ft<=e)return e}throw new TypeError("Expected valid scalar: 0 < scalar < max")}function B2(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}function A2(e){if(e=typeof e=="bigint"||typeof e=="number"?Vu(as(e,Hu)):gr(e),e.length!==32)throw new Error("Expected 32 bytes");return e}function _2(e){let t=B2(e.slice(0,32)),r=e.slice(32,64),n=ss(t),i=At.BASE.multiply(n),s=i.toRawBytes();return{head:t,prefix:r,scalar:n,point:i,pointBytes:s}}var uo;async function fs(e){return _2(await xr.sha512(A2(e)))}async function yo(e){return(await fs(e)).pointBytes}async function qu(e,t){e=gr(e);let{prefix:r,scalar:n,pointBytes:i}=await fs(t),s=ss(await xr.sha512(r,e)),a=At.BASE.multiply(s),o=ss(await xr.sha512(a.toRawBytes(),i,e)),f=T(s+o*n,Et.l);return new Kr(a,f).toRawBytes()}function C2(e,t,r){t=gr(t),r instanceof At||(r=At.fromHex(r,!1));let{r:n,s:i}=e instanceof Kr?e.assertValidity():Kr.fromHex(e),s=J.BASE.multiplyUnsafe(i);return{r:n,s:i,SB:s,pub:r,msg:t}}function T2(e,t,r,n){let i=ss(n),s=J.fromAffine(e).multiplyUnsafe(i);return J.fromAffine(t).add(s).subtract(r).multiplyUnsafe(Et.h).equals(J.ZERO)}async function zu(e,t,r){let{r:n,SB:i,msg:s,pub:a}=C2(e,t,r),o=await xr.sha512(n.toRawBytes(),a.toRawBytes(),s);return T2(a,n,i,o)}At.BASE._setWindowSize(8);var pr={node:p2,web:typeof self=="object"&&"crypto"in self?self.crypto:void 0},xr={bytesToHex:Jn,hexToBytes:lo,concatBytes:Fu,getExtendedPublicKey:fs,mod:T,invert:os,TORSION_SUBGROUP:["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"],hashToPrivateScalar:e=>{if(e=gr(e),e.length<40||e.length>1024)throw new Error("Expected 40-1024 bytes of private key as per FIPS 186");return T(jn(e),Et.l-et)+et},randomBytes:(e=32)=>{if(pr.web)return pr.web.getRandomValues(new Uint8Array(e));if(pr.node){let{randomBytes:t}=pr.node;return new Uint8Array(t(e).buffer)}else throw new Error("The environment doesn't have randomBytes function")},randomPrivateKey:()=>xr.randomBytes(32),sha512:async(...e)=>{let t=Fu(...e);if(pr.web){let r=await pr.web.subtle.digest("SHA-512",t.buffer);return new Uint8Array(r)}else{if(pr.node)return Uint8Array.from(pr.node.createHash("sha512").update(t).digest());throw new Error("The environment doesn't have sha512 function")}},precompute(e=8,t=At.BASE){let r=t.equals(At.BASE)?t:new At(t.x,t.y);return r._setWindowSize(e),r.multiply(yr),r},sha512Sync:void 0};Object.defineProperties(xr,{sha512Sync:{configurable:!1,get(){return uo},set(e){uo||(uo=e)}}});var dn=32,Je=64,cs=32;async function Gu(){let e=xr.randomPrivateKey(),t=await yo(e);return{privateKey:Xu(e,t),publicKey:t}}async function Wu(e){if(e.length!==cs)throw new TypeError('"seed" must be 32 bytes in length.');if(!(e instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, or Uint8Array.');let t=e,r=await yo(t);return{privateKey:Xu(t,r),publicKey:r}}async function Yu(e,t){let r=e.subarray(0,cs);return await qu(t,r)}async function $u(e,t,r){return await zu(t,r,e)}function Xu(e,t){let r=new Uint8Array(Je);for(let n=0;n<cs;n++)r[n]=e[n],r[cs+n]=t[n];return r}var ti=class{constructor(t){this._key=yn(t,dn)}async verify(t,r){return await $u(this._key,r,t)}marshal(){return this._key}get bytes(){return Re.encode({Type:St.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Pt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await qt.digest(this.bytes);return t}},Mr=class{constructor(t,r){this._key=yn(t,Je),this._publicKey=yn(r,dn)}async sign(t){return await Yu(this._key,t)}get public(){return new ti(this._publicKey)}marshal(){return this._key}get bytes(){return Ue.encode({Type:St.Ed25519,Data:this.marshal()}).subarray()}equals(t){return Pt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await qt.digest(this.bytes);return t}async id(){let t=cr.digest(this.public.bytes);return Vt.encode(t.bytes).substring(1)}async export(t,r="libp2p-key"){if(r==="libp2p-key")return await ln(this.bytes,t);throw new yt(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function R2(e){if(e.length>Je){e=yn(e,Je+dn);let n=e.subarray(0,Je),i=e.subarray(Je,e.length);return new Mr(n,i)}e=yn(e,Je);let t=e.subarray(0,Je),r=e.subarray(dn);return new Mr(t,r)}function U2(e){return e=yn(e,dn),new ti(e)}async function N2(){let{privateKey:e,publicKey:t}=await Gu();return new Mr(e,t)}async function Zu(e){let{privateKey:t,publicKey:r}=await Wu(e);return new Mr(t,r)}function yn(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new yt(`Key must be a Uint8Array of length ${t}, got ${e.length}`,"ERR_INVALID_KEY_TYPE");return e}var mo={};Ht(mo,{Secp256k1PrivateKey:()=>ri,Secp256k1PublicKey:()=>ei,generateKeyPair:()=>K2,unmarshalSecp256k1PrivateKey:()=>k2,unmarshalSecp256k1PublicKey:()=>D2});function Qu(){return Be.randomPrivateKey()}async function Ju(e,t){let{digest:r}=await qt.digest(t);try{return await Bu(r,e)}catch(n){throw new yt(String(n),"ERR_INVALID_INPUT")}}async function ju(e,t,r){try{let{digest:n}=await qt.digest(r);return Au(t,n,e)}catch(n){throw new yt(String(n),"ERR_INVALID_INPUT")}}function th(e){return ht.fromHex(e).toRawBytes(!0)}function eh(e){try{no(e,!0)}catch(t){throw new yt(String(t),"ERR_INVALID_PRIVATE_KEY")}}function xo(e){try{ht.fromHex(e)}catch(t){throw new yt(String(t),"ERR_INVALID_PUBLIC_KEY")}}function rh(e){try{return no(e,!0)}catch(t){throw new yt(String(t),"ERR_INVALID_PRIVATE_KEY")}}var ei=class{constructor(t){xo(t),this._key=t}async verify(t,r){return await ju(this._key,r,t)}marshal(){return th(this._key)}get bytes(){return Re.encode({Type:St.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Pt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await qt.digest(this.bytes);return t}},ri=class{constructor(t,r){this._key=t,this._publicKey=r??rh(t),eh(this._key),xo(this._publicKey)}async sign(t){return await Ju(this._key,t)}get public(){return new ei(this._publicKey)}marshal(){return this._key}get bytes(){return Ue.encode({Type:St.Secp256k1,Data:this.marshal()}).subarray()}equals(t){return Pt(this.bytes,t.bytes)}async hash(){let{bytes:t}=await qt.digest(this.bytes);return t}async id(){let t=await this.public.hash();return Ct(t,"base58btc")}async export(t,r="libp2p-key"){if(r==="libp2p-key")return await ln(this.bytes,t);throw new yt(`export format '${r}' is not supported`,"ERR_INVALID_EXPORT_FORMAT")}};function k2(e){return new ri(e)}function D2(e){return new ei(e)}async function K2(){let e=Qu();return new ri(e)}var Fr={rsa:ao,ed25519:go,secp256k1:mo};function nh(e){let t=Object.keys(Fr).join(" / ");return new yt(`invalid or unsupported key type ${e}. Must be ${t}`,"ERR_UNSUPPORTED_KEY_TYPE")}function ih(e){let t=Re.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case St.RSA:return Fr.rsa.unmarshalRsaPublicKey(r);case St.Ed25519:return Fr.ed25519.unmarshalEd25519PublicKey(r);case St.Secp256k1:return Fr.secp256k1.unmarshalSecp256k1PublicKey(r);default:throw nh(t.Type??"RSA")}}async function sh(e){let t=Ue.decode(e),r=t.Data??new Uint8Array;switch(t.Type){case St.RSA:return await Fr.rsa.unmarshalRsaPrivateKey(r);case St.Ed25519:return Fr.ed25519.unmarshalEd25519PrivateKey(r);case St.Secp256k1:return Fr.secp256k1.unmarshalSecp256k1PrivateKey(r);default:throw nh(t.Type??"RSA")}}var ah=Symbol.for("@libp2p/peer-id");var F2=Symbol.for("nodejs.util.inspect.custom"),oh=Object.values(sn).map(e=>e.decoder).reduce((e,t)=>e.or(t),sn.identity.decoder),fh=114,vo=36,bo=37,ni=class{constructor(t){this.type=t.type,this.multihash=t.multihash,this.privateKey=t.privateKey,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}get[ah](){return!0}toString(){return this.string==null&&(this.string=Vt.encode(this.multihash.bytes).slice(1)),this.string}toCID(){return _t.createV1(fh,this.multihash)}toBytes(){return this.multihash.bytes}toJSON(){return this.toString()}equals(t){if(t instanceof Uint8Array)return Pt(this.multihash.bytes,t);if(typeof t=="string")return O2(t).equals(this);if(t?.multihash?.bytes!=null)return Pt(this.multihash.bytes,t.multihash.bytes);throw new Error("not valid Id")}[F2](){return`PeerId(${this.toString()})`}},gn=class extends ni{constructor(t){super({...t,type:"RSA"}),this.type="RSA",this.publicKey=t.publicKey}},xn=class extends ni{constructor(t){super({...t,type:"Ed25519"}),this.type="Ed25519",this.publicKey=t.multihash.digest}},mn=class extends ni{constructor(t){super({...t,type:"secp256k1"}),this.type="secp256k1",this.publicKey=t.multihash.digest}};function O2(e,t){if(t=t??oh,e.charAt(0)==="1"||e.charAt(0)==="Q"){let r=Hn(Vt.decode(`z${e}`));return e.startsWith("12D")?new xn({multihash:r}):e.startsWith("16U")?new mn({multihash:r}):new gn({multihash:r})}return H2(oh.decode(e))}function H2(e){try{let t=Hn(e);if(t.code===cr.code){if(t.digest.length===vo)return new xn({multihash:t});if(t.digest.length===bo)return new mn({multihash:t})}if(t.code===qt.code)return new gn({multihash:t})}catch{return V2(_t.decode(e))}throw new Error("Supplied PeerID CID is invalid")}function V2(e){if(e==null||e.multihash==null||e.version==null||e.version===1&&e.code!==fh)throw new Error("Supplied PeerID CID is invalid");let t=e.multihash;if(t.code===qt.code)return new gn({multihash:e.multihash});if(t.code===cr.code){if(t.digest.length===vo)return new xn({multihash:e.multihash});if(t.digest.length===bo)return new mn({multihash:e.multihash})}throw new Error("Supplied PeerID CID is invalid")}async function wo(e,t){return e.length===vo?new xn({multihash:Fe(cr.code,e),privateKey:t}):e.length===bo?new mn({multihash:Fe(cr.code,e),privateKey:t}):new gn({multihash:await qt.digest(e),publicKey:e,privateKey:t})}var us;(function(e){let t;e.codec=()=>(t==null&&(t=Tr((r,n,i={})=>{if(i.lengthDelimited!==!1&&n.fork(),r.webtransportCerthashes!=null)for(let s of r.webtransportCerthashes)n.uint32(10),n.bytes(s);i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={webtransportCerthashes:[]},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.webtransportCerthashes.push(r.bytes());break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>Cr(r,e.codec()),e.decode=r=>_r(r,e.codec())})(us||(us={}));var ii;(function(e){let t;e.codec=()=>(t==null&&(t=Tr((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),(i.writeDefaults===!0||r.identityKey!=null&&r.identityKey.byteLength>0)&&(n.uint32(10),n.bytes(r.identityKey??new Uint8Array(0))),(i.writeDefaults===!0||r.identitySig!=null&&r.identitySig.byteLength>0)&&(n.uint32(18),n.bytes(r.identitySig??new Uint8Array(0))),r.extensions!=null&&(n.uint32(34),us.codec().encode(r.extensions,n,{writeDefaults:!1})),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={identityKey:new Uint8Array(0),identitySig:new Uint8Array(0)},s=n==null?r.len:r.pos+n;for(;r.pos<s;){let a=r.uint32();switch(a>>>3){case 1:i.identityKey=r.bytes();break;case 2:i.identitySig=r.bytes();break;case 4:i.extensions=us.codec().decode(r,r.uint32());break;default:r.skipType(a&7);break}}return i})),t),e.encode=r=>Cr(r,e.codec()),e.decode=r=>_r(r,e.codec())})(ii||(ii={}));async function ch(e,t,r){let n=await z2(e,uh(t));if(e.publicKey==null)throw new Error("PublicKey was missing from local PeerId");return q2(e.publicKey,n,r)}function q2(e,t,r){return ii.encode({identityKey:e,identitySig:t,extensions:r??{webtransportCerthashes:[]}}).subarray()}async function z2(e,t){if(e.privateKey==null)throw new Error("PrivateKey was missing from PeerId");return await(await sh(e.privateKey)).sign(t)}async function Eo(e){return await wo(e.identityKey)}function So(e){return ii.decode(e)}function uh(e){let t=zt("noise-libp2p-static-key:");return Nt([t,e],t.length+e.length)}async function Bo(e,t,r){let n=await wo(t.identityKey);if(!n.equals(r))throw new Error(`Payload identity key ${n.toString()} does not match expected remote peer ${r.toString()}`);let i=uh(e);if(n.publicKey==null)throw new Error("PublicKey was missing from PeerId");if(t.identitySig==null)throw new Error("Signature was missing from message");if(!await ih(n.publicKey).verify(i,t.identitySig))throw new Error("Static key doesn't match to peer that signed payload!");return n}function si(e){return!(!(e instanceof Uint8Array)||e.length!==32)}var ge=gt(yh(),1);ge.default.formatters.b=e=>e==null?"undefined":Vt.baseEncode(e);ge.default.formatters.t=e=>e==null?"undefined":fr.baseEncode(e);ge.default.formatters.m=e=>e==null?"undefined":jr.baseEncode(e);ge.default.formatters.p=e=>e==null?"undefined":e.toString();ge.default.formatters.c=e=>e==null?"undefined":e.toString();ge.default.formatters.k=e=>e==null?"undefined":e.toString();function ng(e){let t=()=>{};return t.enabled=!1,t.color="",t.diff=0,t.log=()=>{},t.namespace=e,t.destroy=()=>!0,t.extend=()=>t,t}function gh(e){let t=ng(`${e}:trace`);return ge.default.enabled(`${e}:trace`)&&ge.default.names.map(r=>r.toString()).find(r=>r.includes(":trace"))!=null&&(t=(0,ge.default)(`${e}:trace`)),Object.assign((0,ge.default)(e),{error:(0,ge.default)(`${e}:error`),trace:t})}var Ot=gh("libp2p:noise");var xe;Ho?xe=Ot:xe=Object.assign(()=>{},{enabled:!1,trace:()=>{},error:()=>{}});function xh(e){xe(`LOCAL_STATIC_PUBLIC_KEY ${Ct(e.publicKey,"hex")}`),xe(`LOCAL_STATIC_PRIVATE_KEY ${Ct(e.privateKey,"hex")}`)}function Ao(e){e?(xe(`LOCAL_PUBLIC_EPHEMERAL_KEY ${Ct(e.publicKey,"hex")}`),xe(`LOCAL_PRIVATE_EPHEMERAL_KEY ${Ct(e.privateKey,"hex")}`)):xe("Missing local ephemeral keys.")}function mh(e){xe(`REMOTE_STATIC_PUBLIC_KEY ${Ct(e,"hex")}`)}function _o(e){xe(`REMOTE_EPHEMERAL_PUBLIC_KEY ${Ct(e,"hex")}`)}function vh(e){e.cs1&&e.cs2?(xe(`CIPHER_STATE_1 ${e.cs1.n.getUint64()} ${Ct(e.cs1.k,"hex")}`),xe(`CIPHER_STATE_2 ${e.cs2.n.getUint64()} ${Ct(e.cs2.k,"hex")}`)):xe("Missing cipher state.")}var ig="Cipherstate has reached maximum n, a new handshake must be performed",ps=class{constructor(t=0){this.n=t,this.bytes=new Uint8Array(12),this.view=new DataView(this.bytes.buffer,this.bytes.byteOffset,this.bytes.byteLength),this.view.setUint32(4,t,!0)}increment(){this.n++,this.view.setUint32(4,this.n,!0)}getBytes(){return this.bytes}getUint64(){return this.n}assertValue(){if(this.n>4294967295)throw new Error(ig)}};var ds=class{constructor(t){this.crypto=t}encryptWithAd(t,r,n){let i=this.encrypt(t.k,t.n,r,n);return t.n.increment(),i}decryptWithAd(t,r,n,i){let{plaintext:s,valid:a}=this.decrypt(t.k,t.n,r,n,i);return a&&t.n.increment(),{plaintext:s,valid:a}}hasKey(t){return!this.isEmptyKey(t.k)}createEmptyKey(){return new Uint8Array(32)}isEmptyKey(t){let r=this.createEmptyKey();return Pt(r,t)}encrypt(t,r,n,i){return r.assertValue(),this.crypto.chaCha20Poly1305Encrypt(i,r.getBytes(),n,t)}encryptAndHash(t,r){let n;return this.hasKey(t.cs)?n=this.encryptWithAd(t.cs,t.h,r):n=r,this.mixHash(t,n),n}decrypt(t,r,n,i,s){r.assertValue();let a=this.crypto.chaCha20Poly1305Decrypt(i,r.getBytes(),n,t,s);return a?{plaintext:a,valid:!0}:{plaintext:new Uint8Array(0),valid:!1}}decryptAndHash(t,r){let n,i=!0;return this.hasKey(t.cs)?{plaintext:n,valid:i}=this.decryptWithAd(t.cs,t.h,r):n=r,this.mixHash(t,r),{plaintext:n,valid:i}}dh(t,r){try{let n=this.crypto.generateX25519SharedKey(t,r);return n.length===32?n:n.subarray(0,32)}catch(n){let i=n;return Ot.error(i),new Uint8Array(32)}}mixHash(t,r){t.h=this.getHash(t.h,r)}getHash(t,r){return this.crypto.hashSHA256(Nt([t,r],t.length+r.length))}mixKey(t,r){let[n,i]=this.crypto.getHKDF(t.ck,r);t.cs=this.initializeKey(i),t.ck=n}initializeKey(t){return{k:t,n:new ps}}initializeSymmetric(t){let r=zt(t,"utf-8"),n=this.hashProtocolName(r),i=n,s=this.createEmptyKey();return{cs:this.initializeKey(s),ck:i,h:n}}hashProtocolName(t){if(t.length<=32){let r=new Uint8Array(32);return r.set(t),r}else return this.getHash(t,new Uint8Array(0))}split(t){let[r,n]=this.crypto.getHKDF(t.ck,new Uint8Array(0)),i=this.initializeKey(r),s=this.initializeKey(n);return{cs1:i,cs2:s}}writeMessageRegular(t,r){let n=this.encryptWithAd(t,new Uint8Array(0),r),i=this.createEmptyKey(),s=new Uint8Array(0);return{ne:i,ns:s,ciphertext:n}}readMessageRegular(t,r){return this.decryptWithAd(t,new Uint8Array(0),r.ciphertext)}};var ys=class extends ds{initializeInitiator(t,r,n,i){let s="Noise_XX_25519_ChaChaPoly_SHA256",a=this.initializeSymmetric(s);this.mixHash(a,t);let o=new Uint8Array(32);return{ss:a,s:r,rs:n,psk:i,re:o}}initializeResponder(t,r,n,i){let s="Noise_XX_25519_ChaChaPoly_SHA256",a=this.initializeSymmetric(s);this.mixHash(a,t);let o=new Uint8Array(32);return{ss:a,s:r,rs:n,psk:i,re:o}}writeMessageA(t,r,n){let i=new Uint8Array(0);n!==void 0?t.e=n:t.e=this.crypto.generateX25519KeyPair();let s=t.e.publicKey;this.mixHash(t.ss,s);let a=this.encryptAndHash(t.ss,r);return{ne:s,ns:i,ciphertext:a}}writeMessageB(t,r){t.e=this.crypto.generateX25519KeyPair();let n=t.e.publicKey;this.mixHash(t.ss,n),this.mixKey(t.ss,this.dh(t.e.privateKey,t.re));let i=t.s.publicKey,s=this.encryptAndHash(t.ss,i);this.mixKey(t.ss,this.dh(t.s.privateKey,t.re));let a=this.encryptAndHash(t.ss,r);return{ne:n,ns:s,ciphertext:a}}writeMessageC(t,r){let n=t.s.publicKey,i=this.encryptAndHash(t.ss,n);this.mixKey(t.ss,this.dh(t.s.privateKey,t.re));let s=this.encryptAndHash(t.ss,r),o={ne:this.createEmptyKey(),ns:i,ciphertext:s},{cs1:f,cs2:c}=this.split(t.ss);return{h:t.ss.h,messageBuffer:o,cs1:f,cs2:c}}readMessageA(t,r){return si(r.ne)&&(t.re=r.ne),this.mixHash(t.ss,t.re),this.decryptAndHash(t.ss,r.ciphertext)}readMessageB(t,r){if(si(r.ne)&&(t.re=r.ne),this.mixHash(t.ss,t.re),!t.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(t.ss,this.dh(t.e.privateKey,t.re));let{plaintext:n,valid:i}=this.decryptAndHash(t.ss,r.ns);i&&si(n)&&(t.rs=n),this.mixKey(t.ss,this.dh(t.e.privateKey,t.rs));let{plaintext:s,valid:a}=this.decryptAndHash(t.ss,r.ciphertext);return{plaintext:s,valid:i&&a}}readMessageC(t,r){let{plaintext:n,valid:i}=this.decryptAndHash(t.ss,r.ns);if(i&&si(n)&&(t.rs=n),!t.e)throw new Error("Handshake state `e` param is missing.");this.mixKey(t.ss,this.dh(t.e.privateKey,t.rs));let{plaintext:s,valid:a}=this.decryptAndHash(t.ss,r.ciphertext),{cs1:o,cs2:f}=this.split(t.ss);return{h:t.ss.h,plaintext:s,valid:i&&a,cs1:o,cs2:f}}initSession(t,r,n){let i=this.createEmptyKey(),s=new Uint8Array(32),a;return t?a=this.initializeInitiator(r,n,s,i):a=this.initializeResponder(r,n,s,i),{hs:a,i:t,mc:0}}sendMessage(t,r,n){let i;if(t.mc===0)i=this.writeMessageA(t.hs,r,n);else if(t.mc===1)i=this.writeMessageB(t.hs,r);else if(t.mc===2){let{h:s,messageBuffer:a,cs1:o,cs2:f}=this.writeMessageC(t.hs,r);i=a,t.h=s,t.cs1=o,t.cs2=f}else if(t.mc>2)if(t.i){if(!t.cs1)throw new Error("CS1 (cipher state) is not defined");i=this.writeMessageRegular(t.cs1,r)}else{if(!t.cs2)throw new Error("CS2 (cipher state) is not defined");i=this.writeMessageRegular(t.cs2,r)}else throw new Error("Session invalid.");return t.mc++,i}recvMessage(t,r){let n=new Uint8Array(0),i=!1;if(t.mc===0)({plaintext:n,valid:i}=this.readMessageA(t.hs,r));else if(t.mc===1)({plaintext:n,valid:i}=this.readMessageB(t.hs,r));else if(t.mc===2){let{h:s,plaintext:a,valid:o,cs1:f,cs2:c}=this.readMessageC(t.hs,r);n=a,i=o,t.h=s,t.cs1=f,t.cs2=c}return t.mc++,{plaintext:n,valid:i}}};var gs=class{constructor(t,r,n,i,s,a,o,f){this.remoteExtensions={webtransportCerthashes:[]},this.isInitiator=t,this.payload=r,this.prologue=n,this.staticKeypair=s,this.connection=a,o&&(this.remotePeer=o),this.xx=f??new ys(i),this.session=this.xx.initSession(this.isInitiator,this.prologue,this.staticKeypair)}async propose(){if(xh(this.session.hs.s),this.isInitiator){Ot.trace("Stage 0 - Initiator starting to send first message.");let t=this.xx.sendMessage(this.session,new Uint8Array(0));this.connection.writeLP(E0(t)),Ot.trace("Stage 0 - Initiator finished sending first message."),Ao(this.session.hs.e)}else{Ot.trace("Stage 0 - Responder waiting to receive first message...");let t=A0((await this.connection.readLP()).subarray()),{valid:r}=this.xx.recvMessage(this.session,t);if(!r)throw new We("xx handshake stage 0 validation fail");Ot.trace("Stage 0 - Responder received first message."),_o(this.session.hs.re)}}async exchange(){if(this.isInitiator){Ot.trace("Stage 1 - Initiator waiting to receive first message from responder...");let t=_0((await this.connection.readLP()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,t);if(!n)throw new We("xx handshake stage 1 validation fail");Ot.trace("Stage 1 - Initiator received the message."),_o(this.session.hs.re),mh(this.session.hs.rs),Ot.trace("Initiator going to check remote's signature...");try{let i=So(r);this.remotePeer=this.remotePeer||await Eo(i),await Bo(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let s=i;throw new Er(`Error occurred while verifying signed payload: ${s.message}`)}Ot.trace("All good with the signature!")}else{Ot.trace("Stage 1 - Responder sending out first message with signed payload and static key.");let t=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(S0(t)),Ot.trace("Stage 1 - Responder sent the second handshake message with signed payload."),Ao(this.session.hs.e)}}async finish(){if(this.isInitiator){Ot.trace("Stage 2 - Initiator sending third handshake message.");let t=this.xx.sendMessage(this.session,this.payload);this.connection.writeLP(B0(t)),Ot.trace("Stage 2 - Initiator sent message with signed payload.")}else{Ot.trace("Stage 2 - Responder waiting for third handshake message...");let t=C0((await this.connection.readLP()).subarray()),{plaintext:r,valid:n}=this.xx.recvMessage(this.session,t);if(!n)throw new We("xx handshake stage 2 validation fail");Ot.trace("Stage 2 - Responder received the message, finished handshake.");try{let i=So(r);this.remotePeer=this.remotePeer||await Eo(i),await Bo(this.session.hs.rs,i,this.remotePeer),this.setRemoteNoiseExtension(i.extensions)}catch(i){let s=i;throw new Er(`Error occurred while verifying signed payload: ${s.message}`)}}vh(this.session)}encrypt(t,r){let n=this.getCS(r);return this.xx.encryptWithAd(n,new Uint8Array(0),t)}decrypt(t,r,n){let i=this.getCS(r,!1);return this.xx.decryptWithAd(i,new Uint8Array(0),t,n)}getRemoteStaticKey(){return this.session.hs.rs}getCS(t,r=!0){if(!t.cs1||!t.cs2)throw new We("Handshake not completed properly, cipher state does not exist.");return this.isInitiator?r?t.cs1:t.cs2:r?t.cs2:t.cs1}setRemoteNoiseExtension(t){t&&(this.remoteExtensions=t)}};function bh(e){return{xxHandshakeSuccesses:e.registerCounter("libp2p_noise_xxhandshake_successes_total",{help:"Total count of noise xxHandshakes successes_"}),xxHandshakeErrors:e.registerCounter("libp2p_noise_xxhandshake_error_total",{help:"Total count of noise xxHandshakes errors"}),encryptedPackets:e.registerCounter("libp2p_noise_encrypted_packets_total",{help:"Total count of noise encrypted packets successfully"}),decryptedPackets:e.registerCounter("libp2p_noise_decrypted_packets_total",{help:"Total count of noise decrypted packets"}),decryptErrors:e.registerCounter("libp2p_noise_decrypt_errors_total",{help:"Total count of noise decrypt errors"})}}var xs=class{constructor(t={}){this.protocol="/noise";let{staticNoiseKey:r,extensions:n,crypto:i,prologueBytes:s,metrics:a}=t;this.crypto=i??Os,this.extensions=n,this.metrics=a?bh(a):void 0,r?this.staticKeys=this.crypto.generateX25519KeyPairFromSeed(r):this.staticKeys=this.crypto.generateX25519KeyPair(),this.prologue=s??new Uint8Array(0)}async secureOutbound(t,r,n){let i=vs(r,{lengthEncoder:Gr,lengthDecoder:In,maxDataLength:65535}),s=await this.performHandshake({connection:i,isInitiator:!0,localPeer:t,remotePeer:n});return{conn:await this.createSecureConnection(i,s),remoteExtensions:s.remoteExtensions,remotePeer:s.remotePeer}}async secureInbound(t,r,n){let i=vs(r,{lengthEncoder:Gr,lengthDecoder:In,maxDataLength:65535}),s=await this.performHandshake({connection:i,isInitiator:!1,localPeer:t,remotePeer:n});return{conn:await this.createSecureConnection(i,s),remotePeer:s.remotePeer,remoteExtensions:s.remoteExtensions}}async performHandshake(t){let r=await ch(t.localPeer,this.staticKeys.publicKey,this.extensions);return await this.performXXHandshake(t,r)}async performXXHandshake(t,r){let{isInitiator:n,remotePeer:i,connection:s}=t,a=new gs(n,r,this.prologue,this.crypto,this.staticKeys,s,i);try{await a.propose(),await a.exchange(),await a.finish(),this.metrics?.xxHandshakeSuccesses.increment()}catch(o){if(this.metrics?.xxHandshakeErrors.increment(),o instanceof Error)throw o.message=`Error occurred during XX handshake: ${o.message}`,o}return a}async createSecureConnection(t,r){let[n,i]=Mo(),s=t.unwrap();return await Oo(n,I0(r,this.metrics),s,br({lengthDecoder:In}),L0(r,this.metrics),n),i}};function sg(e={}){return()=>new xs(e)}return _h(ag);})();
/*! Bundled license information:

@noble/secp256k1/lib/esm/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/ed25519/lib/esm/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)
*/
return ChainsafeLibp2PNoise}));
