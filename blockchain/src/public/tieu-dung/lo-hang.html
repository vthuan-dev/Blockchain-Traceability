<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="../hinhanh/logo_buoi.png">
    <title>Thông tin lô hàng</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/trangchu.css">
    <link href="https://cdn.jsdelivr.net/npm/aos@2.3.4/dist/aos.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/sanpham.css">
    <link rel="stylesheet" href="../css/chatbox.css">
    <link rel="stylesheet" href="../css/lo-hang.css">
    <link rel="stylesheet" href="../css/trangcanhan.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
    <meta charset="UTF-8">
    <!-- Thêm Font Awesome từ Cloudflare CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <nav class="navbar custom-navbar navbar-expand-lg navbar-light bg-light custom-navbar-height">
        <div class="logo-home">
            <a href="trangchu.html">
                <img src="\hinhanh\Bitcoin-Blockchain-Network-icon-on-transparent-background-PNG.png" alt="logo" class="logo">
            </a>
        </div>
        <a class="navbar-brand" href="#">Lô hàng</a>
        <button class="navbar-toggler ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ml-auto"> 
                <li class="nav-item active">
                    <a class="nav-link" href="allsanpham.html">Sản phẩm</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="allnongdan.html">Nhà sản xuất</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="allnhakiemduyet.html">Nhà kiểm duyệt</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Vùng sản xuất</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="#">Tin tức</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/api/dangnhap">Đăng nhập</a>
                </li>
            </ul>
        </div>
    </nav>
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="#">Trang chủ</a></li>
                <li class="breadcrumb-item active" id="breadcrumbTitle" aria-current="page">Thông tin lô hàng</li>
            </ol>
        </nav>
        <div class="sanpham">
            <div class="row justify-content-center">
                <div class="col-md-10">
                    <div class="tieude text-center">
                        <div class="row no-gutters justify-content-center">
                            <div class="col-md-8 col-12 mb-4">
                                <img src="" alt="" class="img-fluid custom-img" onclick="showImage(this)">
                            </div>
                        </div>
                        <div class="ten_sanpham mb-3">
                            <h3 class="font-weight-bold"></h3>
                        </div>
                        <div class="price mb-4">
                            <h3 class="font-weight-bold"></h3>
                        </div>
                    </div>
                    <div class="thanhphan">
                        <div class="row no-gutters">
                            <div class="col-3 p-2">
                                <div class="tab-button" data-target="thongtin">
                                    <i class="fas fa-info-circle"></i>
                                    <span class="tab-text">Thông tin</span>
                                </div>
                            </div>
                            <div class="col-3 p-2">
                                <div class="tab-button" data-target="lienket">
                                    <i class="fas fa-link"></i>
                                    <span class="tab-text">Các bên liên quan</span>
                                </div>
                            </div>
                            <div class="col-3 p-2">
                                <div class="tab-button" data-target="xacthuc">
                                    <i class="fas fa-check-circle"></i>
                                    <span class="tab-text">Xác thực</span>
                                </div>
                            </div>
                            <div class="col-3 p-2">
                                <div class="tab-button" data-target="lohang">
                                    <i class="fas fa-box"></i>
                                    <span class="tab-text">Lô hàng</span>
                                </div>
                            </div>
                        </div>
                        <div class="tab-content" id="thongtin">
                            <!-- Nội dung thông tin sản phẩm -->
                        </div>
                        <div class="tab-content" id="lienket">
                            <!-- Nội dung các bên liên quan -->
                        </div>
                        <div class="tab-content" id="xacthuc">
                            <!-- Nội dung thông tin xác thực -->
                        </div>
                        <div class="tab-content" id="lohang">
                            <!-- Nội dung thông tin lô hàng -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    

    <div class="chat-icon" id="openChat" onclick="toggleChat()">
        <i class="fas fa-comments"></i>
        <div class="tooltip">Đặt câu hỏi cho chúng tôi</div>
    </div>

    <!-- Khung chat -->
    <div id="chatbox" class="chatbox">
        <div class="chatbox-header">
            <strong>Hỗ trợ</strong>
            <button id="closeChat" class="btn-close" onclick="toggleChat()">x</button>
        </div>
        <div class="chatbox-body">
            <ul id="messages" class="list-group">
                <li class="list-group-item system-message"><strong>Hệ thống: </strong> Chào bạn, hãy đặt câu hỏi của bạn.</li>
            </ul>
        </div>
        <div class="chatbox-footer">
            <form id="messageForm" class="d-flex">
                <input id="messageInput" type="text" class="form-control" placeholder="type message">
                <button type="submit" class="btn btn-primary">Send</button>
            </form>
        </div>
    </div>

    <div class="overlay" id="overlay" onclick="hideImage()">
        <img id="overlay-img" src="" alt="">
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.3.2/socket.io.js"></script>
    <!-- jQuery và Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <script src="../js_giaodien/sanpham.js"></script>

    <script src="../chatbox/chatbox.js"></script>

    <script>
       function toggleChat() {
            var chatbox = document.getElementById("chatbox");
            if (chatbox.classList.contains("show")) {
                chatbox.classList.remove("show");
                chatbox.classList.add("hide");
                setTimeout(() => {
                    chatbox.style.display = "none";
                    chatbox.classList.remove("hide");
                }, 300); // Match this to the animation duration
            } else {
                chatbox.style.display = "block";
                // Force a reflow before adding the 'show' class
                chatbox.offsetHeight;
                chatbox.classList.add("show");
            }
        }
    </script>

    <script>
  document.addEventListener('DOMContentLoaded', async function() {
    const urlParams = new URLSearchParams(window.location.search);
    const sscc = urlParams.get('sscc');
    if (sscc) {
        try {
            const response = await fetch(`/api/batch-info-by-sscc-for-consumer/${sscc}`);
            const batchInfo = await response.json();
            if (response.ok) {
                updateBatchInfo(batchInfo);
            } else {
                console.error('Lỗi khi lấy thông tin lô hàng:', batchInfo.error);
            }
        } catch (error) {
            console.error('Lỗi khi gọi API:', error);
        }
    } else {
        console.error('Không tìm thấy SSCC trong URL');
    }
});
    async function updateBatchInfo(batchInfo) {
    // Lấy thông tin sản phẩm từ SQL
    try {
        const response = await fetch(`/api/product/${batchInfo.productId}`);
        if (response.ok) {
            const productInfo = await response.json();
            updateProductInfo(productInfo);
            
            // Cập nhật tên sản phẩm, hình ảnh và giá
            document.querySelector('.ten_sanpham h3').textContent = productInfo.product_name;
            document.querySelector('.custom-img').src = productInfo.img || '';
            document.querySelector('.price h3').innerHTML = `Giá: <span>${new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(productInfo.price)}</span>`;
             } else {
            console.error('Không thể lấy thông tin sản phẩm');
        }
    } catch (error) {
        console.error('Lỗi khi lấy thông tin sản phẩm:', error);
    }

    await updateRelatedParties(batchInfo);
    updateAuthenticationInfo(batchInfo);
    updateBatchDetails(batchInfo);

    document.querySelector('[data-target="lohang"]').click();
}

    function updateProductInfo(productInfo) {
        const thongtinContent = document.getElementById('thongtin');
        thongtinContent.innerHTML = `
            <h2>Thông tin sản phẩm</h2>
            <table class="table table-bordered">
            
            <h4>Mô tả:</h4>
            <ul>
                ${productInfo.description.split('\n').map(desc => `<li>${desc.trim()}</li>`).join('')}
            </ul>
            <h4>Công dụng:</h4>
            <ul>
                ${productInfo.uses.split('\n').map(use => `<li>${use.trim()}</li>`).join('')}
            </ul>
            <h4>Quy trình sản xuất:</h4>
            <ol>
                ${productInfo.process.split('\n').map(step => `<li>${step.trim()}</li>`).join('')}
            </ol>
        `;
    }
    async function updateRelatedParties(batchInfo) {
        const lienketContent = document.getElementById('lienket');
        
        console.log('Batch Info:', batchInfo);

        const producerId = batchInfo.producerId;
        console.log('Producer ID:', producerId);

        if (!batchInfo.producer) {
            console.error('Không có thông tin về nhà sản xuất');
            lienketContent.innerHTML = '<p>Không có thông tin về nhà sản xuất</p>';
            return;
        }

        const producerName = batchInfo.producer.name || 'Không có tên';
        const producerAddress = batchInfo.producer.address || 'Không có thông tin';
        const producerPhone = batchInfo.producer.phone || 'Không có thông tin';

        lienketContent.innerHTML = `
        <h2>Các bên có liên quan</h2>
        <p><strong>Nhà sản xuất:</strong> <a href="/trangcanhan.html?uid=${producerId}" class="producer-link">${producerName}</a></p>
        <p><strong>Địa chỉ:</strong> 
            <a href="#" onclick="openGoogleMaps('${producerAddress}')" class="address-link">
                ${producerAddress}
            </a>
        </p>
        <p><strong>Số điện thoại:</strong> ${producerPhone}</p>
        <h5 class="activity-log-title">Nhật ký lô hàng</h5>
        <div id="activityLogs">Đang tải...</div>
        `;

        // Phần còn lại của hàm giữ nguyên
        try {
            const response = await fetch(`/api/system-activity-logs/${batchInfo.sscc}`);
            if (response.ok) {
                const data = await response.json();
                displayActivityLogs(data.activityLogs);
            } else {
                console.error('Không thể lấy nhật ký hoạt động');
                document.getElementById('activityLogs').innerHTML = 'Không thể tải nhật ký hoạt động.';
            }
        } catch (error) {
            console.error('Lỗi khi lấy nhật ký hoạt động:', error);
            document.getElementById('activityLogs').innerHTML = 'Đã xảy ra lỗi khi tải nhật ký hoạt động.';
        }
}

// Thêm hàm này vào script của bạn
function goToProducerPage(producerId) {
    if (producerId) {
        window.location.href = `trangcanhan.html?uid=${producerId}`;
    } else {
        console.error('Không có ID người sản xuất');
    }
}
function displayActivityLogs(logs) {
    const logsContainer = document.getElementById('activityLogs');
    if (logs.length === 0) {
        logsContainer.innerHTML = 'Không có hoạt động nào được ghi nhận.';
        return;
    }

    // Sắp xếp logs theo thời gian giảm dần (mới nhất lên đầu)
    logs.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

    const initialDisplayCount = 5; // Số lượng hoạt động hiển thị ban đầu
    const displayLogs = (start, end) => {
        const logsHtml = logs.slice(start, end).map(log => {
            const participant = log.participantInfo;
            let roleClass = '';
            let showDescription = true;
            
            if (participant) {
                switch(participant.role.toLowerCase()) {
                    case 'producer':
                    case 'nhà sản xuất':
                    case 'approver':
                    case 'kiểm định':
                    case 'người kiểm định':
                        roleClass = participant.role.toLowerCase().includes('sản xuất') ? 'producer' : 'approver';
                        showDescription = false;
                        break;
                    case 'warehouse':
                    case 'nhà kho':
                        roleClass = 'warehouse';
                        break;
                    case 'transporter':
                    case 'vận chuyển':
                        roleClass = 'transporter';
                        break;
                    default:
                        roleClass = '';
                }
            }

            const participantInfo = participant ? 
                `
                <div class="participant-info">
                    <img src="${participant.avatar || '/images/default-avatar.png'}" 
                         alt="${participant.name}" 
                         class="participant-avatar">
                    <div class="participant-details">
                        <a href="${BASE_URL}/trangcanhan.html?uid=${participant.id}" 
                           class="participant-link">
                            <p class="participant-name">${participant.name}</p>
                            <p class="participant-role">${participant.role}</p>
                        </a>
                    </div>
                </div>
                ` : 
                `<p><strong>Người thực hiện ID:</strong> ${log.participantId}</p>`;

            return `
            <div class="activity-log ${roleClass} ${getActivityClass(log.activityName)}">
                <p class="timestamp">
                    <strong>Thời gian:</strong> ${new Date(log.timestamp).toLocaleString('vi-VN')}
                </p>
                <p class="activity-name">
                    <strong>Hoạt động:</strong> ${getActivityIcon(log.activityName)} 
                    ${translateActivityName(log.activityName)}
                </p>
                ${participantInfo}
                ${showDescription ? `
                    <p class="description">
                        <strong>Mô tả:</strong> ${decodeAndTranslateDescription(log.description)}
                    </p>
                ` : ''}
                ${log.imageUrls && log.imageUrls.length > 0 ? `
                    <p><strong>Hình ảnh:</strong> 
                        <a href="${log.imageUrls[0]}" target="_blank" class="image-link">
                            Xem hình ảnh
                        </a>
                    </p>
                ` : ''}
            </div>
            `;
        }).join('');

        logsContainer.innerHTML = logsHtml;

        if (end < logs.length) {
            logsContainer.innerHTML += `
                    <button id="loadMoreLogs">Xem thêm</button>            `;
            document.getElementById('loadMoreLogs').addEventListener('click', () => {
                displayLogs(0, end + 5);
            });
        }
    };

    displayLogs(0, initialDisplayCount);
}
function decodeAndTranslateDescription(description) {
    // Giải mã HTML entities
    const decodedDescription = decodeHTMLEntities(description);
    
    // Dịch mô tả
    return translateDescription(decodedDescription);
}

function decodeHTMLEntities(text) {
    const textArea = document.createElement('textarea');
    textArea.innerHTML = text;
    return textArea.value;
}

function translateDescription(description) {
    const translations = {
        // Vận chuyển
        "Transport status updated to": "Trạng thái vận chuyển được cập nhật thành",
        "Bat dau van chuyen": "Bắt đầu vận chuyển",
        "Hoan thanh van chuyen": "Hoàn thành vận chuyển", 
        "Tam dung van chuyen": "Tạm dừng vận chuyển",
        "Transport status updated to 'Bat dau van chuyen'": "Trạng thái vận chuyển được cập nhật thành 'Bắt đầu vận chuyển'",
        "Transport status updated to 'Hoan thanh van chuyen'": "Trạng thái vận chuyển được cập nhật thành 'Hoàn thành vận chuyển'",
        "Transport status updated to 'Tam dung van chuyen'": "Trạng thái vận chuyển được cập nhật thành 'Tạm dừng vận chuyển'",

        // Nhà kho
        "Warehouse has confirmed receipt of batch": "Nhà kho đã xác nhận nhận lô hàng",
        "Update inventory status": "Cập nhật trạng thái kho",
        "Confirm receipt of goods": "Xác nhận nhận hàng",
        "Inventory updated": "Đã cập nhật kho hàng",

        // Kiểm định
        "Batch has been approved by the approver": "Lô hàng đã được kiểm định viên phê duyệt",
        "Batch has been rejected": "Lô hàng đã bị từ chối",
        "Quality check completed": "Hoàn thành kiểm tra chất lượng",
        "Document verification completed": "Hoàn thành xác minh tài liệu",
        "Batch review in progress": "Đang tiến hành xem xét lô hàng",
        "Quality inspection passed": "Đã vượt qua kiểm tra chất lượng",

        // Nhà sản xuất
        "A new batch has been created": "Một lô hàng mới đã được tạo",
        "Product information updated": "Thông tin sản phẩm đã được cập nhật",
        "Batch has been approved": "Lô hàng đã được phê duyệt",
        "Create new production batch": "Tạo lô sản xuất mới",
        "Update batch information": "Cập nhật thông tin lô hàng",
        "Production completed": "Hoàn thành sản xuất"
    };

    // Tìm và thay thế các phần của mô tả
    for (const [key, value] of Object.entries(translations)) {
        if (description.includes(key)) {
            description = description.replace(key, value);
        }
    }
    return description;
}

function translateActivityName(activityName) {
    const translations = {
        // Vận chuyển
        "Transport Status Updated": "Cập nhật trạng thái vận chuyển",
        "Start Transport": "Bắt đầu vận chuyển",
        "Stop Transport": "Tạm dừng vận chuyển", 
        "Finish Transport": "Hoàn thành vận chuyển",
        "Transport in progress": "Đang vận chuyển",

        // Nhà kho
        "Warehouse Confirmation": "Xác nhận từ nhà kho",
        "Update Inventory": "Cập nhật kho hàng",
        "Confirm Receipt": "Xác nhận nhận hàng",
        "Stock check": "Kiểm tra kho",

        // Kiểm định
        "Batch Approved": "Lô hàng được phê duyệt",
        "Reject Batch": "Từ chối lô hàng",
        "Review Batch": "Xem xét lô hàng",
        "Quality Check": "Kiểm tra chất lượng",
        "Verify Documents": "Xác minh tài liệu",
        "Quality Control": "Kiểm soát chất lượng",

        // Nhà sản xuất
        "Create Batch": "Tạo lô hàng",
        "Batch Created": "Đã tạo lô hàng",
        "Update Product Info": "Cập nhật thông tin sản phẩm",
        "Production Started": "Bắt đầu sản xuất",
        "Production Completed": "Hoàn thành sản xuất"
    };

    return translations[activityName] || activityName;
}

    function updateAuthenticationInfo(batchInfo) {
        const xacthucContent = document.getElementById('xacthuc');
        xacthucContent.innerHTML = `
            <h2>Thông tin xác thực</h2>
            <p><strong>Trạng thái:</strong> ${batchInfo.status}</p>
            <p><strong>Chứng nhận:</strong> <a href="${batchInfo.certificateImageUrl}" target="_blank">Xem chứng nhận</a></p>
        `;
    }
    
    function updateBatchDetails(batchInfo) {
    const lohangContent = document.getElementById('lohang');
    lohangContent.innerHTML = `
        <div class="batch-info">
            <h2>Thông tin lô hàng</h2>
            <table>
                <tr>
                    <th>Tên lô hàng</th>
                    <td>${batchInfo.name}</td>
                </tr>
                <tr>
                    <th>Số lượng (tấn)</th>
                    <td>${batchInfo.quantity}</td>
                </tr>
                <tr>
                    <th>Ngày tạo lô hàng</th>
                    <td>${new Date(batchInfo.productionDate).toLocaleDateString('vi-VN')}</td>
                </tr>
                <tr>
                    <th>Trạng thái vận chuyển</th>
                    <td>${batchInfo.transportStatus}</td>
                </tr>
                <tr>
                    <th>Người sản xuất</th>
                    <td>${batchInfo.producer.name}</td>
                </tr>
                <tr>
                    <th>Địa chỉ</th>
                    <td>
                        <a href="#" onclick="openGoogleMaps('${batchInfo.producer.address}')" class="address-link">
                            ${batchInfo.producer.address || 'Không có thông tin'}
                        </a>
                    </td>
                </tr>
                <tr>
                    <th>Số điện thoại</th>
                    <td>${batchInfo.producer.phone || 'Không có thông tin'}</td>
                </tr>
            </table>
            <div class="text-center mt-4">
                <button class="btn-view-image" onclick="showProductImages('${batchInfo.productImageUrls.join(',')}')">
                    <i class="fas fa-camera mr-2"></i> Xem ảnh sản phẩm
                </button>
            </div>
        </div>
    `;
}
// Hàm để hiển thị ảnh sản phẩm
function showProductImages(imageUrls) {
    const urls = imageUrls.split(',');
    if (urls.length > 0) {
        const overlay = document.getElementById('overlay');
        const overlayImg = document.getElementById('overlay-img');
        overlayImg.src = urls[0]; // Hiển thị ảnh đầu tiên
        overlay.style.display = 'flex';
    }
}

// Đảm bảo rằng bạn đã có hàm hideImage() để đóng overlay
function hideImage() {
    document.getElementById('overlay').style.display = 'none';
}
document.querySelectorAll('.tab-button').forEach(tab => {
    tab.addEventListener('click', function() {
        document.querySelectorAll('.tab-button').forEach(t => t.classList.remove('active'));
        this.classList.add('active');
        const target = this.getAttribute('data-target');
        document.querySelectorAll('.tab-content').forEach(content => {
            content.style.display = 'none';
        });
        document.getElementById(target).style.display = 'block';
    });
});

// Kích hoạt tab đầu tiên khi trang được tải
document.querySelector('.tab-button').click();

function getActivityClass(activityName) {
    // Thêm class CSS dựa trên loại hoạt động
    switch(activityName.toLowerCase()) {
        case 'transport status updated': return 'activity-transport';
        case 'warehouse confirmation': return 'activity-confirm';
        default: return 'activity-default';
    }
}

function getActivityIcon(activityName) {
    // Chuyển đổi activityName sang chữ thường để so sánh
    const activity = activityName.toLowerCase();
    
    // Nhà sản xuất
    if (activity.includes('create batch') || activity.includes('batch created')) {
        return '<i class="fas fa-seedling text-success"></i>'; // Icon cây mầm
    }
    if (activity.includes('update product info')) {
        return '<i class="fas fa-file-pen text-success"></i>'; // Icon file chỉnh sửa
    }
    
    // Nhà kiểm duyệt
    if (activity.includes('batch approved') || activity.includes('approve batch')) {
        return '<i class="fas fa-clipboard-check text-primary"></i>'; // Icon clipboard check
    }
    if (activity.includes('reject batch')) {
        return '<i class="fas fa-clipboard-xmark text-danger"></i>'; // Icon clipboard X
    }
    if (activity.includes('review batch')) {
        return '<i class="fas fa-magnifying-glass text-primary"></i>'; // Icon kính lúp
    }
    if (activity.includes('verify documents')) {
        return '<i class="fas fa-file-contract text-primary"></i>'; // Icon hợp đồng
    }
    if (activity.includes('quality check')) {
        return '<i class="fas fa-vial text-primary"></i>'; // Icon ống nghiệm
    }
    
    // Nhà kho
    if (activity.includes('warehouse confirmation') || activity.includes('confirm receipt')) {
        return '<i class="fas fa-warehouse text-warning"></i>'; // Icon nhà kho
    }
    if (activity.includes('update inventory')) {
        return '<i class="fas fa-box-archive text-warning"></i>'; // Icon hộp lưu trữ
    }
    
    // Vận chuyển
    if (activity.includes('transport status') || activity.includes('start transport')) {
        return '<i class="fas fa-truck-fast text-purple"></i>'; // Icon xe tải nhanh
    }
    if (activity.includes('finish transport')) {
        return '<i class="fas fa-truck-ramp-box text-purple"></i>'; // Icon xe tải dỡ hàng
    }
    if (activity.includes('stop transport')) {
        return '<i class="fas fa-truck-medical text-danger"></i>'; // Icon xe tải cứu hộ
    }
    
    // Mặc định nếu không khớp với bất kỳ điều kiện nào
    return '<i class="fas fa-circle-info text-secondary"></i>'; // Icon thông tin
}

// Thêm hàm mới để mở Google Maps
function openGoogleMaps(address) {
    if (address && address !== 'Không có thông tin') {
        const encodedAddress = encodeURIComponent(address);
        window.open(`https://www.google.com/maps/search/?api=1&query=${encodedAddress}`, '_blank');
    } else {
        alert('Không có thông tin địa chỉ để hiển thị trên bản đồ.');
    }
}
    </script>

<script>

    const BASE_URL = window.location.origin; // Lấy base URL của ứng dụng
</script>
</body>
</html>
